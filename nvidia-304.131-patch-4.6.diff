diff -uNr nvidia-304.131.org/conftest.sh nvidia-304.131/conftest.sh
--- nvidia-304.131.org/conftest.sh	2013-05-05 01:53:24.000000000 +0800
+++ nvidia-304.131/conftest.sh	2016-08-01 13:40:15.000000000 +0800
@@ -1,7 +1,2117 @@
 #!/bin/sh
-# This is a replacement for nvidia's conftest.sh
+
+# make sure we are in the directory containing this script
+SCRIPTDIR=`dirname $0`
+cd $SCRIPTDIR
+PATH="${PATH}:/bin:/sbin"
+
 #
-# We have a new conftest.h that works with kbuild that we don't want
-# overwritten or generated or anything else, so we want any call to
-# conftest.sh to do absolutely nothing.
-exit 0
+# HOSTCC vs. CC - if a conftest needs to build and execute a test
+# binary, like get_uname, then $HOSTCC needs to be used for this
+# conftest in order for the host/build system to be able to execute
+# it in X-compile environments.
+# In all other cases, $CC should be used to minimize the risk of
+# false failures due to conflicts with architecture specific header
+# files.
+#
+CC="$1"
+HOSTCC="$2"
+ARCH=$3
+ISYSTEM=`$CC -print-file-name=include 2> /dev/null`
+SOURCES=$4
+HEADERS=$SOURCES/include
+OUTPUT=$5
+XEN_PRESENT=1
+
+test_xen() {
+    #
+    # Determine if the target kernel is a Xen kernel. It used to be
+    # sufficient to check for CONFIG_XEN, but the introduction of
+    # modular para-virtualization (CONFIG_PARAVIRT, etc.) and
+    # Xen guest support, it is no longer possible to determine the
+    # target environment at build time. Therefore, if both
+    # CONFIG_XEN and CONFIG_PARAVIRT are present, text_xen() treats
+    # the kernel as a stand-alone kernel.
+    #
+    OLD_FILE="linux/autoconf.h"
+    NEW_FILE="generated/autoconf.h"
+
+    if [ -f $HEADERS/$NEW_FILE -o -f $OUTPUT/include/$NEW_FILE ]; then
+        FILE=$NEW_FILE
+    fi
+    if [ -f $HEADERS/$OLD_FILE -o -f $OUTPUT/include/$OLD_FILE ]; then
+        FILE=$OLD_FILE
+    fi
+
+    if [ -n "$FILE" ]; then
+        #
+        # We are looking at a configured source tree; verify
+        # that it's not a Xen kernel.
+        #
+        echo "#include <$FILE>
+        #if defined(CONFIG_XEN) && !defined(CONFIG_PARAVIRT)
+        #error CONFIG_XEN defined!
+        #endif
+        " > conftest$$.c
+
+        $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+        rm -f conftest$$.c
+
+        if [ -f conftest$$.o ]; then
+            rm -f conftest$$.o
+            XEN_PRESENT=0
+        fi
+    else
+        CONFIG=$HEADERS/../.config
+        if [ -f $CONFIG ]; then
+            if [ -z "$(grep "^CONFIG_XEN=y" $CONFIG)" ]; then
+                XEN_PRESENT="0"
+                return
+            fi
+            if [ -n "$(grep "^CONFIG_PARAVIRT=y" $CONFIG)" ]; then
+                XEN_PRESENT="0"
+            fi
+        fi
+    fi
+}
+
+test_headers() {
+    #
+    # Determine which header files (of a set that may or may not be
+    # present) are provided by the target kernel.
+    #
+    FILES="asm/system.h"
+    FILES="$FILES drm/drmP.h"
+    FILES="$FILES drm/drm_gem.h"
+    FILES="$FILES generated/autoconf.h"
+    FILES="$FILES generated/compile.h"
+    FILES="$FILES generated/utsrelease.h"
+    FILES="$FILES linux/efi.h"
+    FILES="$FILES linux/kconfig.h"
+    FILES="$FILES linux/screen_info.h"
+    FILES="$FILES linux/semaphore.h"
+
+    for FILE in $FILES; do
+        FILE_DEFINE=NV_`echo $FILE | tr '/.' '_' | tr 'a-z' 'A-Z'`_PRESENT
+        if [ -f $HEADERS/$FILE -o -f $OUTPUT/include/$FILE ]; then
+            echo "#define $FILE_DEFINE" >> conftest.h
+        else
+            echo "#undef $FILE_DEFINE" >> conftest.h
+        fi
+    done
+}
+
+build_cflags() {
+    BASE_CFLAGS="-O2 -D__KERNEL__ \
+-DKBUILD_BASENAME=\"#conftest$$\" -DKBUILD_MODNAME=\"#conftest$$\" \
+-nostdinc -isystem $ISYSTEM"
+
+    if [ "$OUTPUT" != "$SOURCES" ]; then
+        OUTPUT_CFLAGS="-I$OUTPUT/include2 -I$OUTPUT/include"
+        if [ -f "$OUTPUT/include/generated/autoconf.h" ]; then
+            AUTOCONF_CFLAGS="-include $OUTPUT/include/generated/autoconf.h"
+        else
+            AUTOCONF_CFLAGS="-include $OUTPUT/include/linux/autoconf.h"
+        fi
+    else
+        if [ -f "$HEADERS/generated/autoconf.h" ]; then
+            AUTOCONF_CFLAGS="-include $HEADERS/generated/autoconf.h"
+        else
+            AUTOCONF_CFLAGS="-include $HEADERS/linux/autoconf.h"
+        fi
+    fi
+
+    CFLAGS="$CFLAGS $OUTPUT_CFLAGS -I$HEADERS $AUTOCONF_CFLAGS"
+
+    test_xen
+
+    if [ "$OUTPUT" != "$SOURCES" ]; then
+        MACH_CFLAGS="-I$HEADERS/asm-$ARCH/mach-default"
+        if [ "$ARCH" = "i386" -o "$ARCH" = "x86_64" ]; then
+            MACH_CFLAGS="$MACH_CFLAGS -I$HEADERS/asm-x86/mach-default"
+            MACH_CFLAGS="$MACH_CFLAGS -I$SOURCES/arch/x86/include/asm/mach-default"
+            MACH_CFLAGS="$MACH_CFLAGS -I$HEADERS/arch/x86/include/uapi"
+        elif [ "$ARCH" = "arm" ]; then
+            MACH_CFLAGS="$MACH_CFLAGS -D__LINUX_ARM_ARCH__=7"
+            MACH_CFLAGS="$MACH_CFLAGS -I$SOURCES/arch/arm/mach-tegra/include"
+            MACH_CFLAGS="$MACH_CFLAGS -I$HEADERS/arch/arm/include/uapi"
+        fi
+        if [ "$XEN_PRESENT" != "0" ]; then
+            MACH_CFLAGS="-I$HEADERS/asm-$ARCH/mach-xen $MACH_CFLAGS"
+        fi
+    else
+        MACH_CFLAGS="-I$HEADERS/asm/mach-default"
+        if [ "$ARCH" = "i386" -o "$ARCH" = "x86_64" ]; then
+            MACH_CFLAGS="$MACH_CFLAGS -I$HEADERS/asm-x86/mach-default"
+            MACH_CFLAGS="$MACH_CFLAGS -I$SOURCES/arch/x86/include/asm/mach-default"
+            MACH_CFLAGS="$MACH_CFLAGS -I$HEADERS/arch/x86/include/uapi"
+        elif [ "$ARCH" = "arm" ]; then
+            MACH_CFLAGS="$MACH_CFLAGS -D__LINUX_ARM_ARCH__=7"
+            MACH_CFLAGS="$MACH_CFLAGS -I$SOURCES/arch/arm/mach-tegra/include"
+            MACH_CFLAGS="$MACH_CFLAGS -I$HEADERS/arch/arm/include/uapi"
+        fi
+        if [ "$XEN_PRESENT" != "0" ]; then
+            MACH_CFLAGS="-I$HEADERS/asm/mach-xen $MACH_CFLAGS"
+        fi
+    fi
+
+    CFLAGS="$BASE_CFLAGS $MACH_CFLAGS $OUTPUT_CFLAGS $AUTOCONF_CFLAGS"
+    CFLAGS="$CFLAGS -I$HEADERS -I$HEADERS/uapi -I$OUTPUT/include/generated/uapi"
+
+    if [ "$ARCH" = "i386" -o "$ARCH" = "x86_64" ]; then
+        CFLAGS="$CFLAGS -I$SOURCES/arch/x86/include"
+        CFLAGS="$CFLAGS -I$SOURCES/arch/x86/include/uapi"
+        CFLAGS="$CFLAGS -I$OUTPUT/arch/x86/include/generated"
+        CFLAGS="$CFLAGS -I$OUTPUT/arch/x86/include/generated/uapi"
+    elif [ "$ARCH" = "arm" ]; then
+        CFLAGS="$CFLAGS -I$SOURCES/arch/arm/include"
+        CFLAGS="$CFLAGS -I$SOURCES/arch/arm/include/uapi"
+        CFLAGS="$CFLAGS -I$OUTPUT/arch/arm/include/generated"
+        CFLAGS="$CFLAGS -I$OUTPUT/arch/arm/include/generated/uapi"
+    fi
+    if [ -n "$BUILD_PARAMS" ]; then
+        CFLAGS="$CFLAGS -D$BUILD_PARAMS"
+    fi
+}
+
+CONFTEST_PREAMBLE="#include \"conftest.h\"
+    #if defined(NV_LINUX_KCONFIG_H_PRESENT)
+    #include <linux/kconfig.h>
+    #endif
+    #if defined(NV_GENERATED_AUTOCONF_H_PRESENT)
+    #include <generated/autoconf.h>
+    #else
+    #include <linux/autoconf.h>
+    #endif
+    #if defined(CONFIG_XEN) && \
+        defined(CONFIG_XEN_INTERFACE_VERSION) &&  !defined(__XEN_INTERFACE_VERSION__)
+    #define __XEN_INTERFACE_VERSION__ CONFIG_XEN_INTERFACE_VERSION
+    #endif"
+
+append_conftest() {
+    #
+    # Helper function to make it easier to import conftests from newer
+    # driver versions by appending stdin to conftest.h
+    #
+
+    while read LINE; do
+        echo ${LINE} >> conftest.h
+    done
+}
+
+compile_check_conftest() {
+    #
+    # Compile the current conftest C file and check+output the result
+    #
+    CODE="$1"
+    DEF="$2"
+    VAL="$3"
+    CAT="$4"
+
+    echo "$CONFTEST_PREAMBLE
+    $CODE" > conftest$$.c
+
+    $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+    rm -f conftest$$.c
+
+    if [ -f conftest$$.o ]; then
+        rm -f conftest$$.o
+        if [ "${CAT}" = "functions" ]; then
+            # The logic for "functions" compilation tests is inverted compared to
+            # other compilation steps: if the function is present, the code
+            # snippet will fail to compile because the function call won't match
+            # the prototype. If the function is not present, the code snippet
+            # will produce an object file with the function as an unresolved
+            # symbol.
+            echo "#undef ${DEF}" | append_conftest "${CAT}"
+        else
+            echo "#define ${DEF} ${VAL}" | append_conftest "${CAT}"
+        fi
+        return
+    else
+        if [ "${CAT}" = "functions" ]; then
+            echo "#define ${DEF} ${VAL}" | append_conftest "${CAT}"
+        else
+            echo "#undef ${DEF}" | append_conftest "${CAT}"
+        fi
+        return
+    fi
+}
+
+compile_test() {
+    case "$1" in
+        remap_page_range)
+            #
+            # Determine if the remap_page_range() function is present
+            # and how many arguments it takes.
+            #
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/mm.h>
+            void conftest_remap_page_range(void) {
+                remap_page_range();
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                echo "#undef NV_REMAP_PAGE_RANGE_PRESENT" >> conftest.h
+                rm -f conftest$$.o
+                return
+            fi
+
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/mm.h>
+            int conftest_remap_page_range(void) {
+                pgprot_t pgprot = __pgprot(0);
+                return remap_page_range(NULL, 0L, 0L, 0L, pgprot);
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                echo "#define NV_REMAP_PAGE_RANGE_PRESENT" >> conftest.h
+                echo "#define NV_REMAP_PAGE_RANGE_ARGUMENT_COUNT 5" >> conftest.h
+                rm -f conftest$$.o
+                return
+            fi
+
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/mm.h>
+            int conftest_remap_page_range(void) {
+                pgprot_t pgprot = __pgprot(0);
+                return remap_page_range(0L, 0L, 0L, pgprot);
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                echo "#define NV_REMAP_PAGE_RANGE_PRESENT" >> conftest.h
+                echo "#define NV_REMAP_PAGE_RANGE_ARGUMENT_COUNT 4" >> conftest.h
+                rm -f conftest$$.o
+                return
+            else
+                echo "#error remap_page_range() conftest failed!" >> conftest.h
+                return
+            fi
+        ;;
+
+        set_memory_uc)
+            #
+            # Determine if the set_memory_uc() function is present.
+            #
+            CODE="
+            #include <asm/cacheflush.h>
+            void conftest_set_memory_uc(void) {
+                set_memory_uc();
+            }"
+
+            compile_check_conftest "$CODE" "NV_SET_MEMORY_UC_PRESENT" "" "functions"
+        ;;
+
+        set_memory_array_uc)
+            #
+            # Determine if the set_memory_array_uc() function is present.
+            #
+            CODE="
+            #include <asm/cacheflush.h>
+            void conftest_set_memory_array_uc(void) {
+                set_memory_array_uc();
+            }"
+
+            compile_check_conftest "$CODE" "NV_SET_MEMORY_ARRAY_UC_PRESENT" "" "functions"
+        ;;
+
+        set_pages_uc)
+            #
+            # Determine if the set_pages_uc() function is present.
+            #
+            CODE="
+            #include <asm/cacheflush.h>
+            void conftest_set_pages_uc(void) {
+                set_pages_uc();
+            }"
+
+        ;;
+
+        outer_flush_all)
+            #
+            # Determine if the outer_cache_fns struct has flush_all member.
+            #
+            CODE="
+            #include <asm/outercache.h>
+            int conftest_outer_flush_all(void) {
+                return offsetof(struct outer_cache_fns, flush_all);
+            }"
+
+            compile_check_conftest "$CODE" "NV_OUTER_FLUSH_ALL_PRESENT" "" "types"
+        ;;
+
+        change_page_attr)
+            #
+            # Determine if the change_page_attr() function is
+            # present.
+            #
+            CODE="
+            #include <linux/version.h>
+            #include <linux/utsname.h>
+            #include <linux/mm.h>
+            #if LINUX_VERSION_CODE >= KERNEL_VERSION(2, 6, 0)
+              #include <asm/cacheflush.h>
+            #endif
+            void conftest_change_page_attr(void) {
+                change_page_attr();
+            }"
+
+            compile_check_conftest "$CODE" "NV_CHANGE_PAGE_ATTR_PRESENT" "" "functions"
+        ;;
+
+        pci_get_class)
+            #
+            # Determine if the pci_get_class() function is
+            # present.
+            #
+            CODE="
+            #include <linux/pci.h>
+            void conftest_pci_get_class(void) {
+                pci_get_class();
+            }"
+
+            compile_check_conftest "$CODE" "NV_PCI_GET_CLASS_PRESENT" "" "functions"
+        ;;
+
+        pci_get_domain_bus_and_slot)
+            #
+            # Determine if the pci_get_domain_bus_and_slot() function
+            # is present.
+            #
+            CODE="
+            #include <linux/pci.h>
+            void conftest_pci_get_domain_bus_and_slot(void) {
+                pci_get_domain_bus_and_slot();
+            }"
+
+            compile_check_conftest "$CODE" "NV_PCI_GET_DOMAIN_BUS_AND_SLOT_PRESENT" "" "functions"
+        ;;
+
+        remap_pfn_range)
+            #
+            # Determine if the remap_pfn_range() function is
+            # present.
+            #
+            CODE="
+            #include <linux/mm.h>
+            void conftest_remap_pfn_range(void) {
+                remap_pfn_range();
+            }"
+
+            compile_check_conftest "$CODE" "NV_REMAP_PFN_RANGE_PRESENT" "" "functions"
+        ;;
+
+        agp_backend_acquire)
+            #
+            # Determine if the agp_backend_acquire() function is
+            # present and how many arguments it takes.
+            #
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/types.h>
+            #include <linux/agp_backend.h>
+            typedef struct agp_bridge_data agp_bridge_data;
+            agp_bridge_data *conftest_agp_backend_acquire(struct pci_dev *dev) {
+                return agp_backend_acquire(dev, 0L);
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                echo "#undef NV_AGP_BACKEND_ACQUIRE_PRESENT" >> conftest.h
+                rm -f conftest$$.o
+                return
+            fi
+
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/types.h>
+            #include <linux/agp_backend.h>
+            typedef struct agp_bridge_data agp_bridge_data;
+            agp_bridge_data *conftest_agp_backend_acquire(struct pci_dev *dev) {
+                return agp_backend_acquire(dev);
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                echo "#define NV_AGP_BACKEND_ACQUIRE_PRESENT" >> conftest.h
+                echo "#define NV_AGP_BACKEND_ACQUIRE_ARGUMENT_COUNT 1" >> conftest.h
+                rm -f conftest$$.o
+                return
+            fi
+
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/types.h>
+            #include <linux/agp_backend.h>
+            typedef struct agp_bridge_data agp_bridge_data;
+            agp_bridge_data *conftest_agp_backend_acquire(void) {
+                return agp_backend_acquire();
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                echo "#define NV_AGP_BACKEND_ACQUIRE_PRESENT" >> conftest.h
+                echo "#define NV_AGP_BACKEND_ACQUIRE_ARGUMENT_COUNT 0" >> conftest.h
+                rm -f conftest$$.o
+                return
+            else
+                echo "#error agp_backend_acquire() conftest failed!" >> conftest.h
+                return
+            fi
+        ;;
+
+        vmap)
+            #
+            # Determine if the vmap() function is present and how
+            # many arguments it takes.
+            #
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/vmalloc.h>
+            void conftest_vmap(void) {
+                vmap();
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                echo "#undef NV_VMAP_PRESENT" >> conftest.h
+                rm -f conftest$$.o
+                return
+            fi
+
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/vmalloc.h>
+            void *conftest_vmap(struct page **pages, int count) {
+                return vmap(pages, count);
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                echo "#define NV_VMAP_PRESENT" >> conftest.h
+                echo "#define NV_VMAP_ARGUMENT_COUNT 2" >> conftest.h
+                rm -f conftest$$.o
+                return
+            fi
+
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/vmalloc.h>
+            #include <linux/mm.h>
+            void *conftest_vmap(struct page **pages, int count) {
+                return vmap(pages, count, 0, PAGE_KERNEL);
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                echo "#define NV_VMAP_PRESENT" >> conftest.h
+                echo "#define NV_VMAP_ARGUMENT_COUNT 4" >> conftest.h
+                rm -f conftest$$.o
+                return
+            else
+                echo "#error vmap() conftest failed!" >> conftest.h
+                return
+            fi
+        ;;
+
+        i2c_adapter)
+            #
+            # Determine if the 'i2c_adapter' structure has inc_use()
+            # and client_register() members.
+            #
+            CODE="
+            #include <linux/i2c.h>
+            int conftest_i2c_adapter(void) {
+                return offsetof(struct i2c_adapter, inc_use);
+            }"
+
+            compile_check_conftest "$CODE" "NV_I2C_ADAPTER_HAS_INC_USE" "" "types"
+
+            CODE="
+            #include <linux/i2c.h>
+            int conftest_i2c_adapter(void) {
+                return offsetof(struct i2c_adapter, client_register);
+            }"
+
+            compile_check_conftest "$CODE" "NV_I2C_ADAPTER_HAS_CLIENT_REGISTER" "" "types"
+        ;;
+
+        pm_message_t)
+            #
+            # Determine if the 'pm_message_t' data type is present
+            # and if it as an 'event' member.
+            #
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/pm.h>
+            void conftest_pm_message_t(pm_message_t state) {
+                pm_message_t *p = &state;
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                echo "#define NV_PM_MESSAGE_T_PRESENT" >> conftest.h
+                rm -f conftest$$.o
+            else
+                echo "#undef NV_PM_MESSAGE_T_PRESENT" >> conftest.h
+                echo "#undef NV_PM_MESSAGE_T_HAS_EVENT" >> conftest.h
+                return
+            fi
+
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/pm.h>  
+            int conftest_pm_message_t(void) {
+                return offsetof(pm_message_t, event);
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                echo "#define NV_PM_MESSAGE_T_HAS_EVENT" >> conftest.h
+                rm -f conftest$$.o
+                return
+            else
+                echo "#undef NV_PM_MESSAGE_T_HAS_EVENT" >> conftest.h
+                return
+            fi
+        ;;
+
+        pci_choose_state)
+            #
+            # Determine if the pci_choose_state() function is
+            # present.
+            #
+            CODE="
+            #include <linux/pci.h>
+            void conftest_pci_choose_state(void) {
+                pci_choose_state();
+            }"
+
+            compile_check_conftest "$CODE" "NV_PCI_CHOOSE_STATE_PRESENT" "" "functions"
+        ;;
+
+        vm_insert_page)
+            #
+            # Determine if the vm_insert_page() function is
+            # present.
+            #
+            CODE="
+            #include <linux/mm.h>
+            void conftest_vm_insert_page(void) {
+                vm_insert_page();
+            }"
+
+            compile_check_conftest "$CODE" "NV_VM_INSERT_PAGE_PRESENT" "" "functions"
+        ;;
+
+        irq_handler_t)
+            #
+            # Determine if the 'irq_handler_t' type is present and
+            # if it takes a 'struct ptregs *' argument.
+            #
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/interrupt.h>
+            irq_handler_t conftest_isr;
+            " > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ ! -f conftest$$.o ]; then
+                echo "#undef NV_IRQ_HANDLER_T_PRESENT" >> conftest.h
+                rm -f conftest$$.o
+                return
+            fi
+
+            rm -f conftest$$.o
+
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/interrupt.h>
+            irq_handler_t conftest_isr;
+            int conftest_irq_handler_t(int irq, void *arg) {
+                return conftest_isr(irq, arg);
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                echo "#define NV_IRQ_HANDLER_T_PRESENT" >> conftest.h
+                echo "#define NV_IRQ_HANDLER_T_ARGUMENT_COUNT 2" >> conftest.h
+                rm -f conftest$$.o
+                return
+            fi
+
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/interrupt.h>
+            irq_handler_t conftest_isr;
+            int conftest_irq_handler_t(int irq, void *arg, struct pt_regs *regs) {
+                return conftest_isr(irq, arg, regs);
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                echo "#define NV_IRQ_HANDLER_T_PRESENT" >> conftest.h
+                echo "#define NV_IRQ_HANDLER_T_ARGUMENT_COUNT 3" >> conftest.h
+                rm -f conftest$$.o
+                return
+            else
+                echo "#error irq_handler_t() conftest failed!" >> conftest.h
+                return
+            fi
+        ;;
+
+        acpi_device_ops)
+            #
+            # Determine if the 'acpi_device_ops' structure has
+            # a match() member.
+            #
+            CODE="
+            #include <linux/acpi.h>
+            int conftest_acpi_device_ops(void) {
+                return offsetof(struct acpi_device_ops, match);
+            }"
+
+            compile_check_conftest "$CODE" "NV_ACPI_DEVICE_OPS_HAS_MATCH" "" "types"
+        ;;
+
+        acpi_op_remove)
+            #
+            # Determine the number of arguments to pass to the
+            # 'acpi_op_remove' routine.
+            #
+
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/acpi.h>
+
+            acpi_op_remove conftest_op_remove_routine;
+
+            int conftest_acpi_device_ops_remove(struct acpi_device *device) {
+                return conftest_op_remove_routine(device);
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                rm -f conftest$$.o
+                echo "#define NV_ACPI_DEVICE_OPS_REMOVE_ARGUMENT_COUNT 1"  >> conftest.h
+                return
+            fi
+
+            CODE="
+            #include <linux/acpi.h>
+
+            acpi_op_remove conftest_op_remove_routine;
+
+            int conftest_acpi_device_ops_remove(struct acpi_device *device, int type) {
+                return conftest_op_remove_routine(device, type);
+            }"
+
+            compile_check_conftest "$CODE" "NV_ACPI_DEVICE_OPS_REMOVE_ARGUMENT_COUNT" "2" "types"
+        ;;
+
+        acpi_device_id)
+            #
+            # Determine if the 'acpi_device_id' structure has 
+            # a 'driver_data' member.
+            #
+            CODE="
+            #include <linux/acpi.h>
+            int conftest_acpi_device_id(void) {
+                return offsetof(struct acpi_device_id, driver_data);
+            }"
+
+            compile_check_conftest "$CODE" "NV_ACPI_DEVICE_ID_HAS_DRIVER_DATA" "" "types"
+        ;;
+
+        acquire_console_sem)
+            #
+            # Determine if the acquire_console_sem() function
+            # is present.
+            #
+            CODE="
+            #include <linux/console.h>
+            void conftest_acquire_console_sem(void) {
+                acquire_console_sem(NULL);
+            }"
+
+            compile_check_conftest "$CODE" "NV_ACQUIRE_CONSOLE_SEM_PRESENT" "" "functions"
+        ;;
+
+        console_lock)
+            #
+            # Determine if the console_lock() function is present.
+            #
+            CODE="
+            #include <linux/console.h>
+            void conftest_console_lock(void) {
+                console_lock(NULL);
+            }"
+
+            compile_check_conftest "$CODE" "NV_CONSOLE_LOCK_PRESENT" "" "functions"
+        ;;
+
+        kmem_cache_create)
+            #
+            # Determine if the kmem_cache_create() function is
+            # present and how many arguments it takes.
+            #
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/slab.h>
+            void conftest_kmem_cache_create(void) {
+                kmem_cache_create();
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                rm -f conftest$$.o
+                echo "#undef NV_KMEM_CACHE_CREATE_PRESENT" >> conftest.h
+                return
+            fi
+
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/slab.h>
+            void conftest_kmem_cache_create(void) {
+                kmem_cache_create(NULL, 0, 0, 0L, NULL, NULL);
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                rm -f conftest$$.o
+                echo "#define NV_KMEM_CACHE_CREATE_PRESENT" >> conftest.h
+                echo "#define NV_KMEM_CACHE_CREATE_ARGUMENT_COUNT 6" >> conftest.h
+                return
+            fi
+
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/slab.h>
+            void conftest_kmem_cache_create(void) {
+                kmem_cache_create(NULL, 0, 0, 0L, NULL);
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                rm -f conftest$$.o
+                echo "#define NV_KMEM_CACHE_CREATE_PRESENT" >> conftest.h
+                echo "#define NV_KMEM_CACHE_CREATE_ARGUMENT_COUNT 5" >> conftest.h
+                return
+            else
+                echo "#error kmem_cache_create() conftest failed!" >> conftest.h
+            fi
+        ;;
+
+        smp_call_function)
+            #
+            # Determine if the smp_call_function() function is
+            # present and how many arguments it takes.
+            #
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/smp.h>
+            void conftest_smp_call_function(void) {
+            #ifdef CONFIG_SMP
+                smp_call_function();
+            #endif
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                rm -f conftest$$.o
+                echo "#undef NV_SMP_CALL_FUNCTION_PRESENT" >> conftest.h
+                return
+            fi
+
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/smp.h>
+            void conftest_smp_call_function(void) {
+                smp_call_function(NULL, NULL, 0, 0);
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                rm -f conftest$$.o
+                echo "#define NV_SMP_CALL_FUNCTION_PRESENT" >> conftest.h
+                echo "#define NV_SMP_CALL_FUNCTION_ARGUMENT_COUNT 4" >> conftest.h
+                return
+            fi
+
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/smp.h>
+            void conftest_smp_call_function(void) {
+                smp_call_function(NULL, NULL, 0);
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                rm -f conftest$$.o
+                echo "#define NV_SMP_CALL_FUNCTION_PRESENT" >> conftest.h
+                echo "#define NV_SMP_CALL_FUNCTION_ARGUMENT_COUNT 3" >> conftest.h
+                return
+            else
+                echo "#error smp_call_function() conftest failed!" >> conftest.h
+            fi
+        ;;
+
+        on_each_cpu)
+            #
+            # Determine if the on_each_cpu() function is present
+            # and how many arguments it takes.
+            #
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/smp.h>
+            void conftest_on_each_cpu(void) {
+            #ifdef CONFIG_SMP
+                on_each_cpu();
+            #endif
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                rm -f conftest$$.o
+                echo "#undef NV_ON_EACH_CPU_PRESENT" >> conftest.h
+                return
+            fi
+
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/smp.h>
+            void conftest_on_each_cpu(void) {
+                on_each_cpu(NULL, NULL, 0, 0);
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                rm -f conftest$$.o
+                echo "#define NV_ON_EACH_CPU_PRESENT" >> conftest.h
+                echo "#define NV_ON_EACH_CPU_ARGUMENT_COUNT 4" >> conftest.h
+                return
+            fi
+
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/smp.h>
+            void conftest_on_each_cpu(void) {
+                on_each_cpu(NULL, NULL, 0);
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                rm -f conftest$$.o
+                echo "#define NV_ON_EACH_CPU_PRESENT" >> conftest.h
+                echo "#define NV_ON_EACH_CPU_ARGUMENT_COUNT 3" >> conftest.h
+                return
+            else
+                echo "#error on_each_cpu() conftest failed!" >> conftest.h
+            fi
+        ;;
+
+        vmm_support)
+            # check if a VMM is supported (Xen only for now).
+            if [ -f nv-xen.h ]; then
+                echo "#define HAVE_NV_XEN 1" >> conftest.h
+                return
+            else
+                echo "#undef HAVE_NV_XEN" >> conftest.h
+            fi
+        ;;
+
+        acpi_evaluate_integer)
+            #
+            # Determine if the acpi_evaluate_integer() function is
+            # present and the type of its 'data' argument.
+            #
+
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/acpi.h>
+            acpi_status acpi_evaluate_integer(acpi_handle h, acpi_string s,
+                struct acpi_object_list *l, unsigned long long *d) {
+                return AE_OK;
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                rm -f conftest$$.o
+                echo "#define NV_ACPI_EVALUATE_INTEGER_PRESENT" >> conftest.h
+                echo "typedef unsigned long long nv_acpi_integer_t;" >> conftest.h
+                return
+            fi
+
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/acpi.h>
+            acpi_status acpi_evaluate_integer(acpi_handle h, acpi_string s,
+                struct acpi_object_list *l, unsigned long *d) {
+                return AE_OK;
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                rm -f conftest$$.o
+                echo "#define NV_ACPI_EVALUATE_INTEGER_PRESENT" >> conftest.h
+                echo "typedef unsigned long nv_acpi_integer_t;" >> conftest.h
+                return
+            else
+                #
+                # We can't report a compile test failure here because
+                # this is a catch-all for both kernels that don't
+                # have acpi_evaluate_integer() and kernels that have
+                # broken header files that make it impossible to
+                # tell if the function is present.
+                #
+                echo "#undef NV_ACPI_EVALUATE_INTEGER_PRESENT" >> conftest.h
+                echo "typedef unsigned long nv_acpi_integer_t;" >> conftest.h
+            fi
+        ;;
+
+        acpi_walk_namespace)
+            #
+            # Determine if the acpi_walk_namespace() function is present
+            # and how many arguments it takes.
+            #
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/acpi.h>
+            void conftest_acpi_walk_namespace(void) {
+                acpi_walk_namespace();
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                rm -f conftest$$.o
+                echo "#undef NV_ACPI_WALK_NAMESPACE_PRESENT" >> conftest.h
+                return
+            fi
+
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/acpi.h>
+            void conftest_acpi_walk_namespace(void) {
+                acpi_walk_namespace(0, NULL, 0, NULL, NULL, NULL, NULL);
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                rm -f conftest$$.o
+                echo "#define NV_ACPI_WALK_NAMESPACE_PRESENT" >> conftest.h
+                echo "#define NV_ACPI_WALK_NAMESPACE_ARGUMENT_COUNT 7" >> conftest.h
+                return
+            fi
+
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/acpi.h>
+            void conftest_acpi_walk_namespace(void) {
+                acpi_walk_namespace(0, NULL, 0, NULL, NULL, NULL);
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                rm -f conftest$$.o
+                echo "#define NV_ACPI_WALK_NAMESPACE_PRESENT" >> conftest.h
+                echo "#define NV_ACPI_WALK_NAMESPACE_ARGUMENT_COUNT 6" >> conftest.h
+                return
+            else
+                echo "#error acpi_walk_namespace() conftest failed!" >> conftest.h
+            fi
+        ;;
+
+        ioremap_cache)
+            #
+            # Determine if the ioremap_cache() function is present.
+            #
+            CODE="
+            #include <asm/io.h>
+            void conftest_ioremap_cache(void) {
+                ioremap_cache();
+            }"
+
+            compile_check_conftest "$CODE" "NV_IOREMAP_CACHE_PRESENT" "" "functions"
+        ;;
+
+        ioremap_wc)
+            #
+            # Determine if the ioremap_wc() function is present.
+            #
+            CODE="
+            #include <asm/io.h>
+            void conftest_ioremap_wc(void) {
+                ioremap_wc();
+            }"
+
+            compile_check_conftest "$CODE" "NV_IOREMAP_WC_PRESENT" "" "functions"
+        ;;
+
+        proc_dir_entry)
+            #
+            # Determine if the 'proc_dir_entry' structure has 
+            # an 'owner' member.
+            #
+            CODE="
+            #include <linux/proc_fs.h>
+            int conftest_proc_dir_entry(void) {
+                return offsetof(struct proc_dir_entry, owner);
+            }"
+
+            compile_check_conftest "$CODE" "NV_PROC_DIR_ENTRY_HAS_OWNER" "" "types"
+        ;;
+
+      INIT_WORK)
+            #
+            # Determine how many arguments the INIT_WORK() macro
+            # takes.
+            #
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/workqueue.h>
+            void conftest_INIT_WORK(void) {
+                INIT_WORK();
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                echo "#undef NV_INIT_WORK_PRESENT" >> conftest.h
+                rm -f conftest$$.o
+                return
+            fi
+
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/workqueue.h>
+            void conftest_INIT_WORK(void) {
+                INIT_WORK((struct work_struct *)NULL, NULL, NULL);
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                echo "#define NV_INIT_WORK_PRESENT" >> conftest.h
+                echo "#define NV_INIT_WORK_ARGUMENT_COUNT 3" >> conftest.h
+                rm -f conftest$$.o
+                return
+            fi
+
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/workqueue.h>
+            void conftest_INIT_WORK(void) {
+                INIT_WORK((struct work_struct *)NULL, NULL);
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                echo "#define NV_INIT_WORK_PRESENT" >> conftest.h
+                echo "#define NV_INIT_WORK_ARGUMENT_COUNT 2" >> conftest.h
+                rm -f conftest$$.o
+                return
+            else
+                echo "#error INIT_WORK() conftest failed!" >> conftest.h
+                return
+            fi
+        ;;
+
+      pci_dma_mapping_error)
+            #
+            # Determine how many arguments pci_dma_mapping_error()
+            # takes.
+            #
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/pci.h>
+            int conftest_pci_dma_mapping_error(void) {
+                return pci_dma_mapping_error(NULL, 0);
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                echo "#define NV_PCI_DMA_MAPPING_ERROR_PRESENT" >> conftest.h
+                echo "#define NV_PCI_DMA_MAPPING_ERROR_ARGUMENT_COUNT 2" >> conftest.h
+                rm -f conftest$$.o
+                return
+            fi
+
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/pci.h>
+            int conftest_pci_dma_mapping_error(void) {
+                return pci_dma_mapping_error(0);
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                echo "#define NV_PCI_DMA_MAPPING_ERROR_PRESENT" >> conftest.h
+                echo "#define NV_PCI_DMA_MAPPING_ERROR_ARGUMENT_COUNT 1" >> conftest.h
+                rm -f conftest$$.o
+                return
+            else
+                echo "#error pci_dma_mapping_error() conftest failed!" >> conftest.h
+                return
+            fi
+        ;;
+
+        agp_memory)
+            #
+            # Determine if the 'agp_memory' structure has
+            # a 'pages' member.
+            #
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/types.h>
+            #include <linux/agp_backend.h>
+            int conftest_agp_memory(void) {
+                return offsetof(struct agp_memory, pages);
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                echo "#define NV_AGP_MEMORY_HAS_PAGES" >> conftest.h
+                rm -f conftest$$.o
+                return
+            else
+                echo "#undef NV_AGP_MEMORY_HAS_PAGES" >> conftest.h
+                return
+            fi
+        ;;
+
+        scatterlist)
+            #
+            # Determine if the 'scatterlist' structure has
+            # a 'page_link' member.
+            #
+            CODE="
+            #include <linux/types.h>
+            #include <linux/scatterlist.h>
+            int conftest_scatterlist(void) {
+                return offsetof(struct scatterlist, page_link);
+            }"
+
+            compile_check_conftest "$CODE" "NV_SCATTERLIST_HAS_PAGE_LINK" "" "types"
+        ;;
+
+        pci_domain_nr)
+            #
+            # Determine if the pci_domain_nr() function is present.
+            #
+            CODE="
+            #include <linux/types.h>
+            #include <linux/pci.h>
+            int conftest_pci_domain_nr(struct pci_dev *dev) {
+                return pci_domain_nr();
+            }"
+
+            compile_check_conftest "$CODE" "NV_PCI_DOMAIN_NR_PRESENT" "" "functions"
+        ;;
+
+        file_operations)
+            #
+            # Determine if the 'file_operations' structure has
+            # 'ioctl', 'unlocked_ioctl' and 'compat_ioctl' fields.
+            #
+            CODE="
+            #include <linux/fs.h>
+            int conftest_file_operations(void) {
+                return offsetof(struct file_operations, ioctl);
+            }"
+
+            compile_check_conftest "$CODE" "NV_FILE_OPERATIONS_HAS_IOCTL" "" "types"
+
+            CODE="
+            #include <linux/fs.h>
+            int conftest_file_operations(void) {
+                return offsetof(struct file_operations, unlocked_ioctl);
+            }"
+
+            compile_check_conftest "$CODE" "NV_FILE_OPERATIONS_HAS_UNLOCKED_IOCTL" "" "types"
+
+            CODE="
+            #include <linux/fs.h>
+            int conftest_file_operations(void) {
+                return offsetof(struct file_operations, compat_ioctl);
+            }"
+
+            compile_check_conftest "$CODE" "NV_FILE_OPERATIONS_HAS_COMPAT_IOCTL" "" "types"
+        ;;
+
+        sg_init_table)
+            #
+            # Determine if the sg_init_table() function is present.
+            #
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/scatterlist.h>
+            void conftest_sg_init_table(struct scatterlist *sgl,
+                    unsigned int nents) {
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ ! -f conftest$$.o ]; then
+                echo "#undef NV_SG_INIT_TABLE_PRESENT" >> conftest.h
+                return
+
+            fi
+            rm -f conftest$$.o
+
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/types.h>
+            #include <linux/scatterlist.h>
+            void conftest_sg_init_table(struct scatterlist *sgl,
+                    unsigned int nents) {
+                sg_init_table();
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                echo "#undef NV_SG_INIT_TABLE_PRESENT" >> conftest.h
+                rm -f conftest$$.o
+                return
+            else
+                echo "#define NV_SG_INIT_TABLE_PRESENT" >> conftest.h
+                return
+            fi
+        ;;
+
+        efi_enabled)
+            #
+            # Determine if the efi_enabled symbol is present, or if
+            # the efi_enabled() function is present and how many
+            # arguments it takes.
+            #
+            echo "$CONFTEST_PREAMBLE
+            #if defined(NV_LINUX_EFI_H_PRESENT)
+            #include <linux/efi.h> 
+            #endif
+            int conftest_efi_enabled(void) {
+                return efi_enabled();
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                echo "#undef NV_EFI_ENABLED_PRESENT" | append_conftest "symbols"
+                echo "#undef NV_EFI_ENABLED_PRESENT" | append_conftest "functions"
+                rm -f conftest$$.o
+                return
+            fi
+
+            echo "$CONFTEST_PREAMBLE
+            #if defined(NV_LINUX_EFI_H_PRESENT)
+            #include <linux/efi.h> 
+            #endif
+            int conftest_efi_enabled(void) {
+                return efi_enabled(0);
+            }" > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+            rm -f conftest$$.c
+
+            if [ -f conftest$$.o ]; then
+                echo "#define NV_EFI_ENABLED_PRESENT" | append_conftest "functions"
+                echo "#define NV_EFI_ENABLED_ARGUMENT_COUNT 1" | append_conftest "functions"
+                rm -f conftest$$.o
+                return
+            else
+                echo "#define NV_EFI_ENABLED_PRESENT" | append_conftest "symbols"
+                return
+            fi
+        ;;
+
+        proc_create_data)
+            #
+            # Determine if the proc_create_data() function is present.
+            #
+            CODE="
+            #include <linux/proc_fs.h>
+            void conftest_proc_create_data(void) {
+                proc_create_data();
+            }"
+
+            compile_check_conftest "$CODE" "NV_PROC_CREATE_DATA_PRESENT" "" "functions"
+        ;;
+
+
+        pde_data)
+            #
+            # Determine if the PDE_DATA() function is present.
+            #
+            CODE="
+            #include <linux/proc_fs.h>
+            void conftest_PDE_DATA(void) {
+                PDE_DATA();
+            }"
+
+            compile_check_conftest "$CODE" "NV_PDE_DATA_PRESENT" "" "functions"
+        ;;
+
+        proc_remove)
+            #
+            # Determine if the proc_remove() function is present.
+            #
+            CODE="
+            #include <linux/proc_fs.h>
+            void conftest_proc_remove(void) {
+                proc_remove();
+            }"
+
+            compile_check_conftest "$CODE" "NV_PROC_REMOVE_PRESENT" "" "functions"
+        ;;
+
+        drm_available)
+            #
+            # Determine if the DRM subsystem is usable
+            #
+            CODE="
+            #if defined(NV_DRM_DRMP_H_PRESENT)
+            #include <drm/drmP.h>
+            #endif
+            #if !defined(CONFIG_DRM) && !defined(CONFIG_DRM_MODULE)
+            #error DRM not enabled
+            #endif
+            void conftest_drm_available(void) {
+                struct drm_driver drv;
+                drv.gem_prime_pin = 0;
+                drv.gem_prime_get_sg_table = 0;
+                drv.gem_prime_vmap = 0;
+                drv.gem_prime_vunmap = 0;
+                (void)drm_gem_prime_import;
+                (void)drm_gem_prime_export;
+            }"
+
+            compile_check_conftest "$CODE" "NV_DRM_AVAILABLE" "" "generic"
+        ;;
+
+        get_num_physpages)
+            #
+            # Determine if the get_num_physpages() function is
+            # present.
+            #
+            CODE="
+            #include <linux/mm.h>
+            void conftest_get_num_physpages(void) {
+                get_num_physpages(NULL);
+            }"
+
+            compile_check_conftest "$CODE" "NV_GET_NUM_PHYSPAGES_PRESENT" "" "functions"
+        ;;
+
+        pm_vt_switch_required)
+            #
+            # Determine if the pm_vt_switch_required() function is present.
+            #
+            CODE="
+            #include <linux/pm.h>
+            void conftest_pm_vt_switch_required(void) {
+                pm_vt_switch_required();
+            }"
+
+            compile_check_conftest "$CODE" "NV_PM_VT_SWITCH_REQUIRED_PRESENT" "" "functions"
+        ;;
+
+        file_inode)
+            #
+            # Determine if the 'file' structure has
+            # a 'f_inode' field.
+            #
+            CODE="
+            #include <linux/fs.h>
+            int conftest_file_inode(void) {
+                return offsetof(struct file, f_inode);
+            }"
+
+            compile_check_conftest "$CODE" "NV_FILE_HAS_INODE" "" "types"
+        ;;
+
+        drm_pci_set_busid)
+            #
+            # Determine if the drm_pci_set_busid function is present.
+            #
+            CODE="
+            #if defined(NV_DRM_DRMP_H_PRESENT)
+            #include <drm/drmP.h>
+            #endif
+            void conftest_drm_pci_set_busid(void) {
+                drm_pci_set_busid();
+            }"
+
+            compile_check_conftest "$CODE" "NV_DRM_PCI_SET_BUSID_PRESENT" "" "functions"
+        ;;
+
+        write_cr4)
+            #
+            # Determine if the write_cr4() function is present.
+            #
+            CODE="
+            #include <asm/processor.h>
+            #if defined(NV_ASM_SYSTEM_H_PRESENT)
+            #include <asm/system.h>
+            #endif
+            void conftest_write_cr4(void) {
+                write_cr4();
+            }"
+
+            compile_check_conftest "$CODE" "NV_WRITE_CR4_PRESENT" "" "functions"
+        ;;
+
+        for_each_online_node)
+            #
+            # Determine if the for_each_online_node() function is present.
+            #
+            CODE="
+            #include <linux/mm.h>
+            void conftest_for_each_online_node() {
+                for_each_online_node();
+            }"
+
+            compile_check_conftest "$CODE" "NV_FOR_EACH_ONLINE_NODE_PRESENT" "" "functions"
+        ;;
+
+        node_end_pfn)
+            #
+            # Determine if the node_end_pfn() function is present.
+            #
+            CODE="
+            #include <linux/mm.h>
+            void conftest_node_end_pfn() {
+                node_end_pfn();
+            }"
+
+            compile_check_conftest "$CODE" "NV_NODE_END_PFN_PRESENT" "" "functions"
+        ;;
+
+        get_user_pages_remote)
+            #
+            # Determine if the function get_user_pages_remote() is
+            # present.
+            #
+            # get_user_pages_remote() was added by:
+            #   2016 Feb 12: 1e9877902dc7e11d2be038371c6fbf2dfcd469d7
+            #
+            CODE="
+            #include <linux/mm.h>
+            int conftest_get_user_pages_remote(void) {
+                get_user_pages_remote();
+            }"
+
+            compile_check_conftest "$CODE" "NV_GET_USER_PAGES_REMOTE_PRESENT" "" "functions"
+        ;;
+    esac
+}
+
+build_cflags
+
+case "$6" in
+    cc_sanity_check)
+        #
+        # Check if the selected compiler can create object files
+        # in the current environment.
+        #
+        VERBOSE=$7
+
+        echo "int cc_sanity_check(void) {
+            return 0;
+        }" > conftest$$.c
+
+        $CC -c conftest$$.c > /dev/null 2>&1
+        rm -f conftest$$.c
+
+        if [ ! -f conftest$$.o ]; then
+            if [ "$VERBOSE" = "full_output" ]; then
+                echo "";
+            fi
+            if [ "$CC" != "cc" ]; then
+                echo "The C compiler '$CC' does not appear to be able to"
+                echo "create object files.  Please make sure you have "
+                echo "your Linux distribution's libc development package"
+                echo "installed and that '$CC' is a valid C compiler";
+                echo "name."
+            else
+                echo "The C compiler '$CC' does not appear to be able to"
+                echo "create executables.  Please make sure you have "
+                echo "your Linux distribution's gcc and libc development"
+                echo "packages installed."
+            fi
+            if [ "$VERBOSE" = "full_output" ]; then
+                echo "";
+                echo "*** Failed CC sanity check. Bailing out! ***";
+                echo "";
+            fi
+            exit 1
+        else
+            rm -f conftest$$.o
+            exit 0
+        fi
+    ;;
+
+    cc_version_check)
+        #
+        # Verify that the same compiler is used for the kernel and kernel
+        # module.
+        #
+        VERBOSE=$7
+        
+        if [ ! -f gcc-version-check.c ]; then
+          #
+          # gcc-version-check.c is not in the current working directory.
+          # This can happen when building the kernel module from an
+          # NVIDIA-internal intermediate directory prior to creating an
+          # NVIDIA driver package.  Since the version check below is less
+          # useful than it used to be, just silently skip the test if
+          # gcc-version-check.c is missing.
+          #
+          IGNORE_CC_MISMATCH=1
+        fi
+
+        if [ -n "$IGNORE_CC_MISMATCH" -o -n "$SYSSRC" -o -n "$SYSINCLUDE" ]; then
+          #
+          # The user chose to disable the CC version test (which may or
+          # may not be wise) or is building the module for a kernel not
+          # currently running, which renders the test meaningless.
+          #
+          exit 0
+        fi
+
+        rm -f gcc-version-check
+        $HOSTCC gcc-version-check.c -o gcc-version-check > /dev/null 2>&1
+        if [ ! -f gcc-version-check ]; then
+            if [ "$CC" != "cc" ]; then
+                MSG="Could not compile 'gcc-version-check.c'.  Please be "
+                MSG="$MSG sure you have your Linux distribution's libc "
+                MSG="$MSG development package installed and that '$CC' "
+                MSG="$MSG is a valid C compiler name."
+            else
+                MSG="Could not compile 'gcc-version-check.c'.  Please be "
+                MSG="$MSG sure you have your Linux distribution's gcc "
+                MSG="$MSG and libc development packages installed."
+            fi
+            RET=1
+        else
+            PROC_VERSION="/proc/version"
+            if [ -f $PROC_VERSION ]; then
+                MSG=`./gcc-version-check "$(cat $PROC_VERSION)"`
+                RET=$?
+            else
+                MSG="$PROC_VERSION does not exist."
+                RET=1
+            fi
+            rm -f gcc-version-check
+        fi
+
+        if [ "$RET" != "0" ]; then
+            #
+            # The gcc version check failed
+            #
+            
+            if [ "$VERBOSE" = "full_output" ]; then
+                echo "";
+                echo "gcc-version-check failed:";
+                echo "";
+                echo "$MSG" | fmt -w 52
+                echo "";
+                echo "If you know what you are doing and want to override";
+                echo "the gcc version check, you can do so by setting the";
+                echo "IGNORE_CC_MISMATCH environment variable to \"1\".";
+                echo "";
+                echo "In any other case, set the CC environment variable";
+                echo "to the name of the compiler that was used to compile";
+                echo "the kernel.";
+                echo ""
+                echo "*** Failed CC version check. Bailing out! ***";
+                echo "";
+            else
+                echo "$MSG";
+            fi
+            exit 1;
+        else
+            exit 0
+        fi
+    ;;
+
+    suser_sanity_check)
+        #
+        # Determine the caller's user id to determine if we have sufficient
+        # privileges for the requested operation.
+        #
+        if [ $(id -ur) != 0 ]; then
+            echo "";
+            echo "Please run \"make install\" as root.";
+            echo "";
+            echo "*** Failed super-user sanity check. Bailing out! ***";
+            exit 1
+        else
+            exit 0
+        fi
+    ;;
+
+    rmmod_sanity_check)
+        #
+        # Make sure that any currently loaded NVIDIA kernel module can be
+        # unloaded.
+        #
+        MODULE="nvidia"
+
+        if [ -n "$SYSSRC" -o -n "$SYSINCLUDE" ]; then
+          #
+          # Don't attempt to remove the kernel module if we're not
+          # building against the running kernel.
+          #
+          exit 0
+        fi
+
+        if lsmod | grep -wq $MODULE; then
+          rmmod $MODULE > /dev/null 2>&1
+        fi
+
+        if lsmod | grep -wq $MODULE; then
+            #
+            # The NVIDIA kernel module is still loaded, most likely because
+            # it is busy.
+            #
+            echo "";
+            echo "Unable to remove existing NVIDIA kernel module.";
+            echo "Please be sure you have exited X before attempting";
+            echo "to install the NVIDIA kernel module.";
+            echo "";
+            echo "*** Failed rmmod sanity check. Bailing out! ***";
+            exit 1
+        else
+            exit 0
+        fi
+    ;;
+
+    select_makefile)
+        #
+        # Select which Makefile to use based on the version of the
+        # kernel we are building against: use the kbuild Makefile for
+        # 2.6 and newer kernels, and the old Makefile for kernels older
+        # than 2.6.
+        #
+        rm -f Makefile
+        RET=1
+        VERBOSE=$7
+        FILE="linux/version.h"
+        SELECTED_MAKEFILE=""
+
+        if [ -f $HEADERS/$FILE -o -f $OUTPUT/include/$FILE -o \
+	     -f $OUTPUT/include/generated/uapi/$FILE ]; then
+            #
+            # We are either looking at a configured kernel source
+            # tree or at headers shipped for a specific kernel.
+            # Determine the kernel version using a compile check.
+            #
+            rm -f conftest.h
+            test_headers
+
+            echo "$CONFTEST_PREAMBLE
+            #include <linux/version.h>
+            #include <linux/utsname.h>
+            #if defined(TEST_2_4) && (LINUX_VERSION_CODE >= KERNEL_VERSION(2,6,0))
+              #error \"!KERNEL_2_4\"
+            #endif
+            #if defined(TEST_2_6_OR_3) && (LINUX_VERSION_CODE < KERNEL_VERSION(2,6,0))
+              #error \"!KERNEL_2_6_OR_3\"
+            #endif" > conftest$$.c
+
+            $CC $CFLAGS -DTEST_2_6_OR_3 -c conftest$$.c > /dev/null 2>&1
+
+            if [ -f conftest$$.o ]; then
+                if [ -f Makefile.rmlite ]; then
+                    SELECTED_MAKEFILE=Makefile.rmlite
+                else
+                    SELECTED_MAKEFILE=Makefile.kbuild
+                fi
+                RET=0
+            else
+                $CC $CFLAGS -DTEST_2_4 -c conftest$$.c > /dev/null 2>&1
+
+                if [ -f conftest$$.o ]; then
+                    SELECTED_MAKEFILE=Makefile.nvidia
+                    RET=0
+                fi
+            fi
+
+            rm -f conftest$$.c conftest$$.o
+            rm -f conftest.h
+        else
+            MAKEFILE=$HEADERS/../Makefile
+            CONFIG=$HEADERS/../.config
+
+            if [ -f $MAKEFILE -a -f $CONFIG ]; then
+                #
+                # This source tree is not configured, but includes
+                # a Makefile and a .config file. If this is a 2.6
+                # kernel older than 2.6.6, that's all we require to
+                # build the module.
+                #
+                PATCHLEVEL=$(grep "^PATCHLEVEL =" $MAKEFILE | cut -d " " -f 3)
+                SUBLEVEL=$(grep "^SUBLEVEL =" $MAKEFILE | cut -d " " -f 3)
+
+                if [ -n "$PATCHLEVEL" -a $PATCHLEVEL -ge 6 \
+                        -a -n "$SUBLEVEL" ]; then
+                    SELECTED_MAKEFILE=Makefile.kbuild
+                    RET=0
+                fi
+            fi
+        fi
+
+        if [ "$RET" = "0" ]; then
+            ln -s $SELECTED_MAKEFILE Makefile
+            exit 0
+        else
+            echo "If you are using a Linux 2.4 kernel, please make sure";
+            echo "you either have configured kernel sources matching your";
+            echo "kernel or the correct set of kernel headers installed";
+            echo "on your system.";
+            echo "";
+            echo "If you are using a Linux 2.6 kernel, please make sure";
+            echo "you have configured kernel sources matching your kernel";
+            echo "installed on your system. If you specified a separate";
+            echo "output directory using either the \"KBUILD_OUTPUT\" or";
+            echo "the \"O\" KBUILD parameter, make sure to specify this";
+            echo "directory with the SYSOUT environment variable or with";
+            echo "the equivalent nvidia-installer command line option.";
+            echo "";
+            echo "Depending on where and how the kernel sources (or the";
+            echo "kernel headers) were installed, you may need to specify";
+            echo "their location with the SYSSRC environment variable or";
+            echo "the equivalent nvidia-installer command line option.";
+            echo "";
+            if [ "$VERBOSE" = "full_output" ]; then
+                echo "*** Unable to determine the target kernel version. ***";
+                echo "";
+            fi
+            exit 1
+        fi
+    ;;
+
+    get_uname)
+        #
+        # Print UTS_RELEASE from the kernel sources, if the kernel header
+        # file ../linux/version.h or ../linux/utsrelease.h exists. If
+        # neither header file is found, but a Makefile is found, extract
+        # PATCHLEVEL and SUBLEVEL, and use them to build the kernel
+        # release name.
+        #
+        # If no source file is found, or if an error occurred, return the
+        # output of `uname -r`.
+        #
+        RET=1
+        DIRS="generated linux"
+        FILE=""
+        
+        for DIR in $DIRS; do
+            if [ -f $HEADERS/$DIR/utsrelease.h ]; then
+                FILE="$HEADERS/$DIR/utsrelease.h"
+                break
+            elif [ -f $OUTPUT/include/$DIR/utsrelease.h ]; then
+                FILE="$OUTPUT/include/$DIR/utsrelease.h"
+                break
+            fi
+        done
+
+        if [ -z "$FILE" ]; then
+            if [ -f $HEADERS/linux/version.h ]; then
+                FILE="$HEADERS/linux/version.h"
+            elif [ -f $OUTPUT/include/linux/version.h ]; then
+                FILE="$OUTPUT/include/linux/version.h"
+            fi
+        fi
+
+        if [ -n "$FILE" ]; then
+            #
+            # We are either looking at a configured kernel source tree
+            # or at headers shipped for a specific kernel.  Determine
+            # the kernel version using a CPP check.
+            #
+            VERSION=`echo "UTS_RELEASE" | $CC - -E -P -include $FILE 2>&1`
+
+            if [ "$?" = "0" -a "VERSION" != "UTS_RELEASE" ]; then
+                echo "$VERSION"
+                RET=0
+            fi
+        else
+            #
+            # If none of the kernel headers ar found, but a Makefile is,
+            # extract PATCHLEVEL and SUBLEVEL and use them to find
+            # the kernel version.
+            #
+            MAKEFILE=$HEADERS/../Makefile
+
+            if [ -f $MAKEFILE ]; then
+                #
+                # This source tree is not configured, but includes
+                # the top-level Makefile.
+                #
+                PATCHLEVEL=$(grep "^PATCHLEVEL =" $MAKEFILE | cut -d " " -f 3)
+                SUBLEVEL=$(grep "^SUBLEVEL =" $MAKEFILE | cut -d " " -f 3)
+
+                if [ -n "$PATCHLEVEL" -a -n "$SUBLEVEL" ]; then
+                    echo 2.$PATCHLEVEL.$SUBLEVEL
+                    RET=0
+                fi
+            fi
+        fi
+
+        if [ "$RET" != "0" ]; then
+            uname -r
+            exit 1
+        else
+            exit 0
+        fi
+    ;;
+
+    rivafb_sanity_check)
+        #
+        # Check if the kernel was compiled with rivafb support. If so, then
+        # exit, since the driver no longer works with rivafb.
+        #
+        RET=1
+        VERBOSE=$7
+        OLD_FILE="linux/autoconf.h"
+        NEW_FILE="generated/autoconf.h"
+
+        if [ -f $HEADERS/$NEW_FILE -o -f $OUTPUT/include/$NEW_FILE ]; then
+            FILE=$NEW_FILE
+        fi
+        if [ -f $HEADERS/$OLD_FILE -o -f $OUTPUT/include/$OLD_FILE ]; then
+            FILE=$OLD_FILE
+        fi
+
+        if [ -n "$FILE" ]; then
+            #
+            # We are looking at a configured source tree; verify
+            # that its configuration doesn't include rivafb using
+            # a compile check.
+            #
+            rm -f conftest.h
+            test_headers
+
+            echo "$CONFTEST_PREAMBLE
+            #ifdef CONFIG_FB_RIVA
+            #error CONFIG_FB_RIVA defined!
+            #endif
+            " > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+
+            if [ -f conftest$$.o ]; then
+                RET=0
+            fi
+
+            rm -f conftest$$.c conftest$$.o
+            rm -f conftest.h
+        else
+            CONFIG=$HEADERS/../.config
+            if [ -f $CONFIG ]; then
+                if [ -z "$(grep "^CONFIG_FB_RIVA=y" $CONFIG)" ]; then
+                    RET=0
+                fi
+            fi
+        fi
+
+        if [ "$RET" != "0" ]; then
+            echo "Your kernel was configured to include rivafb support!";
+            echo "";
+            echo "The rivafb driver conflicts with the NVIDIA driver, please";
+            echo "reconfigure your kernel and *disable* rivafb support, then";
+            echo "try installing the NVIDIA kernel module again.";
+            echo "";
+            if [ "$VERBOSE" = "full_output" ]; then
+                echo "*** Failed rivafb sanity check. Bailing out! ***";
+                echo "";
+            fi
+            exit 1
+        else
+            exit 0
+        fi
+    ;;
+
+    nvidiafb_sanity_check)
+        #
+        # Check if the kernel was compiled with nvidiafb support. If so, then
+        # exit, since the driver doesn't work with nvidiafb.
+        #
+        RET=1
+        VERBOSE=$7
+        OLD_FILE="linux/autoconf.h"
+        NEW_FILE="generated/autoconf.h"
+
+        if [ -f $HEADERS/$NEW_FILE -o -f $OUTPUT/include/$NEW_FILE ]; then
+            FILE=$NEW_FILE
+        fi
+        if [ -f $HEADERS/$OLD_FILE -o -f $OUTPUT/include/$OLD_FILE ]; then
+            FILE=$OLD_FILE
+        fi
+
+        if [ -n "$FILE" ]; then
+            #
+            # We are looking at a configured source tree; verify
+            # that its configuration doesn't include nvidiafb using
+            # a compile check.
+            #
+            rm -f conftest.h
+            test_headers
+
+            echo "$CONFTEST_PREAMBLE
+            #ifdef CONFIG_FB_NVIDIA
+            #error CONFIG_FB_NVIDIA defined!
+            #endif
+            " > conftest$$.c
+
+            $CC $CFLAGS -c conftest$$.c > /dev/null 2>&1
+
+            if [ -f conftest$$.o ]; then
+                RET=0
+            fi
+
+            rm -f conftest$$.c conftest$$.o
+            rm -f conftest.h
+        else
+            CONFIG=$HEADERS/../.config
+            if [ -f $CONFIG ]; then
+                if [ -z "$(grep "^CONFIG_FB_NVIDIA=y" $CONFIG)" ]; then
+                    RET=0
+                fi
+            fi
+        fi
+
+        if [ "$RET" != "0" ]; then
+            echo "Your kernel was configured to include nvidiafb support!";
+            echo "";
+            echo "The nvidiafb driver conflicts with the NVIDIA driver, please";
+            echo "reconfigure your kernel and *disable* nvidiafb support, then";
+            echo "try installing the NVIDIA kernel module again.";
+            echo "";
+            if [ "$VERBOSE" = "full_output" ]; then
+                echo "*** Failed nvidiafb sanity check. Bailing out! ***";
+                echo "";
+            fi
+            exit 1
+        else
+            exit 0
+        fi
+    ;;
+
+    xen_sanity_check)
+        #
+        # Check if the target kernel is a Xen kernel. If so, then exit, since
+        # the driver doesn't currently work with Xen.
+        #
+        VERBOSE=$7
+
+        if [ -n "$IGNORE_XEN_PRESENCE" ]; then
+            exit 0
+        fi
+
+        if [ "$XEN_PRESENT" != "0" ]; then
+            echo "The kernel you are installing for is a Xen kernel!";
+            echo "";
+            echo "The NVIDIA driver does not currently work on Xen kernels. If ";
+            echo "you are using a stock distribution kernel, please install ";
+            echo "a variant of this kernel without Xen support; if this is a ";
+            echo "custom kernel, please install a standard Linux kernel.  Then ";
+            echo "try installing the NVIDIA kernel module again.";
+            echo "";
+            if [ "$VERBOSE" = "full_output" ]; then
+                echo "*** Failed Xen sanity check. Bailing out! ***";
+                echo "";
+            fi
+            exit 1
+        else
+            exit 0
+        fi
+    ;;
+
+    patch_check)
+        #
+        # Check for any "official" patches that may have been applied and
+        # construct a description table for reporting purposes.
+        #
+        PATCHES=""
+
+        for PATCH in patch-*.h; do
+            if [ -f $PATCH ]; then
+                echo "#include \"$PATCH\"" >> patches.h
+                PATCHES="$PATCHES "`echo $PATCH | sed -s 's/patch-\(.*\)\.h/\1/'`
+            fi
+        done
+
+        echo "static struct {
+                const char *short_description;
+                const char *description;
+              } __nv_patches[] = {" >> patches.h
+            for i in $PATCHES; do
+                echo "{ \"$i\", NV_PATCH_${i}_DESCRIPTION }," >> patches.h
+            done
+        echo "{ NULL, NULL } };" >> patches.h
+
+        exit 0
+    ;;
+
+    compile_tests)
+        #
+        # Run a series of compile tests to determine the set of interfaces
+        # and features available in the target kernel.
+        #
+        shift 5
+
+        rm -f conftest.h
+        test_headers
+
+        for i in $*; do compile_test $i; done
+
+        if [ -n "$SHOW_COMPILE_TEST_RESULTS" -a -f conftest.h ]; then
+            cat conftest.h
+        fi
+
+        exit 0
+    ;;
+
+esac
diff -uNr nvidia-304.131.org/dkms.conf nvidia-304.131/dkms.conf
--- nvidia-304.131.org/dkms.conf	2015-12-14 17:02:47.000000000 +0800
+++ nvidia-304.131/dkms.conf	2016-08-01 13:52:44.962356000 +0800
@@ -9,5 +9,5 @@
 AUTOINSTALL=yes
 
 MAKE[0]="env CCACHE_DISABLE=1 \
-    make -C . LINUXDIR=${kernel_source_dir} KVERREL=${kernelver}"
+    make module -C . LINUXDIR=${kernel_source_dir} KVERREL=${kernelver}"
 CLEAN="make -C . LINUXDIR=${kernel_source_dir} KVERREL=${kernelver} clean"
diff -uNr nvidia-304.131.org/makefile nvidia-304.131/makefile
--- nvidia-304.131.org/makefile	1970-01-01 08:00:00.000000000 +0800
+++ nvidia-304.131/makefile	2016-02-10 23:28:48.000000000 +0800
@@ -0,0 +1,72 @@
+#
+# This Makefile was automatically generated; do not edit.
+# Generated on 'swio-display-x64-rhel04-16' on Sun Nov 8 21:43:39 PST 2015.
+#
+
+#
+# Top level makefile for the NVIDIA kernel module; this file selects
+# which "real" Makefile should actually be used to build the kernel
+# module (either the "old" nvidia Makefile, or the kbuild makefile),
+# and then passes the target on to that Makefile.
+#
+
+KERNEL_MODLIB := /lib/modules/$(shell uname -r)
+
+ifdef SYSSRC
+ KERNEL_SOURCES := $(SYSSRC)
+ KERNEL_HEADERS := $(KERNEL_SOURCES)/include
+else
+ ifdef SYSINCLUDE
+ KERNEL_HEADERS := $(SYSINCLUDE)
+ KERNEL_SOURCES := $(KERNEL_HEADERS)/..
+ else
+ KERNEL_SOURCES := $(shell test -d $(KERNEL_MODLIB)/source && echo $(KERNEL_MODLIB)/source || echo $(KERNEL_MODLIB)/build)
+ KERNEL_HEADERS := $(KERNEL_SOURCES)/include
+ endif
+endif
+
+ifdef SYSOUT
+ #
+ # Support separate KBUILD output directories; SYSOUT
+ # needs to reflect the correct KBUILD_OUTPUT.
+ #
+ KERNEL_OUTPUT := $(SYSOUT)
+else
+ ifeq ($(KERNEL_SOURCES), $(KERNEL_MODLIB)/source)
+ KERNEL_OUTPUT := $(KERNEL_MODLIB)/build
+ else
+ KERNEL_OUTPUT := $(KERNEL_SOURCES)
+ endif
+endif
+
+CC ?= cc
+HOST_CC ?= $(CC)
+
+ifndef ARCH
+ ARCH := $(shell uname -m | sed -e 's/i.86/i386/' -e 's/armv[0-9]\w\+/arm/')
+endif
+
+CONFTEST := sh ./conftest.sh "$(CC)" "$(HOST_CC)" $(ARCH) $(KERNEL_SOURCES) $(KERNEL_OUTPUT)
+
+.PHONY: select_makefile
+select_makefile:
+	@ $(CONFTEST) cc_sanity_check full_output && \
+	$(CONFTEST) select_makefile full_output
+
+default: module
+
+module nvidia.o nvidia.ko rmlite install nv-linux.o module-install package-install: select_makefile
+	@ $(MAKE) --no-print-directory -f Makefile $@
+
+# Commands associated with this target must not produce any output except
+# for the printed module name -- nvidia-installer depends on this...
+# So make this its own complete target to make it easier to guarantee this.
+print-module-filename: 
+	@ $(CONFTEST) select_makefile full_output && \
+	$(MAKE) --no-print-directory -f Makefile $@
+
+clean:
+	@if [ -f Makefile ]; then \
+	 $(MAKE) --no-print-directory -f Makefile $@; \
+	fi
+	@ rm -f Makefile
diff -uNr nvidia-304.131.org/Makefile nvidia-304.131/Makefile
--- nvidia-304.131.org/Makefile	2015-12-14 17:02:44.000000000 +0800
+++ nvidia-304.131/Makefile	2016-08-01 14:19:54.639695432 +0800
@@ -1,182 +1,312 @@
-# Makefile -- For the nvidia module
-
 #
-# By default, the build is done against the running linux kernel source.
-# To build against a different kernel source tree, set LINUXDIR:
+# This Makefile was automatically generated; do not edit.
+# Generated on 'swio-display-x64-rhel04-16' on Sun Nov 8 21:43:39 PST 2015.
 #
-#    make LINUXDIR=/path/to/kernel/source
-
-SHELL=/bin/sh
 
-# avoid ld.gold, see #626279
-LD=ld.bfd
+#
+# KBUILD Makefile for the NVIDIA Linux kernel module.
+#
+# The motivation for replacing the original Makefile is the hope that this
+# version will simplify the build and installation process. In the past,
+# many architectural and cosmetic changes to the Linux kernel have made it
+# difficult to maintain compatibility or required duplication of logic.
+#
+# Linux 2.6 introduces numerous such changes, many of which impact modules.
+# Relying on KBUILD, some aspects of the build system otherwise difficult
+# to support (for example, module versioning) are abstracted away and dealt
+# with elsewhere, making life significantly easier here.
+#
+# The new approach currently has its own share of problems, some of which
+# are architectural difficulties with KBUILD, others minor annoyances. For
+# this reason, an improved version of the NVIDIA Makefile is available to
+# those experiencing difficulties.
+#
+# kbuild Makefile originally developed by:
+#
+# Alistair J Strachan (alistair@devzero.co.uk) (first pass, enhancements)
+# Christian Zander (zander@mail.minion.de) (enhancements)
+#
 
-.SUFFIXES:
+all: install
+install: package-install
 
-ifndef LINUXDIR
-RUNNING_REL := $(shell uname -r)
+#
+# The NVIDIA kernel module base name and static file names. KBUILD will go
+# ahead and append ".o" or ".ko" to form the final module name.
+#
 
-LINUXDIR := $(shell if [ -e /lib/modules/$(RUNNING_REL)/source ]; then \
-		 echo /lib/modules/$(RUNNING_REL)/source; \
-		 else echo /lib/modules/$(RUNNING_REL)/build; fi)
-endif
+MODULE_NAME := nvidia
+VERSION_HEADER := nv_compiler.h
 
-ifndef O
-O := $(shell if [ -e /lib/modules/$(RUNNING_REL)/build ]; then \
-		 echo /lib/modules/$(RUNNING_REL)/build; \
-		 else echo ""; fi)
-#O := $(LINUXDIR)
-endif
+#
+# List of object files to link into NVIDIA kernel module; make sure KBUILD
+# understands that we want a module.
+#
 
-ifdef ARCH
-MACHINE := $(ARCH)
-else
-MACHINE := $(shell uname -m)
-endif
+CORE_OBJS := nv-kernel.o
+RESMAN_GLUE_OBJS := $(patsubst %.c,%.o,nv.c nv-acpi.c nv-chrdev.c nv-cray.c nv-drm.c nv-gvi.c nv-i2c.c nv-mempool.c nv-mlock.c nv-mmap.c nv-p2p.c nv-pat.c nv-procfs.c nv-usermap.c nv-vm.c nv-vtophys.c os-agp.c os-interface.c os-mtrr.c os-registry.c os-smp.c os-usermap.c)
 
-# Modules for all architectures
-MODULE_LIST := nvidia.o
+$(MODULE_NAME)-objs := $(CORE_OBJS) $(RESMAN_GLUE_OBJS)
 
-CLEANFILES = *.o *.ko .depend .*.flags .*.d .*.cmd *.mod.c .tmp_versions
+#
+# The precompiled kernel module build process requires a separation of the
+# closed source and open source object files.
+#
 
-# VERSION is not defined from the initial invocation.  It is defined when
-# this Makefile is invoked from the kernel's root Makefile.
+KERNEL_GLUE_NAME := nv-linux.o
+KERNEL_GLUE_OBJS := $(RESMAN_GLUE_OBJS) $(MODULE_NAME).mod.o
 
-ifndef VERSION
+obj-m := $(MODULE_NAME).o
 
-ifdef RUNNING_REL
+#
+# Include local source directory in $(CC)'s include path and set disable any
+# warning types that are of little interest to us.
+#
 
-# SuSE has the version.h and autoconf.h headers for the current kernel
-# in /boot as /boot/vmlinuz.version.h and /boot/vmlinuz.autoconf.h.
-# Check these first to see if they match the running kernel.
+EXTRA_CFLAGS += -I$(src)
+EXTRA_CFLAGS += -Wall -MD $(DEFINES) $(INCLUDES) -Wsign-compare -Wno-cast-qual -Wno-error
 
-BOOTVERSION_PREFIX = /boot/vmlinuz.
+#
+# We rely on these two definitions below; if they aren't set, we set them to
+# reasonable defaults (e.g. for top-level passes).
+#
 
-VV := $(shell if [ -f $(BOOTVERSION_PREFIX)version.h ]; then \
-	grep UTS_RELEASE $(BOOTVERSION_PREFIX)version.h | \
-	cut -d' ' -f3; fi)
+src ?= .
+obj ?= .
 
-ifeq ($(VV),"$(RUNNING_REL)")
-HEADERFROMBOOT := 1
-GETCONFIG := MAKEFILES=$(shell /bin/pwd)/.config
-HAVECONFIG := y
-endif
+#
+# Determine location of the Linux kernel source tree. Allow users to override
+# the default (i.e. automatically determined) kernel source location with the
+# SYSSRC directive; this new directive replaces NVIDIA's SYSINCLUDE.
+#
 
-# On Red Hat we need to check if there is a .config file in the kernel
-# source directory.  If there isn't, we need to check if there's a
-# matching file in the configs subdirectory.
+KERNEL_MODLIB := /lib/modules/$(shell uname -r)
 
-ifneq ($(HAVECONFIG),y)
-HAVECONFIG := $(shell if [ -e $(LINUXDIR)/.config ]; then echo y; fi)
+ifdef SYSSRC
+ KERNEL_SOURCES := $(SYSSRC)
+ KERNEL_HEADERS := $(KERNEL_SOURCES)/include
+else
+ KERNEL_UNAME := $(shell uname -r)
+ KERNEL_SOURCES := $(shell test -d $(KERNEL_MODLIB)/source && echo $(KERNEL_MODLIB)/source || echo $(KERNEL_MODLIB)/build)
+ KERNEL_HEADERS := $(KERNEL_SOURCES)/include
 endif
 
-ifneq ($(HAVECONFIG),y)
-REL_BASE := $(shell echo $(RUNNING_REL) | sed 's/-.*//')
-REL_TYPE := $(shell echo $(RUNNING_REL) | sed 's/[0-9.-]//g')
-ifeq ($(REL_TYPE),)
-RHCONFIG := configs/kernel-$(REL_BASE)-$(MACHINE).config
+KERNEL_OUTPUT := $(KERNEL_SOURCES)
+KBUILD_PARAMS :=
+
+ifdef SYSOUT
+ ifneq ($(SYSOUT), $(KERNEL_SOURCES))
+ KERNEL_OUTPUT := $(SYSOUT)
+ KBUILD_PARAMS := KBUILD_OUTPUT=$(KERNEL_OUTPUT)
+ endif
 else
-RHCONFIG := configs/kernel-$(REL_BASE)-$(MACHINE)-$(REL_TYPE).config
-endif
-HAVECONFIG := $(shell if [ -e $(LINUXDIR)/$(RHCONFIG) ]; then echo y; fi)
-ifneq ($(HAVECONFIG),y)
-RHCONFIG :=
-endif
+ ifeq ($(KERNEL_SOURCES), $(KERNEL_MODLIB)/source)
+ KERNEL_OUTPUT := $(KERNEL_MODLIB)/build
+ KBUILD_PARAMS := KBUILD_OUTPUT=$(KERNEL_OUTPUT)
+ endif
 endif
 
-ifneq ($(HAVECONFIG),y)
-ifneq ($(0),$(LINUXDIR))
-GETCONFIG += O=$(O)
-endif
-HAVECONFIG := $(shell if [ -e $(O)/.config ]; then echo y; fi)
-endif
+CC ?= cc
+HOST_CC ?= $(CC)
+LD ?= ld
 
-ifneq ($(HAVECONFIG),y)
-$(error Cannot find a kernel config file)
+ifndef ARCH
+ ARCH := $(shell uname -m | sed -e 's/i.86/i386/' -e 's/armv[0-9]\w\+/arm/')
 endif
 
-endif
+CONFTEST := /bin/sh $(src)/conftest.sh "$(CC)" "$(HOST_CC)" $(ARCH) $(KERNEL_SOURCES) $(KERNEL_OUTPUT)
 
-CLEANCONFIG := $(shell if cmp -s $(LINUXDIR)/.config .config; then echo y; fi)
-ifeq ($(CLEANCONFIG),y)
-CLEANFILES += $(LINUXDIR)/.config .config $(LINUXDIR)/tmp_include_depends
-endif
+KERNEL_UNAME ?= $(shell $(CONFTEST) get_uname)
+MODULE_ROOT := /lib/modules/$(KERNEL_UNAME)/kernel/drivers
+
+#
+# Sets any internal variables left unset by KBUILD (e.g. this happens during
+# a top-level run).
+#
+
+TOPDIR ?= $(KERNEL_SOURCES)
+
+#
+# Linux 2.6 uses the .ko module extension.
+#
+
+MODULE_OBJECT := $(MODULE_NAME).ko
+
+#
+# NVIDIA specific CFLAGS and #define's.
+#
 
-all: modules
+EXTRA_CFLAGS += -D__KERNEL__ -DMODULE -DNVRM -DNV_VERSION_STRING=\"304.131\" -Wno-unused-function -Wuninitialized -mno-red-zone -mcmodel=kernel -UDEBUG -U_DEBUG -DNDEBUG
 
-modules: includes
-	+make -C $(LINUXDIR) $(GETCONFIG) M=`/bin/pwd` modules
 
-ifeq ($(HEADERFROMBOOT),1)
+COMPILE_TESTS = \
+	remap_page_range \
+	remap_pfn_range \
+	vmap \
+	agp_backend_acquire \
+	set_pages_uc \
+	set_memory_uc \
+	set_memory_array_uc \
+	change_page_attr \
+	i2c_adapter \
+	pci_get_class \
+	pm_message_t \
+	irq_handler_t \
+	pci_choose_state \
+	vm_insert_page \
+	acpi_device_ops \
+	acpi_op_remove \
+	acpi_device_id \
+	acquire_console_sem \
+	console_lock \
+	kmem_cache_create \
+	on_each_cpu \
+	smp_call_function \
+	vmm_support \
+	acpi_evaluate_integer \
+	ioremap_cache \
+	ioremap_wc \
+	proc_dir_entry \
+	INIT_WORK \
+	acpi_walk_namespace \
+	agp_memory \
+	scatterlist \
+	pci_domain_nr \
+	pci_dma_mapping_error \
+	file_operations \
+	sg_init_table \
+	pci_get_domain_bus_and_slot \
+	get_num_physpages \
+	efi_enabled \
+	drm_available \
+	proc_create_data \
+	pde_data \
+	proc_remove \
+	pm_vt_switch_required \
+	file_inode \
+	drm_pci_set_busid \
+	write_cr4 \
+	for_each_online_node \
+	node_end_pfn \
+	get_user_pages_remote
 
-BOOTHEADERS = version.h autoconf.h
-BOOTCONFIG = .config
+#
+# Miscellaneous NVIDIA kernel module build support targets. They are needed
+# to satisfy KBUILD requirements and to support NVIDIA specifics.
+#
 
-CLEANFILES += $(BOOTHEADERS) $(BOOTCONFIG)
+$(obj)/$(CORE_OBJS):
+	@cp $(src)/$(CORE_OBJS) $(obj)/$(CORE_OBJS)
 
-includes:: $(BOOTHEADERS) $(BOOTCONFIG)
+$(obj)/$(VERSION_HEADER):
+	@echo \#define NV_COMPILER \"`$(CC) -v 2>&1 | tail -n 1`\" > $@
 
-version.h: $(BOOTVERSION_PREFIX)version.h
-	rm -f $@
-	ln -s $< $@
+$(obj)/conftest.h: $(src)/conftest.sh
+	@if ! $(CONFTEST) compile_tests $(COMPILE_TESTS); then exit 1; fi
 
-autoconf.h: $(BOOTVERSION_PREFIX)autoconf.h
-	rm -f $@
-	ln -s $< $@
+$(obj)/patches.h:
+	@if ! $(CONFTEST) patch_check; then exit 1; fi
 
-.config: $(BOOTVERSION_PREFIX)config
-	rm -f $@
-	ln -s $< $@
-endif
+RESMAN_GLUE_TARGETS = $(addprefix $(obj)/,$(RESMAN_GLUE_OBJS))
+
+$(RESMAN_GLUE_TARGETS): $(obj)/conftest.h $(obj)/patches.h
 
-# This prepares an unused Red Hat kernel tree for the build.
-ifneq ($(RHCONFIG),)
-includes:: $(LINUXDIR)/.config $(LINUXDIR)/tmp_include_depends .config
-
-$(LINUXDIR)/.config: $(LINUXDIR)/$(RHCONFIG)
-	rm -f $@
-	ln -s $< $@
-
-.config: $(LINUXDIR)/$(RHCONFIG)
-	rm -f $@
-	ln -s $< $@
+$(obj)/nv.o: $(obj)/$(VERSION_HEADER)
 
-$(LINUXDIR)/tmp_include_depends:
-	echo all: > $@
+#
+# KBUILD build parameters.
+#
+
+ifndef NV_VERBOSE
+ ifneq ($(strip $(QUIET)),1)
+ NV_VERBOSE=1
+ else
+ NV_VERBOSE=0
+ endif
 endif
 
-clean cleandir:
-	rm -rf $(CLEANFILES)
+KBUILD_PARAMS += KBUILD_VERBOSE=$(NV_VERBOSE)
+KBUILD_PARAMS += -C $(KERNEL_SOURCES) SUBDIRS=$(PWD)
+KBUILD_PARAMS += ARCH=$(ARCH)
 
-$(MODULE_LIST)::
-	make modules
+#
+# NVIDIA sanity checks.
+#
 
-install:
-	make -C $(LINUXDIR) $(GETCONFIG) M=`/bin/pwd` modules_install
+.PHONY: suser-sanity-check rmmod-sanity-check build-sanity-checks
 
-else
+suser-sanity-check:
+	@if ! $(CONFTEST) suser_sanity_check; then exit 1; fi
 
-# Check for kernel versions that we don't support.
+rmmod-sanity-check:
+	@if ! $(CONFTEST) rmmod_sanity_check; then exit 1; fi
 
-BELOW26 := $(shell if [ $(VERSION) -lt 2 -o \( $(VERSION) = 2 -a $(PATCHLEVEL) -lt 6 \) ]; then \
-		echo y; fi)
+build-sanity-checks:
+	@if ! $(CONFTEST) cc_version_check 		full_output; then exit 1; fi
+	@if ! $(CONFTEST) rivafb_sanity_check 	full_output; then exit 1; fi
+	@if ! $(CONFTEST) nvidiafb_sanity_check full_output; then exit 1; fi
+	@if ! $(CONFTEST) xen_sanity_check 		full_output; then exit 1; fi
 
-ifeq ($(BELOW26),y)
-$(error Only 2.6.x and later kernels are supported \
-	($(VERSION).$(PATCHLEVEL).$(SUBLEVEL)))
-endif
+#
+# Build the NVIDIA kernel module using Linux KBUILD. This target is used by
+# the "package-install" target below.
+#
 
-# This needs to go before all other include paths.
-CC += -I$(M)
+module: build-sanity-checks
+	@echo "NVIDIA: calling KBUILD..."; \
+	 $(MAKE) "CC=$(CC)" $(KBUILD_PARAMS) modules; \
+	echo "NVIDIA: left KBUILD."; \
+	if ! [ -f $(MODULE_OBJECT) ]; then \
+	 echo "$(MODULE_OBJECT) failed to build!"; \
+	 exit 1; \
+	fi
 
-ifeq ($(CONFIG_X86_64),y)
-NVARCH = .x86_64
-else
-NVARCH = .i386
-endif
+#
+# Build the NVIDIA kernel module with KBUILD. Verify that the user posesses
+# sufficient privileges. Rebuild the module dependency file.
+#
 
-include $(M)/Makefile.kbuild
+module-install: suser-sanity-check module
+	@mkdir -p $(MODULE_ROOT)/video; \
+	install -m 0664 -o root -g root $(MODULE_OBJECT) $(MODULE_ROOT)/video; \
+	PATH="$(PATH):/bin:/sbin" depmod -ae;
 
-endif
+#
+# This target builds, then installs, then creates device nodes and inserts
+# the module, if successful.
+#
+
+package-install: module-install rmmod-sanity-check
+	@PATH="$(PATH):/bin:/sbin" modprobe $(MODULE_NAME) && \
+	echo "$(MODULE_OBJECT) installed successfully.";
+
+#
+# Build an object file suitable for further processing by the installer
+# and inclusion as a precompiled kernel interface file. Note the
+# dependency on 'module', and not just the input object files. This is
+# because we rely on KBUILD to produce the latter as part of the
+# full kernel module build.
+#
+
+$(KERNEL_GLUE_NAME): module
+	@$(LD) $(EXTRA_LDFLAGS) -r -o $(KERNEL_GLUE_NAME) $(KERNEL_GLUE_OBJS)
+
+#
+# Support hack, KBUILD isn't prepared to clean up after external modules.
+#
+
+clean:
+	@$(RM) -f $(RESMAN_GLUE_OBJS) $(KERNEL_GLUE_OBJS)
+	@$(RM) -f build-in.o nv-linux.o *.d .*.{cmd,flags}
+	@$(RM) -f $(MODULE_NAME).{o,ko,mod.{o,c}} $(VERSION_HEADER) *~
+	@$(RM) -f patches.h
+	@$(RM) -f conftest*.c conftest.h
+	@$(RM) -rf Modules.symvers .tmp_versions
+
+#
+# This target just prints the kernel module filename (for use by the
+# installer)
+#
 
-.PHONY: includes
+print-module-filename:
+	@echo $(MODULE_OBJECT)
diff -uNr nvidia-304.131.org/Makefile.kbuild nvidia-304.131/Makefile.kbuild
--- nvidia-304.131.org/Makefile.kbuild	2015-12-14 17:02:43.000000000 +0800
+++ nvidia-304.131/Makefile.kbuild	2016-08-01 14:22:25.309789939 +0800
@@ -42,6 +42,11 @@
 # List of object files to link into NVIDIA kernel module; make sure KBUILD
 # understands that we want a module.
 #
+ifeq ($(CONFIG_X86_64),y)
+NVARCH = .x86_64
+else
+NVARCH = .i386
+endif
 
 CORE_OBJS := nv-kernel.o$(NVARCH)
 RESMAN_GLUE_OBJS := $(patsubst %.c,%.o,nv.c nv-acpi.c nv-chrdev.c nv-cray.c nv-drm.c nv-gvi.c nv-i2c.c nv-mempool.c nv-mlock.c nv-mmap.c nv-p2p.c nv-pat.c nv-procfs.c nv-usermap.c nv-vm.c nv-vtophys.c os-agp.c os-interface.c os-mtrr.c os-registry.c os-smp.c os-usermap.c)
@@ -187,7 +192,8 @@
 	drm_pci_set_busid \
 	write_cr4 \
 	for_each_online_node \
-	node_end_pfn
+	node_end_pfn \
+	get_user_pages_remote
 
 #
 # Miscellaneous NVIDIA kernel module build support targets. They are needed
diff -uNr nvidia-304.131.org/Makefile.nvidia nvidia-304.131/Makefile.nvidia
--- nvidia-304.131.org/Makefile.nvidia	1970-01-01 08:00:00.000000000 +0800
+++ nvidia-304.131/Makefile.nvidia	2016-08-01 14:23:39.233099498 +0800
@@ -0,0 +1,139 @@
+#
+# This Makefile was automatically generated; do not edit.
+# Generated on 'swio-display-x64-rhel04-16' on Sun Nov 8 21:43:39 PST 2015.
+#
+
+MODULE_NAME := nvidia
+
+LINUX_MODULE=nv-linux.o
+DEFINES=-D__KERNEL__ -DMODULE -D_LOOSE_KERNEL_NAMES -DNVRM -DNV_VERSION_STRING=\"304.131\"
+INCLUDES=-I.
+
+OBJECTS=$(patsubst %.c,%.o,nv.c nv-acpi.c nv-chrdev.c nv-cray.c nv-drm.c nv-gvi.c nv-i2c.c nv-mempool.c nv-mlock.c nv-mmap.c nv-p2p.c nv-pat.c nv-procfs.c nv-usermap.c nv-vm.c nv-vtophys.c os-agp.c os-interface.c os-mtrr.c os-registry.c os-smp.c os-usermap.c)
+HEADERS=nv.h nv-linux.h nv-memdbg.h nv-misc.h nv-p2p.h nv-proto.h nv-reg.h os-agp.h os-interface.h cpuopsys.h g_nvreadme.h nvtypes.h rmil.h rmretval.h xapi-sdk.h $(VERSION_HDR) conftest.h patches.h
+
+CFLAGS=-Wall  -Wno-unused-function -Wuninitialized -O   -mno-red-zone -mcmodel=kernel -UDEBUG -U_DEBUG -DNDEBUG -MD $(DEFINES) $(INCLUDES) -Wsign-compare -Wno-cast-qual -Wno-error
+
+ifeq ($(CONFIG_X86_64),y)
+NVARCH = .x86_64
+else
+NVARCH = .i386
+endif
+
+CORE_OBJECTS=nv-kernel.o$(NVARCH)
+
+#
+# Determine location of the Linux kernel source tree. Allow users to override
+# the default (i.e. automatically determined) kernel source location with the
+# SYSSRC directive; this new directive replaces NVIDIA's SYSINCLUDE.
+#
+
+ifdef SYSSRC
+ KERNEL_SOURCES := $(SYSSRC)
+ KERNEL_HEADERS := $(KERNEL_SOURCES)/include
+else
+ ifdef SYSINCLUDE
+ KERNEL_HEADERS := $(SYSINCLUDE)
+ KERNEL_SOURCES := $(KERNEL_HEADERS)/..
+ else
+ KERNEL_UNAME := $(shell uname -r)
+ KERNEL_SOURCES := /lib/modules/$(KERNEL_UNAME)/build
+ KERNEL_HEADERS := $(KERNEL_SOURCES)/include
+ endif
+endif
+
+CC ?= cc
+HOST_CC ?= $(CC)
+LD ?= ld
+
+ifndef ARCH
+ ARCH := $(shell uname -m | sed -e 's/i.86/i386/' -e 's/armv[0-9]\w\+/arm/')
+endif
+
+CONFTEST := /bin/sh ./conftest.sh "$(CC)" "$(HOST_CC)" $(ARCH) $(KERNEL_SOURCES) $(KERNEL_SOURCES)
+
+KERNEL_UNAME ?= $(shell $(CONFTEST) get_uname)
+MODULE_ROOT := /lib/modules/$(KERNEL_UNAME)/kernel/drivers
+
+INCLUDES += -I$(KERNEL_HEADERS)
+
+COMPILE_TESTS = \
+	remap_page_range \
+	vmap \
+	change_page_attr \
+	i2c_adapter \
+	smp_call_function \
+	acpi_evaluate_integer \
+	proc_dir_entry \
+	scatterlist \
+	file_operations \
+	pci_get_domain_bus_and_slot \
+	write_cr4
+
+DEFINES+=$(EXTRA_DEFINES)
+
+# allow build parameters to be passed in through the environment
+ifdef BUILD_PARAMS
+ DEFINES+=-D$(BUILD_PARAMS)
+endif
+
+VERSION_HDR=nv_compiler.h
+
+all: install
+
+install: package-install
+
+.PHONY: suser-sanity-check rmmod-sanity-check build-sanity-checks
+
+suser-sanity-check:
+	@if ! $(CONFTEST) suser_sanity_check; then exit; fi
+
+rmmod-sanity-check:
+	@if ! $(CONFTEST) rmmod_sanity_check; then exit; fi
+
+build-sanity-checks:
+	@if ! $(CONFTEST) cc_version_check 	 full_output; then exit; fi
+	@if ! $(CONFTEST) rivafb_sanity_check full_output; then exit; fi
+
+module: build-sanity-checks $(LINUX_MODULE) $(CORE_OBJECTS)
+	@$(LD) -r -o $(MODULE_NAME).o $(LINUX_MODULE) $(CORE_OBJECTS)
+
+package-install: module suser-sanity-check rmmod-sanity-check
+	mkdir -p $(MODULE_ROOT)/video && \
+	install -m 0664 -o root -g root $(MODULE_NAME).o \
+	 $(MODULE_ROOT)/video/$(MODULE_NAME).o && \
+	PATH="$(PATH):/bin:/sbin" depmod -a && \
+		PATH="$(PATH):/bin:/sbin" modprobe $(MODULE_NAME) && \
+	echo "$(MODULE_NAME).o installed successfully."; \
+
+$(VERSION_HDR): 
+	@echo \#define NV_COMPILER \"`$(CC) -v 2>&1 | tail -n 1`\" > $@
+
+$(LINUX_MODULE): $(OBJECTS)
+	@$(LD) -r -o $@ $(OBJECTS)
+
+conftest.h: conftest.sh
+	@if ! $(CONFTEST) compile_tests $(COMPILE_TESTS); then exit; fi
+
+patches.h:
+	@if ! $(CONFTEST) patch_check; then exit; fi
+
+%.o: %.c $(HEADERS)
+	@$(CC) -c $(CFLAGS) $<
+
+# debug tool to preprocess the file and leave .i to make it easier to untangle #defines
+%.i: %.c
+	@$(CC) $(CFLAGS) -E $< > $@
+
+%.s: %.c
+	@$(CC) $(CFLAGS) -S $< > $@
+
+clean:
+	@$(RM) $(OBJECTS) $(LINUX_MODULE) $(VERSION_HDR) *.d $(MODULE_NAME).o
+	@$(RM) patches.h
+	@$(RM) conftest*.c conftest.h
+
+print-module-filename:
+	@echo "$(MODULE_NAME).o"
+
+-include $(OBJECTS:%.o=%.d)
diff -uNr nvidia-304.131.org/nv.c nvidia-304.131/nv.c
--- nvidia-304.131.org/nv.c	2015-11-09 13:43:39.000000000 +0800
+++ nvidia-304.131/nv.c	2016-02-10 23:28:48.000000000 +0800
@@ -2272,7 +2272,7 @@
     nvl->dev->dma_mask = (((u64)1) << phys_addr_bits) - 1;
 }
 
-#if defined(HAVE_NV_XEN) && defined(CONFIG_XEN) && !defined(CONFIG_PARAVIRT)
+#if defined(HAVE_NV_XEN) && defined(CONFIG_ALB) && !defined(CONFIG_PARAVIRT)
 #include "nv-xen.h"
 #else
 #if defined(NV_VMAP_PRESENT)
diff -uNr nvidia-304.131.org/NVIDIA_Changelog nvidia-304.131/NVIDIA_Changelog
--- nvidia-304.131.org/NVIDIA_Changelog	2015-11-09 14:06:36.000000000 +0800
+++ nvidia-304.131/NVIDIA_Changelog	1970-01-01 08:00:00.000000000 +0800
@@ -1,3995 +0,0 @@
-
-======== Release 304 Entries ========
-
-    * Fixed a bug that could cause texture corruption in some OpenGL
-      applications when video memory is exhausted by a combination of
-      simultaneously running graphical and compute workloads.
-
-    * Added support for X.Org xserver ABI 20 (xorg-server 1.18).
-
-2015-08-31 version 304.128
-
-    * Removed libvdpau and libvdpau_trace from the NVIDIA driver package.
-      VDPAU is not supported on the legacy hardware supported on the
-      release 304 legacy driver branch. The libvdpau_nvidia vendor library
-      is still included, so users who wish to use VDPAU with newer hardware
-      that still works with release 304 drivers may install libvdpau from
-      packages provided by the OS vendor where available, or from the source
-      code available at:
-
-      http://people.freedesktop.org/~aplattner/vdpau/
-
-    * Updated nvidia-installer to use modprobe(8) when leaving the NVIDIA
-      kernel module loaded after installation, instead of insmod(8) or
-      libkmod. This allows the kernel module to honor any configuration
-      directives that apply to it in /etc/modprobe.d when it is loaded.
-
-    * Fixed a bug that allowed console messages from the Linux kernel to be
-      drawn over the user interface of nvidia-installer.
-
-2014-12-05 version 304.125
-
-    * Added support for X.Org xserver ABI 19 (xorg-server 1.17).
-
-    * Improved compatibility with recent Linux kernels.
-
-    * Implemented support for disabling indirect GLX context creation using
-      the -iglx option available on X.Org server release 1.16 and newer.  Note
-      that future X.Org server releases may make the -iglx option the default.
-      To re-enable support for indirect GLX on such servers, use the +iglx
-      option.
-
-    * Added the "AllowIndirectGLXProtocol" X config option.  This option can
-      be used to disallow use of GLX protocol.  See "Appendix B. X Config
-      Options" in the README for more details.
-
-    * Updated nvidia-installer to install a file in the system's xorg.conf.d
-      directory, when a sufficiently new X server is detected, to cause the X
-      server to load the "nvidia" X driver automatically if it is started after
-      the NVIDIA kernel module is loaded.
-
-      This feature is supported in X.Org xserver 1.16 and higher when running on
-      Linux 3.9 or higher with CONFIG_DRM enabled.
-
-    * Updated nvidia-installer to log uninstallation to a separate file
-      from the installation log, and to attempt uninstalling previous
-      driver installations using the installer program from the previous
-      installation, when available.
-
-    * Updated nvidia-installer to avoid writing to non-zero offsets of
-      sysctl files in /proc/sys/kernel.
-
-2014-07-10 version 304.123
-
-    * Improved compatibility with recent Linux kernels.
-
-    * Fixed a bug that could result in system instability while restoring
-      the VGA console.
-
-    * Fixed an interaction problem with xserver 1.15 that occasionally caused
-      OpenGL applications to continue rendering when they are minimized or
-      unmapped.
-
-    * Updated nvidia-bug-report.sh to search the systemd journal for X
-      server logs and messages from the NVIDIA kernel module.
-
-    * Added support for X.org xserver ABI 18 (xorg-server 1.16).
-
-    * Fixed a bug that caused corruption or blank screens on monitors that use
-      EDID version 1.3 or older when they are connected via DisplayPort on
-      graphics boards that use external DisplayPort encoders, such as the Quadro
-      FX 4800.
-
-2014-03-11 version 304.121
-
-    * Improved compatibility with recent Linux kernels.
-
-    * Fixed a bug that prevented the NVIDIA implementation of the Xinerama
-      extension protocol requests from being used when RandR was enabled.
-
-    * Updated nvidia-installer to add '/usr/lib/i386-linux/gnu' to the
-      search path for installing 32-bit compatibility libraries on
-      Debian GNU/Linux systems.
-
-2014-01-23 version 304.119
-
-    * Fixed a crash when using WebGL in Firefox with a Geforce 6 GPU.
-
-2013-12-11 version 304.117
-
-    * Added support for X.org xserver ABI 15 (xorg-server 1.15).
-
-2013-11-06 version 304.116
-
-   * Fixed a security vulnerability in the microcode for microcontrollers
-     that are part of NVIDIA GPUs.  This vulnerability could be exploited
-     to take control of a system, and it is described in greater detail at:
-
-     http://cve.mitre.org/cgi-bin/cvename.cgi?name=2013-5987
-
-    * Updated nvidia-installer to consider the "libglamoregl.so" X loadable
-      extension module to be in conflict with the NVIDIA OpenGL driver. This
-      module can cause the NVIDIA libGL to be loaded into the same process
-      (the X server) as the NVIDIA libglx.so extension module, which is not
-      a supported use case.
-
-    * Improved compatibility with recent Linux kernels.
-
-    * Updated the NVIDIA OpenGL driver to write temporary files to $TMPDIR
-      if it is set, instead of unconditionally writing to /tmp.
-
-    * Updated a fallback of writing temporary files to $HOME/.nvidia to
-      use $HOME/.nv instead, as the latter path is already used for other
-      NVIDIA driver related files.
-
-2013-08-08 version 304.108
-
-    * Implemented workarounds for two Adobe Flash bugs by applying libvdpau
-      commit ca9e637c61e80145f0625a590c91429db67d0a40 to the version of libvdpau
-      shipped with the NVIDIA driver.
-
-    * Fixed a bug in nvidia-settings that could cause the wrong
-      resolution to be set in basic mode for setups based on one
-      display per X screen.
-
-    * Added /usr/lib/modprobe.d to the list of directories where
-      nvidia-installer may optionally install a generated modprobe
-      configuration file to attempt to disable Nouveau.
-
-2013-04-02 version 304.88
-
-    * Fixed CVE-2013-0131: NVIDIA UNIX GPU Driver ARGB Cursor Buffer
-      Overflow in "NoScanout" Mode.  This buffer overflow, which occurred
-      when an X client installed a large ARGB cursor on an X server
-      running in NoScanout mode, could cause a denial of service (e.g.,
-      an X server segmentation fault), or could be exploited to achieve
-      arbitrary code execution.
-
-      For more details, see:
-      http://nvidia.custhelp.com/app/answers/detail/a_id/3290
-
-2013-03-04 version 304.84
-
-    * Improved compatibility with recent Linux kernels.
-
-    * Fixed a bug that could lead to rendering corruption after an X
-      server generation (i.e., leaving an X server running after all
-      of its clients have exited).
-
-    * Removed a spurious dependency on libpangox from the nvidia-settings
-      binary shipped as part of the driver package.
-
-    * Fixed a bug that could cause the X server to crash when performing
-      an RandR 1.0 rotation (e.g., `xrandr --orientation left`) after
-      unplugging the last connected monitor.
-
-    * Added support for X.org xserver ABI 14 (xorg-server 1.14).
-
-    * Fixed font rendering performance and corruption problems on X servers with
-      backported support for the new glyph cache functionality added to Pixman
-      0.27.
-
-    * Fixed a potential X server crash during initialization, when a 
-      graphics card with a TV connector has no TV connected.
-
-    * Added a new X configuration option, "UseHotplugEvents", to allow the
-      suppression of RandR events when adding or removing non-DisplayPort
-      displays. See the "X Config Options" appendix of the README for details.
-
-2012-11-06 version 304.64
-
-    * Added a missing 32-bit compatibility library for libnvidia-opencl.so to
-      the 64-bit Linux installer package.
-
-    * Fixed a regression in backlight control functionality on some
-      notebook configurations.
-
-    * Fixed a performance issue with recent Linux kernels when allocating
-      and freeing system memory.
-
-    * Fixed a bug that sometimes prevented the display device / X screen
-      selection menu from being displayed in nvidia-settings.
-
-    * Fixed a bug that prevented X driver gamma manipulation from working
-      after a VT-switch on some configurations.
-
-    * Added the option "--output-file" to nvidia-bug-report.sh to allow
-      specifying a custom filename for the log file.
-
-    * Fixed a hang when using OpenGL programs with some SLI Mosaic
-      configurations on pre-Fermi GPUs.
-
-    * Added sections to the "Supported NVIDIA GPU Products" list for NVS,
-      Tesla, and VGX products.
-
-    * Added support for the following GPUs:
-        * VGX K1
-        * VGX K2
-        * Tesla K20c
-        * Tesla K20m
-
-2012-10-18 version 304.60
-
-    * Fixed a bug that caused the EIZO FlexScan SX2762W monitor to remain blank
-      when connected via DisplayPort.
-
-    * Updated nvidia-settings to save and restore per-monitor color correction
-      settings when RandR 1.2 or later is available.
-
-    * Fixed a bug that caused too many display devices to appear in the X Screen
-      page of nvidia-settings when SLI is enabled.
-
-    * Fixed a bug that caused applications to stop rendering or the X server to
-      hang in Xinerama configurations when windows were moved, resized, mapped,
-      or unmapped.
-
-    * Fixed a bug that caused poor OpenGL performance on GeForce 6 and 7 PCI
-      cards.
-
-    * Fixed a bug in nvidia-settings that made it report the status of ECC
-      configuration incorrectly.
-
-    * Fixed a bug that caused the X server to crash if a display was put into
-      DPMS off mode and subsequently reenabled while screen transformations are
-      in use.
-
-    * Fixed a bug that caused the X Resize and Rotate extension to be enabled
-      when Xinerama is enabled.  These two X extensions are incompatible and
-      having them both enabled can confuse window managers such as KDE's kwin.
-      RandR is now correctly disabled when Xinerama is enabled.
-
-    * Fixed a bug causing OpenGL stereo applications to not work properly
-      when using passive stereo modes 5 through 9 on Quadro Fermi and newer
-      GPUs.
-
-    * Updated nvidia-settings to report Dedicated GPU Memory (i.e., the
-      memory dedicated exclusively to the GPU) and Total GPU Memory (i.e.,
-      Dedicated GPU Memory plus any TurboCache(TM)-accessible system memory)
-      separately on the GPU information page.
-
-    * Added reporting of the current utilization of Dedicated GPU Memory to
-      the GPU information page of nvidia-settings.
-
-    * Added support for the "Backlight" RandR output property for
-      configuring the brightness of some notebook internal panels.
-
-    * Fixed a bug that prevented the Ubuntu Unity launcher panel from
-      unhiding: https://bugs.launchpad.net/unity/+bug/1057000
-
-    * Fixed a bug that caused nvidia-installer to sometimes attempt
-      to write a log file in a nonexistent directory.
-
-    * Fixed a bug that caused incorrect input transformation after resizing
-      an NVIDIA X screen with xserver ABI 12 (xorg-server 1.12) or newer.
-
-    * Fixed a bug that caused GLX to leak memory when Xinerama is
-      enabled.
-
-2012-09-24 version 304.51
-
-    * Added support for the following GPUs:
-        * GeForce GT 645M
-        * GeForce GTX 670MX
-        * GeForce GTX 675MX
-        * GeForce GTX 650 Ti
-
-    * Added support for the new Quadro Sync board for Quadro Kepler GPUs.
-      See the "Configuring Frame Lock and Genlock" chapter in the README
-      for details.
-
-    * Fixed an X server crash on X.Org xserver 1.13 when it is compiled
-      without support for DRI2.
-
-    * Fixed a regression that broke color controls on older X servers.
-
-    * Fixed a bug that sometimes caused the display layout area of the
-      nvidia-settings control panel to be laid out incorrectly.
-
-    * Fixed a bug that prevented panning from working correctly after a
-      modeswitch on some X servers with support for cursor constraining.
-
-    * Gamma ramp and colormap adjustments now apply correctly when screen
-      transformations such as rotation and keystone correction are in use.
-
-2012-09-11 version 304.48
-
-    * Fixed RandR per-CRTC gamma persistence across modeswitches and
-      VT-switches.
-
-    * Fixed a bug that caused the X server to sometimes hang in response to
-      input events.
-
-    * Fixed a reduction in rendering performance for core X11 rendering on
-      certain GPUs that occurred in the 290.* series of releases.
-
-    * Fixed a bug that prevented PowerMizer from working correctly on
-      some boards with GDDR5 memory, such as some GeForce GT 240 SKUs.
-
-    * Added support for the following GPUs:
-        * GeForce GTX 660
-        * GeForce GTX 650
-
-    * Fixed a bug that caused OpenGL applications to not animate properly
-      when a rotation or a transformation was applied on some older X
-      server versions.
-
-    * Enabled FXAA with Unified Back Buffers.
-
-    * Fixed a bug that prevented the "Reset Hardware Defaults" button in
-      the Display Settings page of nvidia-settings from being activated.
-
-2012-08-27 version 304.43
-
-    * Fixed a bug that caused pre-release versions of X.Org xserver 1.13 to
-      crash when certain GLX operations were performed, such as when starting
-      Firefox.
-
-    * Fixed a bug that caused VDPAU to hang when expanding the YouTube
-      Flash Player.
-
-    * Fixed a bug that caused gnome-settings-daemon to revert display
-      configuration changes made by nvidia-settings.
-
-    * Updated nvidia-settings to use RandR per-CRTC gamma control, when
-      available.  When controlling an X server with support for RandR 1.2,
-      nvidia-settings will display the color correction widget as a tab
-      within each display device page, instead of a per-X screen color
-      correction page.
-
-    * Fixed a bug that prevented the display palette from being updated
-      immediately after an application called XStoreColors.
-
-    * Added support for the following GPUs:
-        * GeForce GTX 660 Ti
-        * Quadro K5000
-        * Quadro K5000M
-        * Quadro K4000M
-        * Quadro K3000M
-        * NVS 510
-
-    * Added the ability to select and move X screens in the "X Server Display
-      Configuration" page of nvidia-settings via Ctrl-(Left)Click + Drag
-
-2012-08-13 version 304.37
-
-    * Removed the ability to enable SLI on GPUs with ECC enabled.
-
-    * Fixed several bugs that prevented some RandR transform geometries from
-      being applied.
-
-    * Fixed a bug that caused frequent hangs or crashes on some systems.
-
-    * Fixed a bug that would cause corruption and performance issues in certain
-      OpenGL applications such as Amnesia: The Dark Descent on GeForce 6 and 7
-      GPUs.
-
-2012-08-03 version 304.32
-
-    * Fixed a bug that caused applications that use DirectColor visuals, such as
-      Enemy Territory: Quake Wars and Braid, to appear in shades of blue instead
-      of the correct colors.
-
-    * Modified handling of RRSetScreenSize requests to ignore requests that
-      do not actually resize the screen.  This reduces screen flicker in certain
-      cases when using GNOME.
-
-    * Added a new option, "--disable-nouveau" to nvidia-installer. This
-      option changes the action that is chosen by default when Nouveau
-      is detected by nvidia-installer. If the "--disable-nouveau" option
-      is set, then the default will be to attempt to disable Nouveau when
-      it is detected; otherwise, no attempt will be made unless requested.
-
-2012-07-30 version 304.30
-
-    * Added support for xserver ABI 13 (xorg-server 1.13).
-
-    * Added support for RandR per-CRTC gamma manipulation through the
-      RandR 1.2 RRGetCrtcGammaSize, RRGetCrtcGamma, and RRSetCrtcGamma
-      requests.
-
-    * Fixed a bug that caused RRSetOutputPrimary requests to incorrectly
-      generate BadValue errors when setting the primary output to None.  This
-      caused gnome-settings-daemon to crash after changing the screen
-      configuration in response to a display hotplug or the display change
-      hot-key being pressed.
-
-    * Fixed a problem where RENDER Glyphs operations would exhibit severe
-      performance issues in certain cases, such as when used with gradients
-      by Cairo and Chromium.
-
-    * Fixed a bug that caused X to hang when resuming certain DisplayPort
-      display devices (such as Apple brand mini-DisplayPort to dual-link DVI
-      adapters) from power-saving mode.
-
-    * Added support for the following GPU:
-        * Tesla K10
-
-    * Fixed a bug that caused an X screen to be extended to Quadro SDI Output
-      devices by default.  An X screen will still use an SDI Output device if
-      it is the only display device available.  To use a SDI Output device on
-      an X screen with other display devices available, include the SDI Output
-      device with either the "UseDisplayDevice" or "MetaMode" X configuration
-      options.
-
-    * Updated X11 modeline validation such that modes not defined in a
-      display device's EDID are discarded if the EDID 1.3 "GTF Supported"
-      flag is unset or if the EDID 1.4 "Continuous Frequency" flag is
-      unset.  The new "AllowNonEdidModes" token for the ModeValidation
-      X configuration option can be used to disable this new check.
-
-    * Fixed a bug, introduced in the 295.xx release series, with EDID
-      detection on some laptop internal panels.  This bug caused the
-      laptop internal panel to show six small copies of the desktop.
-
-    * Added support for FXAA, Fast Approximate Anti-Aliasing. Using regular
-      anti-aliasing modes or Unified Back Buffers with FXAA is not currently
-      supported.
-
-2012-07-13 version 304.22
-
-    * Added support for the following GPUs:
-        * GeForce GTX 680M
-        * Quadro K1000M
-        * Quadro K2000M
-
-    * Enhanced the functionality of the IncludeImplicitMetaModes X
-      configuration option:
-
-      * Implicit MetaModes will be added for the primary display device,
-        even if multiple display devices are in use when X is initialized.
-
-      * Implicit MetaModes will be added for common resolutions, even
-        if there isn't a mode with that resolution in the mode pool of
-        the display device.
-
-      * Extended the syntax of the IncludeImplicitMetaModes X
-        configuration option, e.g., to control which display device is
-        used for creation of implicit MetaModes.
-
-      See the description of the IncludeImplicitMetaModes X configuration
-      option in the README for details.
-
-    * Modified the handling of the RandR 1.0/1.1 requests RRGetScreenInfo
-      and RRSetScreenConfig (e.g., `xrandr -q --q1` and `xrandr --size ...`
-      and `xrandr --orientation ...`) such that they operate on MetaModes.
-      This was the behavior in NVIDIA X driver versions 295.xx and
-      earlier, but 302.xx releases altered the handling of these RandR
-      1.0/1.1 requests to operate on a single RandR output's modes.
-
-    * With the above changes to IncludeImplicitMetaModes and RandR 1.0/1.1
-      handling, fullscreen applications (e.g., SDL-based applications,
-      Wine), should have more resolutions available to them, and should
-      interact better with multiple monitor configurations.
-
-    * Fixed a bug that could cause G8x, G9x, and GT2xx GPUs to display a black
-      screen or corruption after waking up from suspend.
-
-    * Fixed several bugs that could cause some OpenGL programs to hang
-      when calling fork(3).
-
-    * Fixed an nvidia-settings bug that caused the results of ProbeDisplays
-      queries made with the --display-device-string option to be formatted
-      incorrectly.
-
-    * Improved the responsiveness of updates to the nvidia-settings
-      control panel when displays are hotplugged.
-
-    * Fixed a bug that caused display corruption when setting some
-      transforms, especially when panning a transformed display.
-
-    * Fixed a bug that caused extra RandR events to be generated the first
-      time a display is hotplugged.
-
-    * Fixed a bug that caused X11 modelines with '@' in their names to
-      be rejected.
-
-    * Added support for DisplayPort 1.2 branch devices, which allow multiple
-      displays to be connected to a single DisplayPort connector on a graphics
-      board.
-
-    * Fixed a bug that caused most OpenGL texture uploads to be slow when
-      the context was bound rendering to an RGB overlay drawable.
-
-    * Fixed a bug that caused audio over HDMI to not work after restarting
-      the X server on some MCP7x (IGP) GPUs.
-
-    * Updated the X configuration option "UseDisplayDevice" to honor the
-      value "none" on any GPU.
-
-    * Added support for DKMS in nvidia-installer. Installing the kernel
-      module through DKMS allows the module to be rebuilt automatically
-      when changing to a different Linux kernel. See the README and the
-      nvidia-installer help text for the "--dkms" option.
-
-    * Added RandR output properties _ConnectorLocation, ConnectorNumber,
-      ConnectorType, EDID, _GUID, and SignalFormat.  See the README for details
-      on these properties.
-
-    * Extended support for Base Mosaic to all G80+ SLI configurations with up
-      to three displays.
-
-    * Fixed a bug that caused some monitors to fail to wake from DPMS suspend
-      mode when multiple DisplayPort monitors were attached to one GPU.
-
-    * Removed controls for XVideo attributes from the "X Server XVideo
-      Settings" page of the nvidia-settings control panel. XVideo attributes
-      can be configured in XVideo player applications, or through utilities
-      such as xvattr.
-
-    * Fixed a bug that caused all ports on an XVideo adaptor to share
-      color correction settings.
-
-    * Removed support for the following X configuration options:
-
-         SecondMonitorHorizSync
-         SecondMonitorVertRefresh
- 
-       Similar control is available through the NVIDIA HorizSync and
-       VertRefresh X configuration options.  Please see the NVIDIA driver
-       README for details.
-
-    * Fixed a bug that prevented NVIDIA 3D Vision Pro from working
-      properly when switching between X servers on different VTs.
-
-======== Release 302 Entries ========
-
-    * Added support for desktop panning when rotation, reflection,
-      or transformation is applied to a display device (either through
-      RandR or through the MetaMode syntax); panning would previously be
-      ignored in that case.
-
-2012-06-15 version 302.17
-
-    * Made nvidiaXineramaInfoOrder consistent with the RRSetOutputPrimary
-      and RRGetOutputPrimary RandR requests: changes to either
-      nvidiaXineramaInfoOrder or RandR OutputPrimary will be reflected in
-      the other.
-
-    * Fixed an interaction problem between RandR 1.2, ConstrainCursor,
-      and panning that prevented panning from working properly.
-
-    * Fixed a bug that caused RandR RRNotify_CrtcChange events to not
-      be generated when switching between MetaModes with the same total
-      size but different layout of display devices.  This bug caused
-      some window managers to not update their layouts in response to
-      switching same-sized MetaModes.
-
-    * Added an "EDID" property to RandR 1.2 outputs.  This property contains the
-      binary contents of the connected monitor's extended display identification
-      data, which allows applications such as the GNOME display properties
-      dialog to query information about it.
-
-    * Fixed a bug that caused audio over HDMI to not work on some GPUs
-      after querying the RandR configuration (e.g., `xrandr -q`).
-
-    * Added the "nvidiaXineramaInfo" X configuration option to report
-      the layout of multiple display devices within an X screen.  This is
-      enabled by default.  When disabled on X servers with RandR 1.2
-      support, the NVIDIA X driver will report one screen-sized region.
-      When disabled on X servers without RandR 1.2 support, no Xinerama
-      information will be reported.  For backwards compatibility, the
-      "NoTwinViewXineramaInfo" option disables nvidiaXineramaInfo.
-
-    * Added the "nvidiaXineramaInfoOrder" X configuration option as
-      a replacement for "TwinViewXineramaInfoOrder".  For backwards
-      compatibility, "TwinViewXineramaInfoOrder" is kept as a synonym for
-      "nvidiaXineramaInfoOrder".
-
-    * Added the "nvidiaXineramaInfoOverride" X configuration option as
-      a replacement for "TwinViewXineramaInfoOverride".  For backwards
-      compatibility, "TwinViewXineramaInfoOverride" is kept as a synonym
-      for "nvidiaXineramaInfoOverride".
-
-    * Fixed a bug that prevented the use of some SLI Mosaic topologies.
-
-    * Added the "MetaModeOrientation" X configuration option as a
-      replacement for "TwinViewOrientation".  "TwinViewOrientation"
-      is kept as a synonym for "MetaModeOrientation", for backwards
-      compatibility.
-
-2012-05-19 version 302.11
-
-    * Added support for calculating the physical size and DPI of each
-      RandR 1.2 Output using the EDID Detailed Timing Description.
-
-    * Fixed a bug that prevented a workaround for the invalid EDID in certain
-      AUO laptop flat panels from being applied, leading to an 800x600 desktop
-      repeated several times across the screen.
-
-    * Fixed a bug that caused the link configuration of DisplayPort devices to
-      be reported incorrectly in nvidia-settings.
-
-2012-05-02 version 302.07
-
-    * Fixed a bug that caused OpenGL programs to leak file descriptors
-      when calling exec() on themselves.
-
-    * Fixed rendering corruption at the start of new X server generation.
-
-    * Added X driver support for RandR 1.2 and RandR 1.3.  See "Support
-      for the X Resize and Rotate Extension" in the README for details.
-
-    * Extended the MetaMode X configuration option syntax with the
-      following new attributes:
-
-        "Rotation"    : specifies the display device's rotation
-        "Reflection"  : specifies the display device's reflection
-        "Transform"   : specifies a 3x3 transformation matrix to be
-                        applied to the display device
-        "ViewPortOut" : specifies the region of the mode in which to
-                        display pixels
-        "ViewPortIn"  : specifies the size of the region in the X screen
-                        to display in the ViewPortOut
-
-      For example, "DFP-0: nvidia-auto-select { Rotation=left }".
-      See "Configuring Multiple Display Devices on One X Screen" in the
-      README for details.
-
-    * Removed the "TwinView" X configuration option; the functionality
-      it provided is now enabled by default.
-
-      Previously, the NVIDIA X driver only enabled one display device
-      for an X screen unless "TwinView" was enabled.  Now, the NVIDIA
-      X driver enables, by default, as many display devices as the
-      GPU supports driving simultaneously.  To limit how many display
-      devices are driven by an X screen, use the "UseDisplayDevice"
-      X configuration option.
-
-    * Added a "CurrentMetaMode" attribute to the nvidia-settings command
-      line, to query and set the current MetaMode.
-
-      As an example, these two commands are equivalent:
-
-        xrandr --output DVI-I-2 --mode 1280x1024 --pos 0x0             --output DVI-I-3 --mode 1920x1200 --pos 1280x0
-
-        nvidia-settings --assign CurrentMetaMode=            "DVI-I-2: 1280x1024 +0+0, DVI-I-3: 1920x1200 +1280+0"
-
-    * Removed overscan compensation configurability from NV-CONTROL and
-      nvidia-settings. This can be configured, with finer granularity,
-      through the ViewPortIn and ViewPortOut MetaMode attributes.
-      See "Configuring Multiple Display Devices on One X Screen" in the
-      README for details.
-
-    * Altered mode validation such that for digital display devices
-      the X driver only allows, by default, modes which are reported in
-      the EDID.  Previously, the NVIDIA X driver allowed other modes,
-      but implicitly scaled those other modes to one of the EDID modes.
-
-      Now, only the modes in the EDID are validated and the X driver
-      does not do any implicit scaling.  Any desired scaling can be
-      configured explicitly through the new "ViewPortIn" and "ViewPortOut"
-      MetaMode attributes.  See "Configuring Multiple Display Devices
-      on One X Screen" in the README for details.
-
-    * Removed Flat Panel Scaling configurability in nvidia-settings.
-      Any desired scaling can be configured through the new "ViewPortIn"
-      and "ViewPortOut" MetaMode attributes.
-
-    * Hotplug events (specifically, the RRNotify_OutputChange RandR
-      event) are now generated when display devices are connected and
-      disconnected from the GPU.  Many desktop environments automatically
-      resize the X desktop in response to these events.
-
-    * Added display device name aliases, such that X configuration options
-      that use display device names can refer to a display device by one of
-      several names, including the RandR Output name for the display
-      device.  The X log reports the list of aliases for each display device.
-
-    * Updated EDID parsing to include more complete support for EDID 1.4
-      and more recent versions of CEA-861.
-
-    * Removed the "Rotate" X configuration option.  This was used to
-      statically rotate the X screen.  Its functionality is replaced by
-      the "Rotation" MetaMode attribute and RandR 1.2 rotation support.
-      See the README for details.
-
-    * Removed the "RandRRotation" X configuration option.  This enabled
-      configurability of X screen rotation via RandR 1.1.  Its functionality
-      is replaced by the "Rotation" MetaMode attribute and RandR 1.2
-      rotation support.  See the README for details.
-
-    * Removed support for the following NV-CONTROL attributes:
-        NV_CTRL_GPU_SCALING
-        NV_CTRL_GPU_SCALING_DEFAULT_TARGET
-        NV_CTRL_GPU_SCALING_DEFAULT_METHOD
-        NV_CTRL_DFP_SCALING_ACTIVE
-        NV_CTRL_GPU_SCALING_ACTIVE
-        NV_CTRL_FRONTEND_RESOLUTION
-        NV_CTRL_BACKEND_RESOLUTION
-        NV_CTRL_OVERSCAN_COMPENSATION
-        NV_CTRL_FLATPANEL_BEST_FIT_RESOLUTION
-
-    * Improved rendering performance for RENDER bitmap text.
-
-    * Enabled the OpenGL "Sync to VBlank" option by default.
-
-    * Added a new option, --restore-original-backup, to nvidia-xconfig.
-      nvidia-xconfig creates a backup of the original X configuration
-      file when modifying an X configuration file that does not appear
-      to have been previously modified by nvidia-xconfig. This option
-      restores a backup of the original X configuration file, if such
-      a backup is found.
-
-    * Expose the following additional FSAA modes via NV-CONTROL,
-      nvidia-settings, and through X visuals and GLXFBConfigs:
-
-        16X multisample FSAA on all GeForce GPUs
-
-        Coverage sample FSAA on G80 and above GeForce GPUs
-
-        32X multisample FSAA on G80 and above Quadro GPUs
-
-        64X multisample FSAA on Fermi and above Quadro GPUs
-
-    * Enabled conformant texture clamping by default in OpenGL.
-
-    * Removed support for the GVO Clone mode NV-CONTROL attributes:
-
-        NV_CTRL_GVO_DISPLAY_X_SCREEN
-        NV_CTRL_GVO_X_SCREEN_PAN_X
-        NV_CTRL_GVO_X_SCREEN_PAN_Y
-
-    * Added a new, higher resolution icon for nvidia-settings.
-
-    * Updated the NVIDIA X driver's handling of X configuration options
-      that affect an entire GPU, not just a particular X screen running
-      on a GPU (e.g., "NoPowerConnectorCheck"): for such X configuration
-      options, the X driver will now honor the option on any of the X
-      screens configured on the GPU.  Prior to this change, the NVIDIA
-      X driver only honored such options on the first X screen configured
-      on a GPU.
-
-    * Added a checkbox to nvidia-settings to control the texture clamping
-      attribute.  When the box is checked, OpenGL textures are clamped
-      according to the OpenGL specification.  When it is unchecked, GL_CLAMP
-      is remapped to GL_CLAMP_TO_EDGE for borderless 2D textures.
-
-    * Removed the "Display" and "X Screen" tabs from the "X Server Display
-      Configuration Page" of nvidia-settings, and added a new "Selection"
-      dropdown menu for selecting X screens or display devices.  This
-      makes it easier to select X screens/Displays that are hidden.
-
-======== Release 295 Entries ========
-
-    * Fixed a bug that caused frequent hangs or crashes on some systems.
-
-2012-08-07 version 295.71
-
-    * Implemented hotfix for a privilege escalation vulnerability reported on
-      August 1, 2012.  For more details, see:
-      http://nvidia.custhelp.com/app/answers/detail/a_id/3140
-
-2012-06-11 version 295.59
-
-    * Disabled the use of certain OpenGL optimizations with Autodesk Maya
-      and Mudbox, due to conflicts between these applications and the
-      optimizations. Some performance loss in Autodesk Maya and Mudbox is
-      possible, as a result.
-
-    * Added support for the following GPUs:
-        * GeForce GT 620M
-        * GeForce GT 640M
-        * GeForce GT 640M LE
-        * GeForce GT 650M
-        * GeForce GTX 660M
-        * GeForce GTX 670M
-        * GeForce GTX 675M
-        * GeForce GTX 555
-        * GeForce GTX 560 SE
-        * GeForce GT 415
-        * GeForce GTX 460 v2
-        * NVS 5400M
-        * NVS 310
-        * Quadro 410
-
-    * Fixed a behavior issue where redundant DPMS state transitions were
-      leading to unexpected screen blanking on DisplayPort displays.
-
-2012-05-16 version 295.53
-
-    * Added support for the following GPUs:
-
-        * GeForce GTX 670
-        * GeForce 605
-        * GeForce GT 610
-        * GeForce GT 630
-        * GeForce GT 640
-        * GeForce GT 645
-
-    * Fixed a bug affecting some G-Sync configurations which could cause
-      active stereo content to be inverted on some display devices.
-
-2012-05-03 version 295.49
-
-    * Added support for the following GPU:
-
-        * GeForce GTX 690
-
-    * Fixed a problem where starting, stopping, and moving OpenGL application
-      windows was very slow on Quadro FX 4600, Quadro FX 5600, GeForce 8800
-      GTX, GeForce 8800 GTS, and GeForce 8800 Ultra.
-
-    * Fixed an OpenGL performance regression which affected Geforce 6 and
-      Geforce 7 series integrated GPUs.
-
-2012-04-11 version 295.40
-
-    * Closed a security vulnerability which made it possible for attackers to
-      reconfigure GPUs to gain access to arbitrary system memory. For further
-      details, see: http://nvidia.custhelp.com/app/answers/detail/a_id/3109
-
-    * Fixed a bug that caused DisplayPort devices to occasionally fail to turn
-      back on after the system is resumed from suspend.
-
-    * Added a ModeValidation X configuration option token,
-      "AllowNon3DVisionModes", to allow modes that are not optimized for
-      NVIDIA 3D Vision to be validated on 3D Vision monitors.
-
-    * Added support for the following GPUs:
-
-        * GeForce GT 635M
-        * GeForce 610M
-
-2012-03-22 version 295.33
-
-    * Added support for the following GPUs:
-
-        * GeForce GTX 680
-        * GeForce GT 630M
-        * GeForce GT 620
-
-    * Fixed a VDPAU bug where decoding some H.264 streams would cause hardware
-      errors on lower-end products, resulting in corruption and poor
-      performance.
-
-    * Fixed a bug that caused DisplayPort audio to stop working after monitors
-      are hotplugged on GeForce GT 520.
-
-    * Improved compatibility with recent Linux kernels.
-
-    * Fixed a behavior change that prevented ConnectedMonitor from being usable
-      with DisplayPort connectors.
-
-    * Marked the GVO Clone mode NV-CONTROL attributes:
-
-        NV_CTRL_GVO_DISPLAY_X_SCREEN
-        NV_CTRL_GVO_X_SCREEN_PAN_X
-        NV_CTRL_GVO_X_SCREEN_PAN_Y
-
-      as deprecated.  They will be removed in a future release.  To display
-      an X screen over GVO, it is recommended to use GVO with MetaModes,
-      instead.
-
-    * Fixed a bug that caused DisplayPort devices to not be listed in
-      Xorg.*.log.  For example, if only DisplayPort devices are attached, the
-      log file would contain
-
-        (--) NVIDIA(0): Connected display device(s) on NVIDIA GPU at PCI:2:0:0
-        (--) NVIDIA(0):     none
-
-    * Added support for 3D Vision ready displays that have a NVIDIA 3D Vision
-      infrared emitter built inside the panel itself.
-
-    * Fixed a bug that caused OpenGL applications to crash with some libc
-      versions, such as eglibc 2.15.
-
-    * Fixed a bug that caused HDMI audio to stop working on AppleTV devices when
-      an X server was started.
-
-2012-02-13 version 295.20
-
-    * Fixed a bug that caused black areas to appear on the back faces of
-      some models in Maya.
-
-    * Fixed a bug that resulted in the printing of spurious loader error
-      messages.
-
-    * Fixed a bug that could cause X to crash after hotplugging displays.
-
-    * Fixed a bug which caused face selections to be misrendered in
-      Maya when using the paint selection tool.
-
-    * Improved performance for interactive tools in Mudbox.
-
-    * Added a "--no-opengl-files" option to nvidia-installer to allow
-      installation of the driver without OpenGL files that might conflict
-      with already installed OpenGL implementations.
-
-    * Split the DFP configuration page in nvidia-settings into multiple
-      tabs, allowing the controls to be displayed on smaller screens.
-
-2012-01-31 version 295.17
-
-    * Fixed a bug that could cause some OpenGL applications (including
-      desktop environments like KDE and GNOME Shell) to hang.
-
-    * Fixed a bug that prevented the internal panel from working on some
-      laptops with GeForce 7 series GPUs.
-
-2011-12-27 version 295.09
-
-    * Fixed an OpenGL bug where using display lists on Fermi-based GPUs
-      could result in missing rendering in some cases.
-
-    * Fixed an OpenGL bug that caused incorrect rendering when using
-      framebuffer objects to render to 16-bit color textures with
-      alpha.
-
-    * Added support for the following GPU:
-
-        * Tesla X2090
-
-    * Fixed two bugs that caused sporadic application crashes in some multi-
-      threaded OpenGL applications.
-
-    * Fixed a bug that caused creating OpenGL 4.2 contexts
-      with glXCreateContextAttribsARB to fail.
-
-    * Fixed a bug that caused OpenGL to print
-
-        Xlib:  extension "NV-GLX" missing on display ":0".
-
-      when used with a non-NVIDIA implementation of the GLX X extension.
-
-    * Implemented color depth 30 (10 bits per component) support for GeForce 8
-      series and higher GPUs.
-
-    * Implemented support for constraining cursors to the visible regions of
-      connected displays; see the "ConstrainCursor" X Option in the README for
-      details.
-
-======== Release 290 Entries ========
-
-2011-11-21 version 290.10
-
-    * Fixed a bug that would cause OpenGL applications to crash when run
-      with recent releases of glibc such as glibc 2.14.90.
-
-    * Improved the performance of FBO bind operations when using Xinerama by
-      ~30% in some cases.
-
-    * Fixed a bug that could cause stereo corruption when driving a stereo
-      display and a non-stereo display from the same GPU.
-
-    * Fixed a bug that could cause display devices on a secondary GPU to get
-      swapped between X screens when restarting the X server.
-
-    * Fixed a bug that could result in line flickering in full-scene anti-
-      aliasing contexts.
-
-    * Fixed a bug that caused the physical dimensions of rotated monitors to be
-      reported incorrectly.
-
-    * Add support for the pre-VBO DrawArrays command in the server-side GLX
-      driver module.  The NVIDIA client-side GLX implementation never sends
-      this command, but the server needs to support it for compatibility with
-      other GLX client implementations.
-
-    * Fixed a regression that caused blank/white windows when exhausting video
-      memory on GeForce 6 and 7 series GPUs while using composited
-      desktops.
-
-2011-11-04 version 290.06
-
-    * Added support for the following GPU:
-
-        * GeForce GTX 460 SE v2
-
-    * Fixed a bug that would cause applications which export custom allocation
-      functions to our driver (such as Adobe Flash in Firefox or Chrome) to crash.
-
-2011-10-21 version 290.03
-
-    * Fixed a bug that prevented the driver from loading on some systems with
-      integrated graphics.
-
-    * Fixed issues in VDPAU that prevented allocating and displaying extremely
-      large VdpOutputSurfaces.
-
-    * Added support for limiting heap allocations in the OpenGL driver through
-      the use of the __GL_HEAP_ALLOC_LIMIT environment variable.  See the README
-      for further details.
-
-    * Added an "Accel" option to the X driver to allow disabling its use of the
-      graphics processing hardware.  This is useful when other components, such
-      as CUDA, require exclusive use of the GPU's processing cores.
-
-    * Modified how the OpenGL driver allocates executable memory so it may
-      continue to function properly if /tmp is mounted noexec. As some fallback
-      allocation methods may be prohibited under SELinux policy, the driver now
-      supports detection of this policy as well as manual override of this
-      detection via the __GL_SELINUX_BOOLEANS environment variable.
-
-    * Fixed a bug that caused various GLSL built-in uniforms to not
-      be updated properly when calling glPopAttrib.
-
-    * Improved performance by caching compiled OpenGL shaders to disk. Added a
-      "GLShaderDiskCache" option to the X driver to enable/disable this
-      feature. Added the __GL_SHADER_DISK_CACHE and __GL_SHADER_DISK_CACHE_PATH
-      environment variables for further configuration. See the README for
-      further details.
-
-    * Added GLX protocol support (i.e., for GLX
-      indirect rendering) for the following OpenGL extension:
-
-      GL_NV_copy_image
-
-======== Release 285 Entries ========
-
-    * Fixed a bug causing a Linux kernel BUG when retrieving CPU information on
-      some systems.
-
-    * Fixed a bug causing some applications to hang on exit.
-
-    * Fixed a bug causing flickering in some GPU/display combinations.
-
-    * Fixed a bug that could result in poor OpenGL performance after hotplugging
-      a monitor.
-
-    * Added support for the following GPU:
-
-        * GeForce GT 520MX
-
-    * Fixed a bug causing possible text corruption when recovering from GPU
-      errors.
-
-2011-08-17 version 285.03
-
-    * Fixed a bug causing corruption of images which are 2047 pixels wide.
-
-    * Improved performance of the RENDER extension on Fermi-based GPUs.
-
-    * Fixed a bug causing the X server to crash after a VT-switch while running
-      an OpenGL stereo application which is a member of a swap group.
-
-======== Release 280 Entries ========
-
-2011-08-01 version 280.13
-
-    * Fixed a GLX bug that could cause the X server to crash when
-      rendering a display list using GLX indirect rendering.
-
-    * Fixed a GLX bug that could cause a hang in applications that
-      use X server grabs.
-
-    * Fixed an X driver bug that caused 16x8 stipple patterns to
-      be rendered incorrectly.
-
-2011-07-26 version 280.11
-
-    * Fixed a GLX_EXT_texture_from_pixmap bug that caused corruption
-      when texturing from sufficiently small pixmaps and, in particular,
-      corruption in the GNOME Shell Message Tray.
-
-2011-06-29 version 280.04
-
-    * Added support for the following GPUs:
-
-        * GeForce GTX 570M
-        * GeForce GTX 580M
-
-    * Added unofficial GLX protocol support (i.e., for GLX indirect
-      rendering) for the following OpenGL extension:
-
-      GL_EXT_vertex_attrib_64bit 
-
-    * Added GLX protocol support (i.e., for GLX
-      indirect rendering) for the following OpenGL extensions:
-
-      GL_ARB_half_float_pixel
-      GL_EXT_packed_depth_stencil
-
-======== Release 275 Entries ========
-
-    * Added support for the following GPU:
-
-        * NVS 5200M
-
-    * Added support for deleting SDI audio ancillary data packets when a video
-      frame is dropped on a Quadro SDI Output device.  See the
-      NV_CTRL_GVO_AUDIO_BLANKING attribute in NVCtrl.h for details.  This option
-      can be set via the "GvoAudioBlanking" attribute in nvidia-settings.
-
-    * Added support for xserver 1.11.99.901 (also known as 1.12 RC1).
-
-2011-12-14 version 275.43
-
-    * Fixed a bug that would cause Firefox to abort on pages with Flash when
-      layers acceleration was force-enabled on Linux and Solaris.
-
-    * Fixed a bug that caused a crash when glDrawArrays was used with a non-VBO
-      vertex attribute array to draw on a Xinerama screen other than screen 0
-      using an indirect GLX context.
-
-2011-11-04 version 275.36
-
-    * Added support for the following GPU:
-
-        * GeForce 510
-
-    * Fixed a bug that caused trapezoid and triangle rendering to be very slow
-      on older GPUs with xorg-server 1.11.
-
-2011-09-07 version 275.28
-
-    * Added support for xserver ABI 11 (xorg-server 1.11).
-
-    * Fixed a bug that caused the GLSL built-in uniforms gl_FrontMaterial
-      and gl_BackMaterial to not be updated properly when calling
-      glMaterial from a display list.
-
-    * Fixed an error handling bug that caused the OpenGL driver to
-      crash while running certain WebGL applications.
-
-    * Fixed a bug in VDPAU that caused a glibc assertion when a call to
-      VdpDeviceCreateX11 failed in certain ways.
-
-2011-07-15 version 275.21
-
-    * Restored the release splash screen in the NVIDIA X driver (the beta
-      splash screen was accidentally reenabled between 275.09.07 and
-      275.19).
-
-    * Fixed a bug that caused nvidia-settings to crash when configuring
-      multiple X screens after all monitors were unplugged from one of
-      the X screens.
-
-    * Fixed a bug in nvidia-settings that caused the display configuration
-      page to show extra disabled displays after connecting a new monitor.
-
-    * Added X configuration options "3DVisionProHwButtonPairing",
-      "3DVisionProHwSinglePairingTimeout", "3DVisionProHwMultiPairingTimeout",
-      and "3DVisionProHwDoubleClickThreshold" to configure hardware button
-      based pairing in NVIDIA 3D Vision Pro.
-      See "Appendix B. X Config Options" in the README for more information.
-
-    * Fixed a bug that prevented initialization of the NVIDIA 3D Vision or
-      NVIDIA 3D Vision Pro hub if no EDID was present.
-
-2011-07-15 version 275.19
-
-    * Fix memory error and abort reported by glibc when running the application
-      FieldView from Intelligent Light.
-
-    * Fixed an OpenGL driver bug that caused an application crash when running
-      Altair HyperMesh.
-
-    * Fixed a performance problem when switching between stereo and monoscopic
-      rendering in the application Smoke.
-
-    * Fixed poor X driver handling of pixmap out of memory scenarios.
-
-    * Fixed an interrupt handling deficiency that could lead to performance and
-      stability problems when many NVIDIA GPUs shared few IRQs.
-
-    * Added support for the following GPUs:
-
-        * GeForce GT 540M
-
-    * Fixed bugs in the VDPAU presentation queue that could cause GPU errors
-      and hangs when destroying a presentation queue. This happens when
-      exiting applications, and also when toggling to and from full-screen
-      mode in Adobe Flash.
-
-2011-06-14 version 275.09.07
-
-    * Fixed a bug that caused desktop corruption in GNOME 3 after a
-      VT-switch or suspend/resume cycle.
-
-    * Added support for the following GPUs:
-
-        * GeForce GTX 560
-        * GeForce GT 545
-        * GeForce GTX 560M
-        * GeForce 410M
-        * GeForce 320M
-        * GeForce 315M
-        * Quadro 5010M
-        * Quadro 3000M
-        * Quadro 4000M
-
-2011-06-05 version 275.09.04
-
-    * Fixed a bug that caused freezes and crashes when resizing windows in
-      KDE 4 with desktop effects enabled using X.Org X server version 1.10
-      or later.
-
-    * Modified the X driver to request that hardware inform the audio driver
-      whenever a display is disabled. This will allow the audio driver to
-      generate the appropriate jack unplug events to applications.
-
-    * Added support for the GL_EXT_x11_sync_object extension.  See the
-      extension specification in the OpenGL registry here:
-
-        http://www.opengl.org/registry/specs/EXT/x11_sync_object.txt
-
-      for more details.
-
-    * Improved performance of window resize operations in KDE 4 on systems
-      with slow CPUs.
-
-2011-05-19 version 275.09
-
-    * Added support for hardware button based pairing to NVIDIA 3D Vision Pro.
-      Single click button on the hub to enter into a pairing mode which pairs
-      one pair of glasses at a time. Double click the same button on the
-      hub to enter into a pairing mode which pairs multiple pairs of glasses
-      at a time.
-
-    * Added unofficial GLX protocol support (i.e., for GLX indirect
-      rendering) for the following OpenGL extensions:
-
-      GL_NV_framebuffer_multisample_coverage
-      GL_NV_texture_barrier
-
-    * Added GLX protocol support (i.e., for GLX
-      indirect rendering) for the following OpenGL extension:
-
-      GL_NV_register_combiners2
-
-    * Fixed a bug that caused the pop-out and external DVI displays to go blank
-      on Lenovo ThinkPad W701 laptops.
-
-    * Fixed a bug that caused corruption on the menus in OpenOffice.org when the
-      screen is rotated.
-
-    * Improved performance of certain memory allocations.
-
-    * Fixed a bug that caused Java2D widgets to disappear when Java is
-      configured to render using FBOs.
-
-    * Fixed a bug that caused nvidia-settings to crash while saving the X
-      configuration file on some Linux distributions.
-
-    * Added a new X configuration option "BaseMosaic" which can be used to
-      extend a single X screen transparently across all of the available
-      display outputs on each GPU. See "Appendix B. X Config Options" in the
-      README for more information.
-
-======== Release 270 Entries ========
-
-    * Fixed a bug causing incorrect reporting of GPU core and ambient
-      temperatures via NV-CONTROL.
-
-2011-05-19 version 270.41.19
-
-    * Fixed a bug in the VDPAU presentation queue that could cause 1
-      second hangs when transitioning from blit-based display to overlay-
-      based display. This would most commonly happen when disabling a
-      compositing manager.
-
-    * Fixed a bug that could cause crashes when capturing SDI video.
-
-    * Fixed a corner-case in which the OpenGL driver could leak resources
-      in applications utilizing fork().
-
-    * Addressed a Linux kernel interface compatibility problem that could
-      lead to ioremap() errors and, potentially, functional and/or
-      stability problems.
-
-    * Fixed a bug that caused SLI initialization to fail on some Intel
-      based systems.
-
-    * Fixed a bug that caused SLI initialization to fail when using recent
-      Linux kernels, such as 2.6.38.
-
-2011-04-20 version 270.41.06
-
-    * Fixed a bug that caused some GPUs to stop responding when the X Server
-      was started. All GPUs are susceptible, but the failure was primarily
-      seen on GF104 and GF106 boards.
-
-    * Added support for the following GPUs:
-
-        * Tesla M2090
-        * Tesla M2075
-        * Tesla C2075
-        * Quadro 7000
-
-2011-04-18 version 270.41.03
-
-    * Fixed a bug causing the X server to hang every 49.7 days on 32-bit
-      platforms.
-
-    * Added support for the following GPUs:
-
-        * GeForce GT 520
-        * GeForce GT 525M
-        * GeForce GT 520M
-        * GeForce GT 445M
-        * GeForce GT 530
-        * GeForce 405
-        * GeForce GTX 590
-        * GeForce GTX 550 Ti
-        * GeForce GT 420
-        * GeForce GT 440
-        * GeForce GTX 470M
-        * GeForce GTX 485M
-        * GeForce GT 550M
-        * GeForce GT 555M
-        * NVS 4200M
-        * Quadro 1000M
-        * Quadro 2000M
-
-2011-03-02 version 270.30
-
-    * Added support for xserver ABI 10 (xorg-server 1.10).
-
-    * Dropped support for xserver ABI 9 (which was only used with xorg-server
-      1.10 RC2 due to a last-minute xserver change).
-
-2011-02-24 version 270.29
-
-    * Added official support for xorg-server 1.10 [RC2 only, see above].  The
-      -ignoreABI option is no longer required with this version of the server.
-
-2011-02-15 version 270.26
-
-    * Added NV-CONTROL event notification for NV_CTRL_FRAMELOCK_SYNC_READY
-      status changes.
-
-    * Added support for the following GPUs:
-
-        * GeForce GTX 560 Ti
-
-    * Added a new X configuration option "Interactive", which defaults to
-      enabled, but can be disabled to allow long-running GPU compute programs
-      to run concurrently with X.
-
-    * Fixed a bug in the VDPAU presentation queue that could cause VDPAU
-      "display preemption" when rendering to tiny or zero-sized windows or
-      pixmaps.
-
-    * Fixed a bug in VDPAU which prevented use of the overlay presentation
-      queue following an application exiting without gracefully destroying its
-      VDPAU presentation queue.
-
-    * Fixed a bug in VDPAU that prevented the overlay from ever being used if
-      a presentation queue was created while the target window was redirected
-      using the Composite extension when the presentation queue was created.
-
-2011-01-21 version 270.18
-
-    * Added preliminary support for xserver 1.10.
-
-    * Reorganized the NVIDIA driver's /proc file system layout to better
-      reflect current needs: /proc/driver/nvidia/cards/0..N has been
-      moved to /proc/driver/nvidia/gpus/0..N/information
-
-    * Added new shared library: libnvidia-ml.so.
-
-      NVML provides programmatic access to static information and monitoring
-      data for NVIDIA GPUs, as well as limited managment capabilities. It is 
-      intended for use with Tesla compute products.
-
-      See web-based documentation and associated nvml.h header for more info.
-
-    * Added a new X configuration option "3DVisionDisplayType" to specify
-      the display type when NVIDIA 3D Vision is enabled with a non
-      3D Vision ready display.
-
-    * Fixed several bugs relating to hardware-accelerated gradients, which were
-      causing visual corruption in some of the default Ubuntu GNOME themes.
-
-    * Added unofficial GLX protocol support (i.e., for GLX indirect
-      rendering) for the following OpenGL extensions:
-      GL_ARB_shader_subroutine
-      GL_ARB_map_buffer_range                         
-
-    * Added GLX protocol support (i.e., for GLX
-      indirect rendering) for the following OpenGL extensions:
-      GL_NV_half_float
-      GL_NV_occlusion_query                             
-      GL_EXT_blend_equation_separate                  
-      GL_EXT_depth_bounds_test
-
-======== Release 265 Entries ========
-
-    * Modified colormap updates to no longer be synchronized to vblank.  This
-      allows applications to send XStoreColor and XStoreColors requests faster
-      than the screen's refresh rate.
-
-      This behavior can be controlled by a new NV-CONTROL attribute,
-      NV_CONTROL_SYNC_LUT_UPDATES.  By default, LUT updates are not
-      synchronized.  This may cause flickering in some applications that use the
-      colormap to perform animation, such as xpilot running on a depth 8 X
-      screen.  If you experience flickering, try running
-
-          nvidia-settings -a [gpu:0]/SynchronousPaletteUpdates=1
-
-======== Release 260 Entries ========
-    * Updated the NVIDIA X driver to not update mode timings for G-Sync
-      compatibility when NVIDIA 3D Vision or NVIDIA 3D VisionPro is
-      enabled along with a G-Sync device.
-
-    * Added support for the following GPUs:
-
-	* Quadro 2000 D
-	* Quadro 400
-
-2011-01-21 version 260.19.36
-
-    * Updated the NVIDIA kernel module to ensure that all system memory
-      allocated by it for use with GPUs or within user-space components of the
-      NVIDIA driver stack is initialized to zero.  A new NVIDIA kernel module
-      option, InitializeSystemMemoryAllocations, allows administrators to
-      revert to the previous behavior.
-
-    * Fixed a bug that caused X servers version 1.9 and higher to crash when
-      color index overlays were enabled.
-
-    * Fixed a bug that caused pixel value 255 to be treated as transparent in
-      color index overlays.
-
-2010-12-13 version 260.19.29
-
-    * Added support for the following GPUs:
-
-        * GeForce GTX 460 SE
-        * GeForce GTX 570
-	* Quadro 5000M
-	* NVS 300
-
-    * Fixed a bug that caused some OpenGL applications to become
-      unresponsive for up to a minute on some GPUs when changing
-      the resolution or refresh rate.
-
-    * Added support for NVIDIA 3D Vision Pro.
-      See the "Stereo" X configuration documentation in the README
-      for further details.
-
-    * Added a new X configuration option "3DVisionProConfigFile"
-      to allow user provide a filename which NVIDIA X driver uses
-      to store 3D Vision Pro configuration settings.
-      See "Appendix B. X Config Options" in the README for
-      more information.
-
-2010-11-11 version 260.19.21
-
-    * Fixed a race condition in OpenGL that could cause crashes with
-      multithreaded applications.
-
-    * Fixed a bug that may cause OpenGL applications which fork to crash.
-
-    * Fixed a bug in VDPAU that caused it to attempt allocation of huge
-      blocks of system memory. This regression was introduced in the
-      260.* driver series.
-
-2010-10-13 version 260.19.12
-
-    * Added support for the following GPUs:
-
-        * GeForce GTS 450
-        * GeForce GTX 460M
-        * GeForce GT 415M
-        * GeForce GT 425M
-        * GeForce GT 420M
-        * GeForce GT 435M
-        * Quadro 2000
-        * Quadro 600
-
-    * Temporarily added back OpenGL header files to the Linux driver
-      package, though these are not installed by default.  To have these
-      OpenGL header files installed, pass "--opengl-headers" to the NVIDIA
-      .run file.  These will be removed from future NVIDIA driver packages
-      once http://www.opengl.org/registry/ provides gl.h and glx.h.
-
-    * Fixed the CustomEDID X configuration option so that it can handle
-      EDID files from Linux procfs; e.g., /proc/acpi/video/IGPU/LCD0/EDID.
-
-2010-09-15 version 260.19.06
-
-    * Fixed an interaction problem with a change in X server behavior that
-      caused slow text rendering on X.Org xserver 1.9.
-
-    * Enhanced VDPAU to support interop with CUDA and OpenGL when Xinerama
-      is active.
-
-    * Fixed a bug in VDPAU that prevented temporal-spatial de-interlacing from
-      operating when temporal de-interlacing was not also enabled.
-
-    * Added support for configuring the dithering depth used when driving
-      a flat panel with a GeForce 8 family or Quadro 4600/5600 or
-      newer GPU.  See the "Dithering Controls" in the Flat Panel page
-      in nvidia-settings.
-
-2010-09-08 version 260.19.04
-
-    * Added support for the nvcuvid API.
-
-      nvcuvid provides a mechanism for decoding video and exposing the
-      surfaces to CUDA, allowing applications to perform custom processing of
-      the video. nvcuvid is primarily targeted at transcoding and video-
-      processing applications. nvcuvid was already available on other
-      platforms.
-
-      By default, nvidia-installer places the nvcuvid library in
-      /usr/lib/libnvcuvid.so, or in the appropriate library path for
-      your system.  The nvcuvid header files can be retrieved from the
-      CUDA toolkit package.
-
-    * Stopped packaging and installing OpenGL, VDPAU, CUDA, and OpenCL
-      header files with the driver.  Those interested in these files can
-      get them from their Linux distributions' packages, where available,
-      or upstream from:
-
-        OpenGL header files (gl.h, glext.h glx.h, glxext.h):
-            http://www.opengl.org/registry/
-
-        VDPAU header files (vdpau.h and vdpau_x11.h):
-            http://freedesktop.org/wiki/Software/VDPAU
-
-        CUDA and OpenCL header files (cuda.h, cudaGL.h, cudaVDPAU.h,
-                cl.h, cl_gl.h, cl_platform.h):
-            http://developer.nvidia.com/object/gpucomputing.html
-
-      Note that while libvdpau.so is still included in 260.xx drivers,
-      it will be removed from a future release series in early 2011.
-      Distributors are encouraged to package libvdpau.so from
-      http://freedesktop.org/wiki/Software/VDPAU
-
-    * Fixed a bug in VDPAU that could cause a "display preemption" when
-      toggling MPlayer to full-screen the first time.
-
-    * Added OpenGL 4.1 support for Quadro Fermi, GeForce GTX 4xx, and
-      later GPUs.
-
-    * Enhanced VDPAU to fully support Xinerama.
-
-    * Fixed a bug in the X driver that prevented operation of Xinerama when
-      using multiple NVIDIA GPUs from different major hardware generations
-      on X with ABI 4 or greater.
-
-    * Fixed a bug in the OpenGL driver's Xinerama support.
-
-      Rendering should have ocurred to all physical X screens driven by an
-      NVIDIA GPU compatible with the NVIDIA GPU driving physical X screen 0.
-      However, if some physical X screen did not satisfy that requirement,
-      then not only would that physical X screen not be rendered to (as
-      expected), but also all physical X screens with a higher number would
-      not be rendered to (which was unexpected).
-
-    * Added GPU "Processor Clock" reporting to the nvidia-settings PowerMizer
-      page.
-
-    * Implemented support for SLI Mosaic Mode on Quadro FX 5800 and
-      Quadro Fermi and newer Quadro GPUs.
-
-    * Enhanced the VDPAU overlay-based presentation queue to allow it to be
-      used when SLI is active, and in some cases when the X composite
-      extension is enabled. See the README for further details.
-
-    * Added support for configuring the dithering mode used when driving
-      a flat panel with a GeForce 8 family or Quadro 4600/5600 or
-      newer GPU.  See the "Dithering Controls" in the Flat Panel page
-      in nvidia-settings.
-
-    * Added unofficial GLX protocol support (i.e., for GLX indirect
-      rendering) for the following OpenGL extensions:
-      GL_EXT_texture_integer
-      GL_ARB_stencil_two_side
-      GL_EXT_transform_feedback2
-      GL_NV_transform_feedback2
-      GL_NV_conditional_render
-
-    * Added GLX protocol support (i.e., for GLX indirect rendering)
-      for the following OpenGL extensions:
-      GL_NV_point_sprite
-      GL_EXT_stencil_two_side
-      GL_EXT_point_parameters
-      GL_ARB_transpose_matrix
-      GL_EXT_framebuffer_blit
-      GL_EXT_framebuffer_multisample
-
-    * GLX protocol for the following OpenGL extension is promoted
-      from unofficial GLX ptotocol to ARB approved GLX protocol:
-      GL_EXT_geometry_shader4
-      GL_ARB_shader_objects
-      GL_ARB_vertex_shader
-      GL_ARB_fragment_shader
-
-    * Added support for configuring individual displays as any eye in passive
-      stereo mode "4" when using TwinView or SLI Mosaic through extensions to
-      the MetaMode syntax.
-
-    * Added ColorSpace and ColorRange features for HDMI. These give
-      the ability to output YUV over HDMI and select full/reduced
-      color range on RGB over HDMI. ColorSpace and ColorRange
-      are X Configuration options and can be changed dynamically
-      through nvidia-settings.
-
-======== Release 256 Entries ========
-
-    * Fixed a bug that prevented XvMC from initializing in most cases.
-
-    * Added support for xorg-server video driver ABI version 8, which will be
-      included in the upcoming xorg-server-1.9 series of releases.
-
-    * Fixed a bug that caused extremely slow rendering of OpenGL applications
-      on X screens other than screen 0 when using a compositing manager.
-
-    * Fixed a regression introduced after 256.35 that caused stability
-      problems on GPUs such as GeForce GT 240.
-
-    * Fixed a slow kernel virtual address space leak observed when
-      starting and stopping OpenGL, CUDA, or VDPAU applications.
-
-    * Fixed a bug that left the system susceptible to hangs when running
-      two or more VDPAU applications simultaneously.
-
-2010-07-29 version 256.44
-
-    * Added Support for Quadro 4000, Quadro 5000, and Quadro 6000.
-
-    * Updated nvidia-installer to detect the nouveau kernel module and
-      fail with an appropriate error message.
-
-    * Added information to the NVIDIA driver README on how to disable
-      the nouveau driver.
-
-    * Fixed VDPAU to not print a debug error message when calling
-      VdpVideoMixerQueryFeatureSupport with an unsupported or unknown
-      VdpVideoMixerFeature.
-
-    * Removed the requirement that in TwinView passive stereo, MetaModes
-      must have identical viewports on each monitor.
-
-    * Removed the requirement that in active stereo, all monitors must
-      use identical modetimings.
-
-    * Enhanced VDPAU to better report certain kinds of initialization error.
-
-    * Fixed a regression that caused Xv to return BadAlloc errors on AGP
-      systems when using the AGP GART driver contained in the NVIDIA driver.
-      This fixes the problem reported in nvnews.net thread 151199.
-
-2010-06-22 version 256.35
-
-    * Fixed a regression in 256.29 where Performance Level clock
-      frequencies were reported incorrectly in nvidia-settings.
-
-    * Fixed a 3D Vision Stereo bug that caused the stereo glasses to not
-      toggle when the flat panel was not running at its native mode timings.
-
-    * Fixed a bug that caused nvidia-settings to crash when rendering
-      its thermal gauge widget if the range of valid values for the thermal
-      sensor was empty.
-
-2010-05-28 version 256.29
-
-    * Fixed a bug which prevented use of high performance PowerMizer
-      levels on systems with certain ACPI configurations.
-
-    * Fixed a bug that caused non-primary Fermi GPUs to fail to initialize
-      framebuffer memory. This caused a variety of symptoms, up to and
-      including system hangs.
-
-2010-05-21 version 256.25
-
-    * Added unofficial GLX protocol support (i.e., for GLX indirect
-      rendering) for the following OpenGL extensions:
-
-       GL_ARB_blend_func_extended
-       GL_ARB_draw_buffers_blend
-       GL_ARB_sample_shading
-       GL_ARB_timer_query
-       GL_EXT_draw_buffers2
-       GL_EXT_separate_shader_objects
-       GL_NV_explicit_multisample
-       GL_NV_transform_feedback
-
-    * Improved Thermal Settings reporting in nvidia-settings to
-      accurately reflect hardware configurations with multiple thermal
-      sensors.
-
-    * Fixed an interaction problem between Compiz and
-      'screen-scraping' VNC servers like x11vnc and vino that caused the screen
-      to stop updating.
-      Fixes Launchpad bug #353126.
-
-    * Enhanced VDPAU to add basic support for Xinerama. VDPAU will now
-      operate on a single physical X screen under Xinerama. See the
-      README for more details.
-
-    * Enhanced VDPAU's handling of corrupt clips of all formats on GPUs with
-      VDPAU feature set C to be at least as good as on GPUs with VDPAU
-      feature set B. This significantly improves various clips provided by
-      nvnews.net user eamiller.
-
-    * Fixed a bug in Xv attribute handling that caused hue, saturation,
-      brightness, and contrast values to be misapplied when using an
-      Xv overlay adaptor.
-
-    * Fixed a bug in the XvMC driver that prevented it from working on
-      systems with AGP graphics cards.
-
-    * Enhanced VDPAU to clear all VdpVideoSurfaces to black when allocated.
-      This provides more consistent results when using a surface as a
-      reference when no prior decode operation has written to that surface.
-      In turn, this improves the results of decoding some corrupt streams,
-      such as "p_only_no_play" from ffmpeg bug 1124.
-
-    * Implemented new APIs to allow sharing VDPAU surfaces with OpenGL and
-      CUDA. The OpenGL extension is GL_NV_vdpau_interop. For CUDA, please
-      see the documentation in the CUDA toolkit for details.
-
-    * Worked around a bug where the combination of a GPU with VDPAU feature
-      set A together with specific motherboard chipsets could cause visible
-      corruption when decoding some MPEG-2 streams
-
-    * Fixed a bug that prevented the VDPAU overlay-based presentation queue
-      from being used more than a few hundred times per X server invocation.
-
-    * Renamed the driver file libGLcore.so.VERSION to
-      libnvidia-glcore.so.VERSION, as a small step towards reducing the
-      filename collisions between NVIDIA's and Mesa's OpenGL implementations.
-      This driver file is used by NVIDIA's libGL.so and libglx.so, and
-      should never be used directly by applications.
-
-    * Changed the SONAME of libnvidia-glcore.so.VERSION,
-      libnvidia-tls.so.VERSION, and libnvidia-compiler.so.VERSION to be
-      ".so.VERSION", rather than ".so.1".  These driver files are only used
-      by other NVIDIA driver components, and are only intended to be used
-      by components of the matching NVIDIA driver version.
-
-    * Removed the "-pkg#" suffix from the NVIDIA Linux .run files.
-      The packages are now simply named "NVIDIA-Linux-ARCH-VERSION.run".  On
-      Linux-x86_64, a package which omits the 32-bit compatibility libraries
-      is also available: "NVIDIA-Linux-x86_64-VERSION-no-compat32.run"
-
-    * Simplified the directory structure of the Linux extracted package;
-      most driver files are now just contained within the top level directory
-      of the package.  Pass the '--list' option to the .run file for details.
-
-    * Removed precompiled kernel interfaces from the NVIDIA Linux-x86 .run
-      file; these were ancient and had not been updated in years.  Going
-      forward, NVIDIA does not plan to provide precompiled kernel interfaces
-      with the Linux .run files.  However, nvidia-installer and the .run
-      file will retain the ability for users to add their own precompiled
-      kernel interfaces via the '--add-this-kernel' .run file option.
-
-    * Compressed the nvidia-settings, nvidia-installer, and nvidia-xconfig 
-      tarballs with bzip2, rather than gzip.
-
-======== Release 195 Entries ========
-
-    * Fixed a problem with SLI SFR, AFR, and SLIAA modes with GeForce GTX 480
-      and GeForce GTX 470 and high-resolution display modes.
-
-2010-04-28 version 195.36.24
-
-    * Added support for the following GPUs:
-
-        * GeForce GTX 480
-        * GeForce GTX 470
-        * Tesla C2050
-
-    * Fixed a problem that caused occasional red flashes in XVideo frames.
-
-    * Added official support for xserver 1.8.  The -ignoreABI option
-      is no longer required with this version of the server.
-
-    * Updated the "Supported NVIDIA GPU Products" list to include various
-      supported GPUs that were missing previously.
-
-2010-03-15 version 195.36.15
-
-    * Fixed a regression that caused the driver to fail to properly adjust
-      the GPU fan speed on some GPUs.
-
-    * Fixed a bug that prevented performance level transitions on recent
-      GPUs with SDDR3 and GDDR5 memory.
-
-    * Fixed a bug that caused the X server to crash when rendering
-      occurred while the X server was not on the active VT.
-
-2010-03-03 version 195.36.08
-
-    * Added support for the following GPUs:
-
-        * Quadro FX 880M
-        * GeForce GTS 350M
-        * GeForce GTS 360M
-
-    * Fixed a bug that caused screen corruption after an application
-      released a GLX_NV_present_video device.
-
-    * Fixed an X server crash caused by starting nvidia-settings while X was not
-      on the active VT.
-
-    * Fixed brightness control hotkeys on some laptops.
-
-    * Fixed an nvidia-settings bug that produced many "Bad argument" warning
-      messages when running nvidia-settings --query all.
-
-    * Fixed an installer bug that produced the following message:
-
-        WARNING: Unable to perform the runtime configuration check for library
-        'libGL.so.1' ('/usr/lib/libGL.so.195.36.03'); assuming successful
-        installation.
-
-    * Fixed a bug that caused G-Sync stereo synchronization to fail sometimes
-      when enabling frame lock.
-
-    * Fixed a bug that caused OpenGL applications to occasionally crash with
-      "double free or corruption" messages when exiting.
-
-    * On GPUs with VDPAU feature set A, enhanced VDPAU's handling of some
-      corrupted or incorrectly formatted MPEG-1/2 streams. This solves a
-      reported issue with "0testbad.mpg".
-
-    * Fixed a bug in the VDPAU video mixer that caused chroma aberrations,
-      and corruption in the right-hand few columns of pixels, when post-
-      processing video surfaces with widths not an exact multiple of 4 pixels.
-
-    * Fixed a bug that prevented the GPUFanControlState attribute from
-      being set on the nvidia-settings command line.
-
-2010-02-03 version 195.36.03
-
-    * Fixed a regression that made the "TVStandard" X configuration option
-      cause system hangs with products from the GeForce 6 and 7 series.
-
-    * Worked around a bug in some AUO laptop flat panels where the native mode
-      in the EDID is invalid, leading to a 640x480 desktop repeated six times
-      across the screen.
-
-    * Increased the maximum number of slices supported by VDPAU for MPEG-2
-      streams, in order to cope with the region 1 DVD "A Christmas Story".
-
-    * Added unofficial preliminary support for xorg-server video driver ABI
-      version 7, including xorg-server-1.7.99.2.
-
-    * Fix the soname of libvdpau_nvidia.so.1 and libvdpau_trace.so.1 to
-      match their filenames.
-
-2009-12-22 version 195.30
-
-    * Fixed a performance regression with non-antialiased text in KDE4.
-
-    * Enabled GPU acceleration for many RENDER compositing operations that were
-      previously processed in software, including conjoint and disjoint blending
-      modes and component alpha blending.
-
-    * Added experimental GPU acceleration of the RENDER CompositeTrapezoids
-      operation. This can be enabled at runtime by running:
-
-        nvidia-settings -a AccelerateTrapezoids=1
-
-      This is only supported on the GeForce GTX series or newer products.
-
-    * Fixed a bug in the VDPAU overlay-based presentation queue that caused
-      high CPU usage during "put bits" operations when more than two surfaces
-      were queued.
-
-    * Updated `nvidia-settings --query all` to report all available
-      attributes queryable through all NV-CONTROL target types.
-
-2009-11-23 version 195.22
-
-    * Enhanced the VDPAU blit-based presentation queue to provide values of
-      "first_presentation_time" that have less jitter.
-
-    * Add support for R16F and RG32F GLXFBConfigs when using GeForce 8
-      series and higher GPUs.
-
-    * Added support for NVIDIA 3D Vision Stereo on Linux with Quadro
-      GPUs. See the "Stereo" X configuration documentation in the README
-      for details.
-
-    * Added support for A2BGR10 32-bit GLX visuals on 30-bit X screens.
-      These allow some level of window transparency when using 30-bit
-      visuals with GLX and Composite, but they may cause problems with
-      older X servers and/or applications.  ARGB GLX visuals can be
-      disabled by adding:
-
-        Option "AddARGBGLXVisuals" "False"
-
-      to the X configuration file.
-
-    * Fixed a problem that caused DisplayPort devices to behave incorrectly when
-      DPMS power saving mode was triggered.
-
-    * Updated VDPAU to improve thread concurrency.  See the README for
-      details.
-
-    * Altered NVIDIA X driver behavior in the case that no display
-      devices are connected to the GPU.  Previously, in this case,
-      the NVIDIA X driver would pretend a CRT was connected to the GPU.
-      Now, the NVIDIA X driver will not automatically pretend that
-      any CRTs are connected.  If the X driver does not detect any
-      connected display devices, the X server will fail to start.
-
-      To restore the old behavior, use the ConnectedMonitor X
-      configuration option; e.g.,
-
-        Option "ConnectedMonitor" "CRT"
-
-      Alternatively, if display is not desired, Quadro and Tesla GPU
-      users can enable "NoScanout" mode, which bypasses any mode timing
-      validation or use of display devices; this is configured with:
-
-        Option "UseDisplayDevice" "none"
-
-    * Disabled software cursors when the driver is operating in "no scanout"
-      (UseDisplayDevice "none") mode.  The software cursor image is not visible
-      in remote desktop applications or screenshots anyway, so having software
-      cursor enabled was unnecessary.
-
-    * Changed glXSwapBuffers() behavior for a pixmap such that it is now a no-op
-      in the direct rendering case in order to match the indirect case and
-      comply with the GLX spec. Previously, calling glXSwapBuffers() on pixmaps
-      in the direct case would swap the pixmap's buffers if the pixmap was
-      double buffered.
-
-    * Modified the installation location and names of internal VDPAU libraries
-      to conform to conventions and Debian packaging guidelines. New versions
-      of libvdpau expect this layout. Compatibility with old versions of
-      libvdpau is maintained with symlinks.
-
-    * Fixed a bug that could cause errors in graphical applications run after a
-      previous application using VDPAU and OpenGL. This behaviour was observed
-      when running Gwenole Beauchesne's hwdecode-demos application.
-
-    * Modified vdpau.h to increment VDPAU_VERSION, to reflect the fact that
-      new features have been added in the past. Also, add the new define
-      VDPAU_INTERFACE_VERSION.
-
-    * Fixed a periodic temporary hang in the VDPAU blit-based presentation
-      queue.
-
-    * Fixed a problem that caused resolution limitations or corruption on
-      certain DisplayPort devices such as the Apple 24" Cinema display or some
-      DisplayPort to VGA adapters.
-
-    * Disabled the UseEvents option for GeForce 8 series and higher GPUs due to
-      a problem that causes occasional short hangs.  It will be re-enabled when
-      that bug has been tracked down and fixed.
-
-    * VDPAU now allows multiple streams to be decoded at once, without the
-      need to set any environment variables.
-
-======== Older Releases ========
-
-2009-10-21 version 190.42
-
-    * Fixed a bug in the nvidia-settings disclaimer window for the GPU
-      Clock Frequencies Coolbits page, such that the "Accept" button is
-      selectable when the desktop is so tall that the entire disclaimer
-      can be viewed without scrolling.
-
-    * Fixed a recent regression that caused the Xinerama option to not be set
-      properly in the X configuration file when saving and merging from the
-      nvidia-settings X Server Display Configuration page.
-
-    * Fixed a resource leak in VDPAU's blit-based presentation queue.
-      This bug limited the number of presentation queue objects that could be
-      created and destroyed in a single application instance, and hence could
-      limit the number of streams that could be displayed and/or the number
-      of iterations of "loop" playback.
-
-    * Fixed a power management regression that prevented some notebooks
-      and systems with integrated GeForce 8 and 9 series GPUs from
-      suspending.
-
-    * Fixed a regression that caused TV-OUT controls to be unavailable on
-      some GeForce 6 and 7 series GPUs.
-
-2009-10-16 version 190.40
-
-    * Added support for OpenGL 3.2.
-
-    * Added support for NVIDIA Quadro SDI Capture, part of the Quadro
-      Digital Video Pipeline.
-
-    * Added support for the following GPUs:
-
-        GeForce G102M 
-        GeForce GT 220 
-        GeForce G210 
-        GeForce G210M 
-        GeForce GT 230M 
-        GeForce GT 240M 
-        GeForce GTS 250M 
-        GeForce GTS 260M 
-
-    * Updated the NVIDIA X driver to allow, on GeForce 8 or greater GPUs,
-      more modes to validate on digital display devices whose EDIDs
-      report very constrained HorizSync or VertRefresh ranges.
-
-    * Fixed a randomly occurring X server crash caused by the PixmapCache
-      option.
-
-    * Increased the allowed amount of overscan compensation from 100 to 200.
-
-    * On GPUs with VDPAU feature set B, VDPAU's handling of some corrupted
-      or incorrectly formatted H.264 and MPEG streams has been improved.
-
-    * Fixed a memory allocation problem with pre-GeForce 8
-      GPUs that caused GLX_EXT_texture_from_pixmap clients (e.g., Compiz,
-      KDE 4) to display incorrect contents.
-
-2009-09-24 version 190.36
-
-    * Added support for X.Org xserver 1.6.99.901 (also known as 1.7.0 RC1).
-
-    * Add a new OverscanCompensation NV-CONTROL attribute, available on GeForce
-      8 and higher.  This option specifies the amount of overscan compensation
-      to apply to the current mode.  It is measured in raster pixels, i.e.
-      pixels as specified in the current mode's backend timings.
-
-    * Updated nvidia-installer to detect newer Debian distributions that use
-      /usr/lib32 instead of /emul/ia32-linux as the 32-bit library path.
-
-    * Added GLX support for OpenGL 3.2 context profiles through the extension
-      GLX_ARB_create_context_profile.
-
-2009-09-04 version 190.32
-
-    * Added support for IgnoreEDIDChecksum X configuration option, which can be
-      used to force the X driver to accept the EDID of a display device even
-      when the checksum is invalid. Please see the README IgnoreEDIDChecksum
-      description for a caution and details of use.
-    
-    * Added support for configuring the GPU's fan speed; see the
-      "Coolbits" X configuration option in the README.
-
-    * Fixed a bug in VDPAU that could cause visible corruption near the bottom
-      edge of the picture when decoding VC-1 simple/main profile clips whose
-      heights are not exact multiples of 16 pixels, on GPUs with VDPAU feature
-      set A.
-
-    * On GPUs with VDPAU feature set C, VDPAU now supports decoding MPEG-4
-      Part 2, DivX 4, and DivX 5 video. The VDPAU API has been enhanced to
-      expose this feature.
-
-    * On GPUs with VDPAU feature set C, VDPAU now supports a higher quality
-      video scaling algorithm. The VDPAU API has been enhanced to expose this
-      feature.
-
-2009-08-21 version 190.25
-
-    * Added code to reject screen modes based on available DisplayPort link
-      bandwidth.  Fixes display corruption caused by allowing high bandwidth
-      modes on display devices that can't handle them, such as certain
-      DisplayPort-to-VGA adapters that only support 2 DisplayPort lanes.
-
-    * Fixed an initialization problem on some mobile GPUs.
-
-    * Worked around X.Org X server Bugzilla bug #22804.  This bug
-      allows X clients to send invalid XGetImage requests to the
-      hardware, leading to screen corruption or hangs.  This was most
-      commonly triggered by running JDownloader in KDE 4.
-
-    * Fixed a crash in nvidia-settings displaying GPU information when in Xinerama.
-
-2009-07-23 version 190.18
-
-    * Added GLX protocol support (i.e., for GLX indirect rendering)
-      for the following OpenGL extensions:
-
-        GL_ARB_draw_buffers
-        GL_EXT_Cg_shader
-        GL_EXT_gpu_program_parameters
-        GL_NV_fragment_program
-        GL_NV_gpu_program4
-        GL_NV_register_combiners
-        GL_NV_vertex_program1_1
-        GL_NV_vertex_program2
-
-    * Added unofficial GLX protocol support (i.e., for GLX indirect
-      rendering) for the following OpenGL extensions:
-
-        GL_ARB_geometry_shader4
-        GL_ARB_shader_objects
-        GL_ARB_texture_buffer_object
-        GL_ARB_vertex_buffer_object
-        GL_ARB_vertex_shader
-        GL_EXT_bindable_uniform
-        GL_EXT_compiled_vertex_array
-        GL_EXT_geometry_shader4
-        GL_EXT_gpu_shader4
-        GL_EXT_texture_buffer_object
-        GL_NV_geometry_program4
-        GL_NV_vertex_program
-        GL_NV_parameter_buffer_object
-        GL_NV_vertex_program4
-
-      GLX protocol for GL_EXT_vertex_array was also updated to incorporate
-      rendering using GL_ARB_vertex_buffer_object.
-      Use of these extensions with GLX indirect rendering requires
-      the AllowUnofficialGLXProtocol X configuration option and the
-      __GL_ALLOW_UNOFFICIAL_PROTOCOL environment variable.
-
-    * Fixed glXQueryVersion to report GLX version 1.4.  NVIDIA's GLX
-      version has been 1.4 for several releases, and was already reported
-      as 1.4 in the GLX client and GLX server version strings.
-
-    * Fixed a problem that caused window border corruption when the screen is
-      rotated.
-
-    * Added support for configuring the GPU PowerMizer Mode on
-      GeForce 8 or later GPUs with multiple performance levels via
-      nvidia-settings and NV-CONTROL.
-
-2009-08-21 version 185.18.36
-
-    * Fixed a bug that caused kernel panics when starting X on some
-      mobile GPUs.
-
-    * Fixed an interaction problem between VDPAU and PowerMizer when using
-      VDPAU solely as a display mechanism, and not to decode video streams.
-      The GPU performance level should now be raised, if required, in this
-      scenario.
-
-    * Fixed VDPAU to avoid "display preemption" in some cases where a
-      VdpOutputSurface is deleted while it is still active (either queued or
-      visible) in a VdpPresentationQueue. In particular, this can occur in
-      MPlayer when using the "-fs" option, and could completely prevent
-      VDPAU from operating successfully, depending on the exact timing
-      conditions.
-
-2009-07-31 version 185.18.31
-
-    *  Fixed a crash on certain mobile GPUs.
-
-2009-07-28 version 185.18.29
-
-    * Fixed a bug that could cause occasional memory corruption problems or
-      segmentation faults when running OpenGL applications on Quadro GPUs.
-
-    * Fixed a deadlock in the OpenGL library that could be triggered in certain
-      rare circumstances on Quadro GPUs.
-
-    * Fixed the order of outputs in the GPUScaling nvidia-settings property.
-
-    * Fixed a bug that caused graphics corruption in some OpenGL applications
-      when the Unified Back Buffer is enabled the application window is moved.
-
-    * Fixed a bug that caused glXGetVideoSyncSGI, glXWaitVideoSyncSGI, and
-      glXGetRefreshRateSGI to operate on the wrong screen when there are
-      multiple X screens.
-
-    * Fixed a bug that causes corruption or GPU errors when an application
-      paints a redirected window whose background is set to ParentRelative on
-      X.Org servers older than 1.5.
-
-      This was typically triggered by running Kopete while using Compiz or
-      Beryl.
-
-    * Fixed a bug in VDPAU that could cause visible corruption when decoding
-      H.264 clips with alternating frame/field coded reference pictures, and
-      a video surface is concurrently removed from the DPB, and re-used as
-      the decode target, in a single decode operation. This affected all GPUs
-      supported by VDPAU.
-
-    * Fixed a bug in VDPAU that could cause visible corruption near the bottom
-      edge of the picture when decoding VC-1 advanced profile clips whose
-      heights are not exact multiples of 16 pixels, on G98 and MCP7x (IGP)
-      GPUs.
-
-    * Enhanced VDPAU to better handle corrupt/invalid H.264 bitstreams on
-      G84, G86, G92, G94, G96, or GT200 GPUs. This should prevent most cases
-      of "display preemption" that are caused by bitstream errors.
-
-    * Fixed an X server crash when using the VDPAU overlay-based presentation
-      queue and VT-switching away from the X server.
-
-    * Enhanced VDPAU's detection of the GPU's video decode capabilities.
-
-    * Fixed a bug in VDPAU that could cause ghosting/flashing issues when
-      decoding H.264 clips, in certain full DPB scenarios, on G98 and MCP7x.
-
-    * Fixed VDPAU to detect an attempt to destroy the VdpDevice object when
-      other device-owned objects still exist. VDPAU now triggers "display
-      preemption", and returns an error, when this occurs.
-
-    * Enhanced VDPAU's error handling and resource management in presentation
-      queue creation and operation. This change correctly propagates all
-      errors back to the client application, and avoids some resource leaks.
-
-   Linux specific changes:
-
-    * Added code to forcibly terminate long-running CUDA kernels when
-      Ctrl-C is pressed.
-
-    * Fixed an interaction problem between PowerMizer and CUDA applications that
-      caused the performance level to be reduced while the CUDA kernel is
-      running.
-
-    * Made CUDA compute-exclusive mode persistent across GPU resets.
-
-   FreeBSD specific changes:
-
-    * Fixed an installer problem that prevented Linux ABI compatibility from
-      working with newer versions of FreeBSD.
-
-2009-05-27 version 185.18.14
-
-    * Fixed a Xinerama drawable resource management problem that can cause
-      GLXBadDrawable errors in certain cases, such as when Wine applications are
-      run.
-
-    * Fixed XineramaQueryScreens to return 0 screens instead of 1 screen with
-      the geometry of screen 0 when XineramaIsActive returns false.  This
-      conforms to the Xinerama manual page and fixes an interaction problem with
-      Compiz when there is more than one X screen.
-
-    * Add support for the UseEvents X configuration option on GeForce 8 and
-      higher GPUs.
-
-    * Moved kernel module loading earlier in the X driver's initialization,
-      to facilitate more graceful fallbacks if the kernel module cannot
-      be loaded.  Removed the LoadKernelModule X configuration option.
-
-    * Added support for new horizontal interlaced and checkerboard passive
-      stereo modes.
-
-    * Fixed an OpenGL driver crash while running Bibble 5.
-
-    * Fixed a DisplayPort interaction problem with power management
-      suspend/resume events.
-
-    * Fixed occasional X driver memory management performance problems
-      when a composite manager is running.
-
-    * Fixed a bug with VT-switching or mode-switching while using Compiz;
-      the bug could lead to a corrupted desktop (e.g., a white screen)
-      or in the worst case an X server crash.
-
-    * Fixed a bug that could cause GPU errors in some cases while driving
-      Quadro SDI products.
-
-    * Fixed a several second hang when VT-switching while OpenGL stereo
-      applications were running on pre-G80 Quadro GPUs.
-
-    * Added support for multiple swap group members on G80 and later
-      Quadro GPUs.
-
-    * Fixed the behavior of the NV_CTRL_FRAMELOCK_SYNC_DELAY NV-CONTROL
-      attribute on Quadro G-Sync II.
-    
-    * Fixed a problem with Quadro SDI where transitioning from "clone
-      mode" to "OpenGL mode" would fail.
-
-    * Fixed VDPAU to eliminate some cases of corruption when decoding H.264
-      video containing field-coded reference frames on G84, G86, G92, G94,
-      G96, or GT200 GPUs. Such streams are commonly found in DVB broadcasts.
-
-    * Slightly improved the performance of the VDPAU noise reduction
-      algorithm.
-
-    * Enhanced VDPAU to validate whether overlay usage is supported by the
-      current hardware configuration, and to automatically fall back to the
-      blit-based presentation queue if required.
-
-    * Fixed error checking in VdpVideoMixerRender, to reject calls that
-      specify more layers than the VdpMixer was created with.
-
-    * Modified VDPAU's VDPAU_DEBUG code to emit a complete backtrace on all
-      platforms, not just on 32-bit Linux.
-
-    * Improved interaction between VDPAU and PowerMizer; appropriate
-      performance levels should now be chosen for video playback of all
-      standard resolutions on all supported GPUs.
-
-    * Fixed a bug in VDPAU that sometimes caused "display preemption" when the
-      VdpDecoderCreate function failed.
-
-    * Fixed a potential segfault in the VDPAU trace library, triggered by
-      a multi-threaded application creating a new VdpDevice in one thread,
-      at the same time that another thread detected "display preemption".
-
-  Linux specific changes:
-
-    * Improved compatibility with recent Linux kernels.
-
-  FreeBSD specific changes:
-
-    * Modified VDPAU to dlopen libpthread.so (on all platforms), to avoid
-      conflicts between the current libc and a compat libpthread.
-
-2009-04-06 version 185.19
-
-    * Added support for the following new GPUs:
-
-        Quadro FX 3800
-        Quadro FX 1800
-        Quadro FX 380
-        Quadro FX 580
-        GeForce GTS 250
-        GeForce GT 140
-        GeForce GT 130
-        GeForce 9600 GSO 512
-
-    * Fixed SDI presentation time queries returning unexpected values.
-
-    * Removed the 'AllowDFPStereo' X config file option, which is now enabled by
-      default.
-
-    * Fixed a bug that caused certain programs to hang when multiple threads
-      call functions in libdl at the same time.
-
-    * Fixed a driver crash when OpenGL applications use an extremely large
-      number of textures.
-
-    * Fixed GPU errors triggered by text rendering to PseudoColor windows with
-      the glyph cache enabled.
-
-    * Updated the X driver to allow pixmaps smaller than 32x32 pixels to be
-      placed in video memory.
-
-    * Fixed a problem that prevented the driver from retraining a DisplayPort
-      link after a device was hotplugged.
-
-    * Updated nvidia-bug-report.sh to automatically gzip the resulting log file.
-
-    * Fixed VDPAU to eliminate some cases of GPU hangs when decoding H.264
-      video on G84, G86, G92, G94, G96, or GT200 GPUs, and supplying a DPB
-      missing some reference frames.
-
-    * The VDPAU presentation queue now syncs to VBLANK in the blit
-      path. The environment variable VDPAU_NVIDIA_SYNC_DISPLAY_DEVICE
-      selects which display to sync to when TwinView is enabled;
-      see the README for details.
-
-    * On systems using integrated graphics, VDPAU now uses system RAM
-      instead of video RAM for many purposes. This should prevent "out
-      of resources" problems in most cases, even when the video RAM
-      carve-out is configured as low as 128M.
-
-    * Added support for Quad-Buffered Stereo in the main plane
-      simultaneously with the Color Index Overlay; i.e., both Stereo
-      GLX FBConfigs and Color Index Overlay FBConfigs can be advertised
-      and used at the same time, though no single GLX FBConfig contains
-      both Stereo and Overlay capabilities.
-
-2009-03-12 version 185.13
-
-    * Numerous internal cleanups and improvements to OpenGL. In particular,
-      GLX_EXT_texture_from_pixmap binding performance problems were resolved.
-
-2009-04-21 version 180.51
-
-    * Added support for the following GPUs:
-
-        GeForce 9600 GSO 512
-        GeForce 9400 GT
-        GeForce GTS 250 
-        GeForce GT 130  
-        GeForce GT 140  
-
-    * Fixed stability problems with some GeForce 6200/7200/7300 GPUs
-      on multi-core/SMP systems.
-
-    * Updated nvidia-bug-report.sh to compress its log file; running
-      `nvidia-bug-report.sh` now produces "nvidia-bug-report.log.gz".
-
-    * Addressed a problem that could lead to intermittent hangs
-      and system crashes on some GeForce 9 and later GPUs.
-
-    * Fixed an X server crash when viewing the website www.tim.it.
-
-    * Fixed a DisplayPort interaction problem with power management
-      suspend/resume events.
-
-    * Fixed rendering corruption in the OpenGL 16-bit RGB Workstation
-      Overlay.
-
-    * Fixed a recent VDPAU regression that caused aborted playback
-      and hangs when decoding some H.264 clips on G84, G86, G92, G94,
-      G96, and GT200 GPUs.
-
-    * Fixed an interaction problem that could corrupt the EDID of the
-      Fujitsu Technology Solutions Celsius H270 notebook's internal
-      flatpanel.
-
-    * Fixed occasional X driver memory management performance problems 
-      when a composite manager is running.
-
-    * Fixed a bug that could interfere with the detection of display
-      devices attached to secondary GPUs when first starting X
-      after cold boots.
-
-    * Fixed a problem that could result in temporary stalls when
-      moving OpenGL application windows on GeForce 8 and
-      later GPUs.
-
-    * Fixed a bug that prevented VGA fonts from being saved/restored
-      correctly on GeForce 8 and later GPUs.
-
-  Linux specific changes:
-
-    * Improved compatibility with recent Linux kernels.
-
-    * Reduced CPU usage of nvidia-smi utility for reporting Quadro Plex
-      information.
-
-    * Fixed compatibility problem with LandMark GeoProbe.
-
-  Solaris specific changes:
-
-    * Fixed Solaris installer to not install libnvidia-wfb.so when a wfb
-      library is already present.
-
-    * Fixed an initialization ordering bug that could lead to
-      kernel panics starting X on some integrated GPUs. 
-
-2009-03-30 version 180.44
-
-    * Added support for the following GPUs:
-
-        Quadro FX 3800
-        Quadro FX 3700M
-        Quadro FX 1800
-        Quadro FX 580
-        Quadro FX 380
-        Quadro NVS 295
-        GeForce GT 120
-        GeForce G100
-
-    * Fixed a problem that could cause Xid errors and display corruption
-      in certain cases when OpenGL is used to render to redirected windows,
-      for example when Java2D is used with the -Dsun.java2d.opengl=true
-      option.
-
-    * Updated glGetStringi(GL_EXTENSIONS, i) to no longer return NULL
-      in OpenGL 3.0 preview contexts.
-
-    * Fixed OpenGL crashes while running KDE4's Plasma.
-
-    * Fixed OpenGL crashes when using a large number of texture objects.
-
-    * Fixed the timestamp reporting in the GL_NV_present_video extension
-      on SDI II with Quadro FX 4800 and 5800.
-
-    * Improved power management support on some systems, such
-      as Hewlett-Packard xw4600 workstations.
-
-    * Fixed a problem that caused the screen to flicker momentarily when
-      OpenGL applications exit unexpectedly on GeForce 6 and 7 series GPUs.
-
-    * Fixed an X server crash when an X client attempts to draw trapezoids
-      and RenderAccel is disabled.
-
-    * Improved recovery from certain types of errors.
-
-    * Fixed a bug that caused Autodesk Maya to freeze when overlays
-      are enabled.
-
-    * Fixed an interaction problem between OpenGL and memory tracking
-      libraries such as MicroQuill SmartHeap.
-
-    * Added support for RG renderbuffers in OpenGL 3.0.
-
-    * Added support for OpenGL 3.0 floating-point depth buffers.
-
-    * Fixed a problem that caused Valgrind to crash when tracing a
-      program that uses OpenGL.
-
-    * Updated VDPAU to support VC-1/WMV acceleration on all GPUs supported
-      by VDPAU; see the README for details.
-
-    * Fixed VDPAU corruption on some H.264 clips.
-
-    * Updated VDPAU documentation in the README and in vdpau.h,
-      in particular regarding how to use the deinterlacing algorithms
-      in the VdpVideoMixer object.  Explicitly documented "half rate"
-      deinterlacing, which should allow the advanced algorithms to run
-      on more low-end systems.
-
-    * Implemented a "skip chroma deinterlace" option in VDPAU,
-      which should allow the advanced deinterlacing algorithms to run
-      on more low-end systems. See vdpau.h.
-
-    * Fixed VDPAU VC-1 decoding on 64-bit platforms.
-
-    * Updated the VDPAU wrapper library to print dlerror() messages
-      when driver loading problems occur.
-
-    * Improved VDPAU's handling of some corrupt H.264 streams, and some
-      corrupt/invalid MPEG streams on some GPUs.
-
-    * Fixed VDPAU to correctly handle WMV "range reduction" on
-      some GPUs. A minor backwards-compatible API change was made
-      for this; see vdpau.h's documentation for structure field
-      VdpPictureInfoVC1.rangered.
-
-    * Fixed a problem that caused surfaces to be marked as visible
-      too early when the blit presentation queue is in use.
-
-    * Fixed VDPAU to prevent some cases of "display preemption"
-      in the face of missing H.264 reference frames on some GPUs.
-
-    * Fixed corruption decoding H.264 clips with pictures where
-      pic_order_cnt_type implies log2_max_pic_order_cnt_lsb_minus4 is
-      not used, on G84, G86, G92, G94, G96, GT200 GPUs.
-
-    * Update vdpau.h to document exact requirements for VdpDecoderRender
-      bitstream data content.
-
-    * Fix VDPAU error handling in some unusual low memory situations.
-
-    * Fix hang in VDPAU in some cases of output mode timing changes.
-
-    * Fixed a bug where setting SLI to "auto" in the X configuration
-      file would disable SLI.
-
-2009-02-11 version 180.29
-
-    * Added support for the following GPUs:
-
-        GeForce GTX 295
-        GeForce GTX 285
-        GeForce 9300 GE
-        Quadro NVS 420
-
-    * Added support for OpenGL 3.0 for GeForce 8 series and newer GPUs.
-
-    * Fixed a bug that caused VDPAU to display a green screen when
-      using the overlay-based presentation queue with interlaced
-      modes.
-
-    * Fixed a bug that prevented VDPAU from working correctly
-      after X server restarts on some GPUs.
-
-    * Improved VDPAU's handling of mode switches; eliminated a crash
-      in its mode switch recovery code and a hang in the
-      blit-based presentation queue.
-
-    * Fixed a bug that caused VDPAU to crash when using DisplayPort
-      devices.
-
-    * Fixed a potential hang in VDPAU when using the blit-based
-      presentation queue on systems with multiple GPUs not
-      in SLI mode.
-
-    * Implemented missing error checking of layer data in VDPAU's
-      VdpVideoMixerRender function.
-
-    * Improved VDPAU's handling of setups with multiple GPUs, if
-      a subset of the GPUs cannot be supported due to
-      resource limitations.
-
-    * Improved GPU video memory management coordination between the
-      NVIDIA X driver and VDPAU.
-
-    * Fix potential hang in VDPAU when the overlay is already in use.
-
-    * Improved workstation OpenGL performance.
-
-    * Fixed an X driver acceleration bug that resulted in Xid errors
-      on GeForce 6 and 7 series GPUs.
-
-    * Updated the X driver to consider GPUs it does not recognize
-      supported, allowing it to drive some GPUs it previously
-      ignored.
-
-    * Added the ability to run distribution provided pre- and post-
-      installation hooks to 'nvidia-installer'; please see the
-      'nvidia-installer' manual page for details.
-
-    * Updated the X driver's metamode parser to allow mode names
-      with periods (i.e. '.'s).
-
-    * Fixed a problem in VDPAU that prevented the overlay-based
-      presentation queue from being used on displays connected by component
-      video.
-
-    * Fixed various problems in VDPAU that caused visual corruption when
-      decoding certain MPEG-2 video streams.
-
-    * Fixed a crash in VDPAU caused by certain invalid MPEG-2 streams,
-      in 64-bit drivers for some GPUs.
-
-    * Fixed an X driver performance problem on integrated GPUs.
-
-    * Fixed a stability problem with OpenGL applications using FSAA.
-
-    * Fixed an initialization problem that caused some AGP
-      GPUs to be used in PCI compatibility mode.
-
-    * Fixed a bug that could result in stability problems
-      after changing clock settings via the Coolbits
-      interface.
-
-  Linux specific changes:
-
-    * Fixed a problem with hotkey switching on some recent
-      mobile GPUs.
-
-    * Worked around a power management regression in and improved
-      compatibility with recent Linux 2.6 kernels.
-
-2009-01-08 version 180.22
-
-    * Added support for the following GPUs:
-
-        Quadro FX 2700M
-        GeForce 9400M G
-        GeForce 9400M
-        GeForce 9800 GT
-        GeForce 9800 GT
-        GeForce 8200M G
-        GeForce Go 7700
-        GeForce 9800M GTX
-        GeForce 9800M GT
-        GeForce 9800M GS
-        GeForce 9500 GT
-        GeForce 9700M GT
-        GeForce 9650M GT
-        GeForce 9500 GT
-
-    * Added initial support for PureVideo-like features via the new
-      VDPAU API (see the vdpau.h header file installed with the driver).
-
-    * Added support for CUDA 2.1.
-
-    * Added preliminary support for OpenGL 3.0.
-
-    * Added new OpenGL workstation performance optimizations.
-
-    * Enabled the glyph cache by default and extended its support to 
-      all supported GPUs.
-
-    * Disabled shared memory X pixmaps by default; see
-      the "AllowSHMPixmaps" option.
-
-    * Improved X pixmap placement on GeForce 8 series and later GPUs.
-
-    * Improved stability on some GeForce 8 series and newer GPUs.
-
-    * Fixed a regression that could result in window decoration corruption
-      when running Compiz using Geforce 6 and 7 series GPUs.
-
-    * Fixed an nvidia-settings crash when xorg.conf contains Device
-      and Screen sections but no ServerLayout section.
-
-    * Fixed a problem parsing the monitor sync range X config file
-      options.
-
-    * Fixed a problem with the SDI sync skew controls in
-      nvidia-settings.
-
-    * Fixed a problem that caused some SDI applications to hang or
-      crash.
-
-    * Added support for SDI full-range color.
-
-  Linux specific changes:
-
-    * Improved compatibility with recent Linux kernels.
-
-  FreeBSD specific changes:
-
-    * Fixed a problem that caused the Linux OpenGL library to crash
-      when used inside FreeBSD's Linux emulation layer.
-
-2008-11-12 version 177.82
-
-    * Added support for the following new GPUs:
-        Quadro NVS 450
-        Quadro FX 370 LP
-        Quadro FX 5800
-        Quadro FX 4800
-        Quadro FX 470
-        Quadro CX
-
-    * Fixed a problem on recent mobile GPUs that caused a power management
-      resume from S3 to take 30+ seconds.
-
-    * Fixed an image corruption issue seen in FireFox 3.
-
-  Linux specific changes:
-
-    * Fixed a problem with hotkey switching on some recent mobile GPUs.
-
-2008-10-07 version 177.80
-
-    * Added support for the following new GPUs:
-
-        GeForce GTX 260
-        GeForce GTX 280
-        GeForce 9800 GTX+
-        GeForce 9800 GT
-        GeForce 9700M GTS
-        GeForce 9500 GT
-        GeForce 8100P
-        nForce 780a SLI
-        nForce 750a SLI
-        Quadro FX 770M
-        Quadro NVS 160M
-        Quadro NVS 150M
-
-    * Improved support for RENDER masks, as well as RENDER repeating
-      modes and transformations, for video memory pixmaps.
-
-    * Added accelerated support for RENDER convolution filters for
-      video memory pixmaps on GeForce 8, 9 and GTX GPUs.
-
-    * Improved support for RENDER operations with the same source
-      and destination; this should performance in some
-      situations, e.g. when dragging Plasma applets in KDE4.
-
-    * Improved GPU video memory management coordination between the
-      NVIDIA X driver and OpenGL implementation; this should
-      improve performance with e.g. the KDE4 OpenGL compositing
-      manager.
-
-    * Added an 'AllowSHMPixmaps' X configuration option, which can
-      be used to prevent applications from using shared memory
-      pixmaps; the latter may cause some optimizations in the NVIDIA
-      X driver to be disabled.
-
-    * Fixed a text rendering performance regression that affected
-      GeForce 6 and 7 series GPUs.
-
-    * Fixed a regression that caused the 'Auto' SLI X option
-      setting to not enable SLI.
-
-    * Fixed a bug that caused system hangs when using the NV-CONTROL
-      interface to change GPU clock frequencies.
-
-    * Added support for DisplayPort display devices (including
-      30-bit devices).
-
-    * Resolved various stability problems on GeForce 8, 9 and GTX
-      GPUs, as well as some GeForce 6 and 7 PCI-E GPUs.
-
-    * Fixed a bug that resulted in GPU errors when changing the
-      TwinView display configuration while using Compiz.
-
-    * Further improved the error recovery paths taken in case of GPU
-      command stream corruption.
-
-    * Updated mode validation, in cases when no EDID is detected,
-      such that 1024x768 @ 60Hz and 800x600 @ 60Hz are
-      allowed, rather than just 640x480 @ 60Hz.
-
-    * Removed an old workaround that caused incorrect Xinerama
-      information to be reported after enabling a second
-      TwinView display.
-
-    * Fixed corruption when using SLI in SFR mode with
-      OpenGL-based composite managers.
-
-    * Fixed the subpicture component order reported by the NVIDIA
-      X driver's XvMC implementation.
-
-    * Added a workaround for broken EDIDs provided by some Acer
-      AL1512 monitors.
-
-    * Fixed a bug that caused GLXBadDrawable errors to be generated
-      when running more than one OpenGL application with
-      anti-aliasing enabled on GeForce 6 and 7 GPUs, e.g. wine.
-
-  Linux specific changes:
-
-    * Fixed a problem that could result in IRQs being disabled
-      on some multi-GPU SMP configurations.
-
-    * Worked around cache flushing problems (on some Linux kernels)
-      that caused corruption and stability problems.
-
-    * Added experimental support for PCI-E MSI.
-
-    * Updated the X driver to consider /sys/class/power_supply
-      when determining the AC power state.
-
-    * Fixed a bug that resulted in AGP FW/SBA settings and overrides
-      being applied incorrectly when using the Linux kernel's
-      AGP GART driver.
-
-    * Improved compatibility with recent Linux 2.6 kernels.
-
-  Solaris specific changes:
-
-    * Fixed a bug that caused intermittent kernel panics when stress
-      testing attach/detach paths.
-
-  FreeBSD specific changes:
-
-    * Fixed a bug that caused the kernel module to fail building
-      against some FreeBSD kernels.
-
-    * Fixed a bug that caused the kernel module to fail building
-      with FreeBSD AGPGART support enabled.
-
-    * Resolved an event-handling bug in the X driver responsible for
-      X server crashes upon starting a windowed OpenGL
-      application while using Compiz.
-
-2008-07-30 version 173.14.12
-
-    * Added support for GeForce 8600 GS.
-
-    * Fixed a problem with missing rendering in OpenGL Workstation
-      Overlays.
-
-    * Fixed a problem with running some SDL applications and virtual
-      terminal switching.
-
-    * Fixed a potential crash in nvidia-settings when saving to the X
-      configuration file.
-
-    * Improved error recovery paths in the case of corruption of the
-      commands sent to the GPU.
-
-2008-06-11 version 173.14.09
-
-    * Fixed aliased font rendering corruption on X.Org server 1.5.
-
-    * Fixed a display corruption problem driving two dual-link
-      DFPs with Quadro FX 1700 GPUs.
-
-    * Fixed a regression that prevented the X driver from starting
-      on some GeForce FX, 6 and 7 mobile GPUs.
-
-    * Fixed a locale-interaction issue in the nvidia-settings
-      NV-CONTROL protocol parser.
-
-  Linux specific changes:
-
-    * Added preliminary support for Linux 2.6.26.
-
-  FreeBSD specific changes:
-
-    * Fixed a problem that caused a memory leak when some OpenGL
-      applications are syncing to vblank.
-
-2008-05-28 version 173.14.05
-
-    * Added support for the following new GPUs:
-
-        Quadro FX 3600M
-        GeForce 9800 GX2
-        GeForce 9800 GTX
-        GeForce 9600 GT
-        GeForce 9600 GSO
-        GeForce 9600 GS
-        GeForce 9500M GS
-        GeForce 8400
-        GeForce 8400 GS
-
-    * Added support for Quadro FX 5600/4600 SDI and Quadro
-      G-Sync II.
-
-    * Resolved a bug causing left and right eyes to be reversed
-      in stereo mode on some Quadro FX GPUs.
-
-    * Fixed a problem that caused OpenGL to stop rendering to
-      windows with origins at or beyond 4096 pixels (horizontally)
-      on GeForce 8 and 9 GPUs.
-
-    * Fixed a bug causing some Quadro FX 4500 SDI configurations
-      to take a long time to achieve synchronization.
-
-    * Added preliminary support for X.Org server 1.5.
-
-    * Addressed a problem causing visual corruption when using
-      GeForce 8 GPUs to drive Chi Mei 56" displays.
-
-    * Addressed visual corruption when driving Cintiq 20WSX wide
-      format tables with some GeForce 6 and 7 GPUs.
-
-    * Fixed OpenGL rendering corruption with textures compressed
-      using the DXT5 compression algorithm.
-
-    * Fixed a regression that caused invalid EDIDs to be detected
-      for the internal display device on some notebooks.
-
-    * Improved hotkey switching and power management support on
-      some GeForce 8 notebooks.
-
-    * Fixed a regression causing some GeForce 6100/6150 systems to
-      fail to restore the screen after DPMS cycles.
-
-    * Fixed a bug that prevented the console from being restored
-      correctly in SLI mode on GeForce 6 and 7 GPUs.
-
-    * Fixed interlaced modes on GeForce 8 GPUs.
-
-    * Fixed a problem that caused the synchronization signal
-      polarity to always be positive for DVI devices on
-      GeForce 8 and 9 GPUs.
-
-    * Resolved a problem resulting in X startup to fail on some
-      GeForce 8 and 9 systems without swap space.
-
-    * Fixed a bug resulting in X crashes when using GeForce 8
-      and 9 GPUs in SLI to drive X screens at depth 8.
-
-    * Fixed a problem that caused TV output on secondary TVs to be
-      black and white on some GPUs.
-
-  Linux specific changes:
-
-    * Restored compatibility with recent Linux 2.6 kernels.
-
-  Solaris specific changes:
-
-    * Fixed a bug that could result in kernel panics on SMP systems.
-
-    * Fixed a problem causing multi-threaded JOGL applications to
-      hang on exit.
-
-  FreeBSD specific changes:
-
-    * Resolved a bug that could cause the X driver to crash in
-      various out-of-IPC-resource scenarios; documented common IPC
-      resource related problems in the README.
-
-    * Added initial support for FreeBSD 7.0-RELEASE.
-
-2008-02-26 version 169.12
-
-    * Improved power management support with GeForce 8 GPUs.
-
-    * Further improved stability on some GeForce 8 GPUs.
-
-    * Fixed a bug that broke certain TwinView configurations with
-      TV-OUT on GeForce 8 GPUs.
-
-    * Fixed a bug that could cause OpenGL to crash in certain cases,
-      e.g. when running Counter-Strike under Wine.
-
-    * Further improved GLX_EXT_texture_from_pixmap out-of-memory
-      handling.
-
-    * Fixed a bug that could result in incorrect PowerMizer state
-      being reported.
-
-    * Improved nvidia-xconfig behavior when updating X configuration
-      files without a "Module" section.
-
-    * Worked around a problem that caused function key presses on
-      some Toshiba notebooks to result in system crashes.
-
-  Solaris specific changes:
-
-    * Fixed a bug that caused intermittent kernel panics when stress
-      testing setup/teardown paths.
-
-    * Fixed a problem that could result in X driver crashes when
-      trying to change resolutions with XRandR.
-
-2008-01-21 version 169.09
-
-    * Fixed a problem causing the fan on some GPUs to always run at
-      full speed.
-
-    * Fixed a bug that could lead to X crashes using Paraview's
-      "Save Animation" dialog.
-
-    * Fixed a bug that caused the X driver to crash if the X.Org GLX
-      extension module was loaded instead of NVIDIA's.
-
-    * Improved the X driver's awareness of the current notebook
-      docking status.
-
-    * Fixed brightness control on HP Compaq notebooks.
-
-    * Fixed a bug in the Linux/i2c algorithm driver implementation
-      that prevented core transfer types from succeeding.
-
-2007-12-20 version 169.07
-
-    * Added support for GeForce 8800 GTS 512 and GeForce 8800M.
-
-    * Added CUDA driver to .run file.
-
-    * Fixed several X rendering issues.
-
-    * Fixed problems scrolling ARGB X drawables in Qt.
-
-    * Improved support for interlaced DVI, HDMI, and HDTV modesetting.
-
-2007-11-16 version 169.04
-
-    * Improved glXWaitVideoSyncSGI() latency by using a method asynchronous to
-      graphics commands.  Applications using glXWaitVideoSyncSGI() to
-      synchronize graphics rendering to monitor frame rate will need to
-      call glFinish() before glXWaitVideoSyncSGI().
-
-2007-10-18 version 100.14.19
-
-    * Added support for the GeForce 8800 GT.
-
-    * Improved modesetting support on Quadro/GeForce G8x GPUs.
-
-    * Fixed stability problems with some GeForce 8 GPUs.
-
-    * Fixed stability problems with some GeForce 6200/7200/7300 GPUs
-      on multi-core/SMP systems.
-
-    * Improved hotkey switching support for some Lenovo notebooks.
-
-    * Fixed a problem with Compiz after VT-switching.
-
-    * Improved RENDER performance.
-
-    * Improved interaction with Barco and Chi Mei 56" DFPs, as well
-      as with some Gateway 19" DFPs.
-
-    * Added an interface to monitor PowerMizer state information.
-
-    * Fixed rendering corruption in Maya's Graph Editor.
-
-    * Improved interaction between AFR SLI and swap groups on certain
-      Quadro FX GPUs.
-
-    * Fixed a bug that caused corruption with redirected XV on
-      GPUs without TurboCache support.
-
-    * Improved display device detection on GeForce 8 GPUs.  
-
-    * Improved nvidia-settings usability at lower resolutions like
-      1024x768 and 800x600.
-
-    * Improved GLX visual consolidation when using Xinerama with
-      Quadro/GeForce G8x and older GPUs.
-
-    * Added experimental support for running the X server at Depth 30
-      (10 bits per component) on Quadro G8x and later GPUs.
-
-  Linux specific changes:
-
-    * Worked around a Linux kernel/toolchain bug that caused soft
-      lockup errors when suspending on some Intel systems.
-
-  Solaris specific changes:
-
-    * Fixed a bug that prevented stereo from being enabled properly 
-      on some Quadro FX GPUs.
-
-  FreeBSD specific changes:
-
-    * Fixed a problem that could cause crashes on SMP systems.
-
-2007-09-18 version 100.14.19
-
-    * Added support for new GPUs:
-
-        Quadro NVS 290
-        Quadro FX 370
-        Quadro FX 570
-        Quadro FX 1700
-
-    * Improved GLX_EXT_texture_from_pixmap out-of-memory handling.
-
-    * Fixed a performance regression on GeForce 8 GPUs.
-
-    * Added support for a 'NoScanout' mode to the X driver, useful for
-      high performance computing environments and remote graphics; please
-      see the 'UseDisplayDevice' option description for details.
-
-    * Improved power management support with GeForce 8 and older GPUs.
-
-    * Improved compatibility with recent X.Org X servers.
-
-    * Improved G-Sync support with Quadro FX 4600 and Quadro FX 5600.
-
-    * Added XV brightness and contrast controls to the GeForce 8
-      video texture adapter implementation.
-
-    * Further improved interaction with ATi RS480/482 based mainboards.
-
-    * Fixed stability problems with some GeForce 8 GPUs.
-
-    * Fixed XvMC support on GeForce 7050 PV / NVIDIA nForce 630a GPUs
-      with PureVideo support.
-
-    * Added support for bridgeless SLI with GeForce 8 GPUs.
-
-    * Fixed rotation support on some GeForce 8 GPUs.
-
-    * Fixed a problem causing X to render incorrectly after VT switches
-      with composited desktops.
-
-    * Fixed a RENDER acceleration bug that was causing 2D rendering
-      corruption in Eclipse with GeForce 8 GPUs.
-
-    * Improved VGA console restoration with DFPs and TVs.
-
-    * Fixed a bug that resulted in the generation of incorrect EDIDs
-      on some notebooks.
-
-    * Fixed flickering corruption with SLIAA on GeForce 8 GPUs.
-
-  Linux specific changes:
-
-    * Improved compatibility with recent Linux 2.6 kernels.
-
-    * Fixed a compatibility problem with some Linux 2.4 kernels.
-
-    * Improved hotkey switching support.
-
-    * Fixed an 'nvidia-installer' bug that was causing the installer
-      to treat some of its temporary files as conflicting.
-
-    * Fixed several problems causing crashes if /dev is mounted
-      with the 'noexec' option.
-
-    * Reduced kernel virtual memory usage with some GeForce 8 GPUs.
-
-  FreeBSD specific changes:
-
-    * Fixed installation problems on systems with modular X.Org
-      X servers.
-
-    * Fixed X driver event delivery problems interfering with event
-      driven features like DamageEvents.
-
-  Solaris specific changes:
-
-    * Fixed a bug that occasionally caused crashes at kernel module
-      unload time.
-
-2007-06-21 version 100.14.11
-
-    * Added support for new GPUs:
-
-        GeForce 7050 PV / NVIDIA nForce 630a
-        GeForce 7025 / NVIDIA nForce 630a
-
-    * Fixed console restore problems in several different configurations:
-
-        Quadro FX 4400 SLI
-        VESA console
-        Notebook LCD displays
-
-    * Improved interaction with ATi RS480/482 based mainboards.
-
-    * Improved support for House Sync with G-Sync II.
-
-    * Improved NVIDIA X driver interaction with ACPI daemon.
-
-2007-06-08 version 100.14.09
-
-    * Added support for new GPUs:
-
-        GeForce 8600 GTS
-        GeForce 8600 GT
-        GeForce 8600M GT
-        GeForce 8600M GS
-        GeForce 8500 GT
-        GeForce 8400 GS
-        GeForce 8400M GT
-        GeForce 8400M GS
-        GeForce 8400M G
-        GeForce 8300 GS
-        Quadro FX 1600M
-        Quadro FX 570M
-        Quadro FX 360M
-        Quadro NVS 320M
-        Quadro NVS 140M
-        Quadro NVS 135M
-        Quadro NVS 130M
-
-    * Added support for G-Sync with Quadro FX 4600 and Quadro FX 5600.
-
-    * Improved Notebook support. 
-
-    * Improved RenderAccel support for subpixel antialiased fonts.
-
-    * Added XV brightness and contrast controls for GeForce 8 GPUs.
-
-    * Improved interaction with newer Linux kernels.
-
-    * Fixed a locale-interaction issue in the nvidia-settings
-      configuration file parser.
-
-2007-03-07 version 1.0-9755
-
-    * Added support for Quadro FX 4600 and Quadro FX 5600.
-
-    * Added support for SLI with GeForce 8800, Quadro FX 4600,
-      and Quadro FX 5600.
-
-2006-12-21 version 1.0-9746
-
-    * Added support for GeForce 8800 GTX and GeForce 8800 GTS GPUs.
-
-2006-12-04 version 1.0-9631
-
-    * Fixed an OpenGL crash on some GeForce 3 and GeForce 4 GPUs.
-
-    * Fixed an X server crash starting some fullscreen OpenGL games.
-
-    * Improved interaction with newer Linux kernels.
-
-2006-11-07 version 1.0-9629
-
-    * Added initial support for GLX_EXT_texture_from_pixmap.
-
-    * Added new "Display Configuration" page in nvidia-settings.
-
-    * Improved workstation OpenGL performance in Xinerama.
-
-    * Added support for NVIDIA Quadro Plex.
-
-    * Added support for Quad SLI.
-
-    * Improved X driver error recovery.
-
-    * Improved workstation overlay performance.
-
-    * Added SMBus functionality to the Linux/i2c interface.
-
-    * Fixed DFP scaling support.
-
-    * Added support for OpenGL 2.1.
-
-    * Added new "TwinViewXineramaInfoOrder" X configuration option to
-      control the order of display devices when in TwinView.
-
-    * Fixed some problems related to TV Out.
-
-    * Added new NVIDIA logo artwork to nvidia-settings and X driver
-      splashscreen; the X driver splashscreen can now be configured
-      with the new "LogoPath" X configuration option.
-
-2006-10-19 version 1.0-8776
-
-    * Fixed Security Advisory R7-0025.
-
-2006-08-24 version 1.0-8774
-
-    * Added support for X.Org 7.1.
-
-    * Added support for XVideo with the Composite X extension when
-      using X.Org 7.1.
-
-    * Improved interaction with newer Linux kernels.
-
-2006-05-22 version 1.0-8762
-
-    * Added support for new GPUs, such as QuadroFX 4500 X2, Quadro FX
-      5500, Quadro FX 3500, and Quadro FX 1500.
-
-    * Improved Quadro FX 3450/4000 SDI support.
-
-    * Fixed video memory reporting with GeForce 6200 Turbo Cache.
-
-    * Fixed a problem with Overlay support when in TwinView.
-
-    * Fixed problems starting X with SLI Frame Rendering on nForce 4
-      SLI Intel Edition.
-
-    * Fixed multiple issues with combinations of Stereo, SLI,
-      FrameRendering and G-Sync.
-
-    * Fixed several issues with mode selection for CRTs and DFPs.
-
-    * Fixed a corruption problem with Rotation and large desktops on
-      older GPUs, including GeForce4 MX.
-
-    * Fixed a system crash starting X with TwinView on certain GPUs.
-
-    * Addressed an NV-CONTROL compatibility issue; please see the Known
-      Issues section of the README for details.
-
-2006-04-07 version 1.0-8756
-
-    * Added support for GeForce 7300, GeForce 7400, GeForce 7600 and
-      GeForce 7900.
-
-    * Added support for running OpenGL applications while the
-      Composite X extension is enabled; see "The X Composite Extension"
-      appendix for details.
-
-    * Enabled hardware acceleration of the Render X extension by default.
-
-    * Added "AddARGBGLXVisuals" X configuration option, so that OpenGL
-      applications can render to X Windows' alpha channel.
-
-    * Added Linux/i2c support to the NVIDIA kernel module; see the "i2c
-      Bus Support" appendix for details.
-
-    * Improved power management support with Linux >= 2.6.14 and
-      added support for suspend-to-disk.
-
-    * Added new "nvidia-auto-select" mode entry for use in the X
-      configuration file; see description in the "Programming Modes"
-      appendix.
-
-    * Added support for GLX 1.4.
-
-    * Added ability for OpenGL applications to span greater than
-      4096 pixels when in Xinerama.
-
-    * Improved G-Sync support.
-
-    * Fixed interlaced modes on CRTs.
-
-    * Improved compatibility with the latest Linux 2.6 kernels.
-
-2005-12-22 version 1.0-8178
-
-    * Fixed a problem where certain precompiled kernel interfaces were
-      not recognized.
-
-    * Improved stability with the Composite X extension.
-
-    * Fixed a corruption bug with RenderAccel and the Composite X
-      extension when using wide desktops.
-
-    * Fixed a problem validating HDTV modes on GeForce 6200.
-
-    * Fixed detection of certain older TV encoders.
-
-    * Fixed installation problems with Linux kernel source trees
-      using separate KBUILD output directories.
-
-    * Fixed installation problems on newer Debian systems.
-
-2005-12-05 version 1.0-8174
-
-    * Added support for SLI FrameRendering.  Please see the README
-      for details.
-
-    * Added support for new GPUs such as the GeForce 6100 and GeForce 6150.
-
-    * Added a new utility 'nvidia-xconfig', which is a commandline
-      tool for updating X configuration files.
-
-    * Added manpages for 'nvidia-xconfig', 'nvidia-settings', and
-      'nvidia-installer'.
-
-    * Improved workstation OpenGL performance on Solaris.
-
-    * Made UseEdidFreqs "on" by default; the NVIDIA X driver will
-      use the valid HorizSync and VertRefresh frequency ranges from the
-      EDID whenever possible.
-
-    * Added support for Stereo Digital Flat Panels such as the SeeReal
-      and Sharp3D DFPs.
-
-    * Added HTML version of the README.
-
-    * Added support for static Rotation; see the "Rotate" X config option
-      in the README.
-
-    * Improved stability on 64-bit Linux 2.6 kernels.
-
-    * Fixed driver installation when SELinux is enabled.
-
-2005-08-02 version 1.0-7676
-
-    * Improved GeForce 7800 GTX performance.
-
-2005-06-22 version 1.0-7667
-
-    * Added support for GeForce 7800 GTX.
-
-    * Fixed problem with certain flatpanels running at 1600x1200.
-
-    * Fixed an unresolved symbol issue in libXvMCNVIDIA.so.
-
-    * Fixed an unresolved reference to the symbol "gnu_dev_makedev".
-
-    * Worked around a bug in Java2D that was exposed in 1.0-7664.
-
-    * Improved support for Quadro FX 4000 SDI.
-
-2005-06-01 version 1.0-7664
-
-    * Install NVIDIA OpenGL headers by default.
-
-    * Fixed performance problem when using AGPGART.
-
-    * Fixed support for GeForce2 Integrated GPUs.
-
-    * Fixed a workstation graphics stability problem.
-
-    * Improved XRandR rotation support.
-
-    * Fixed installation problems on some Linux 2.6 kernels.
-
-2005-03-11 version 1.0-7167
-
-    * Improved OpenGL workstation performance.
-
-    * Added support for XRandR rotation; see Appendix W in the text README.
-
-    * Added ExactModeTimingsDVI X config option to give explicit control
-      over the mode timings used on FlatPanels.
-
-    * Added X.Org dlloader support.
-
-    * Changed driver behavior such that PAT (Page Attribute Table)
-      is used where possible instead of MTRRs.
-
-    * Added a workaround for an X server bug with PCI-E GeForce 6800
-      and GeForce 6600; a fix has been provided to XFree86 and X.Org.
-
-    * Fixed stability problems on x86_64 PCI-E systems.
-
-    * Documented change_page_attr problems with x86_64 2.6 kernels;
-      please see the known issue "The X86-64 platform (AMD64/EM64T)
-      and 2.6 kernels" in the text README here:
-
-        /usr/share/doc/NVIDIA_GLX-1.0/README
-
-    * Fixed 2D rendering corruption on certain older GPUs.
-
-    * Improved compatibility with Linux 2.6 kernels.
-
-    * Fixed compatibility problems with some SWIOTLB em64t systems.
-
-    * Fixed a bug that triggered error messages of the form:
-
-        "ioctl32(doom.x86:6747): Unknown cmd fd(16) cmd(c0384642){00}
-            arg(ffffc75c) on /dev/nvidiactl"
-
-    * Fixed NvAGP incompatibility with recent Linux 2.6 kernels.
-
-    * Improved interaction with the udev filesystem.
-
-    * Improved performance of PCI cards on Linux 2.6 systems.
-
-    * Support for TurboCache GPUs.
-
-2004-11-5 version 1.0-6629
-
-    * Added support for GeForce 6600 and GeForce 6600 GT.
-
-    * Added support for Quadro FX 4000 SDI
-
-    * Added support for 512 MB framebuffers.
-
-    * Improved support for GLSL (OpenGL Shading Language).
-
-    * Improved performance for VBO (OpenGL Vertex Buffer Objects).
-
-    * Improved support for Linux 2.6 kernels.
-
-    * Improved support for PCI Express.
-
-    * Reduced virtual address space consumption in OpenGL applications.
-
-    * Updated documentation.  Please see the file
-
-        /usr/share/doc/NVIDIA_GLX-1.0/README
-
-      There are new known issues on EM64T and multithreaded
-      application stability as well as new appendices:
-
-        (app-s)  APPENDIX S: POWER MANAGEMENT SUPPORT
-        (app-t)  APPENDIX T: DISPLAY DEVICE NAMES
-        (app-u)  APPENDIX U: THE COMPOSITE X EXTENSION
-
-    * Improved support for EM64T Linux/x86-64 systems
-
-    * Improved support for RenderAccell
-
-    * Improved performance for Java2D.
-
-2004-8-5 version 1.0-6111
-
-  * Fixed SoftImage certification issues.
-
-    * Made the the "Do you really want to quit?" dialog in nvidia-settings
-      optional (via the nvidia-settings Configuration page).
-
-    * Fixed problem that prevented multiple simultaneous X servers
-      from running on TNT/TNT2.
-
-    * Fixed problem that caused TV-Out modes other than 640x480 and
-      800x600 to be unavailable.
-
-    * Fixed problem that caused cursor misplacement/corruption in
-      certain TwinView configurations.
-
-    * Fixed problem that caused some AGP kernel module options to
-      be ignored.
-
-    * Fixed problem in GLSL with shadow2DProj.
-
-    * Fixed console restore problems on GeForce4 Ti.
-
-2004-6-30 version 1.0-6106
-
-    * Added support for GLSL (OpenGL Shading Language).
-
-    * Added support for GL_EXT_pixel_buffer_object.
-
-    * Added support for 4kstack kernels.
-
-    * Added configuration utility "nvidia-settings"; see the user guide
-      installed here:
-
-        /usr/share/doc/NVIDIA_GLX-1.0/nvidia-settings-user-guide.txt
-
-      for details.
-
-    * Added support for running 32bit OpenGL applications on 64bit AMD64
-      Linux installations.
-
-    * Fixed problem that prevented 32bit kernel driver from running on
-      certain AMD64 CPUs.
-
-    * Added a new Xv adaptor on GeForce4 and GeForceFX which uses the 
-      3D engine to do Xv PutImage requests.  This allows XvMC to operate
-      when the video overlay is not available (such as in TwinView).
-      XvMC still uses the overlay by default, when available.  A new
-      XF86Config option "XvmcUsesTextures" has been added to force
-      usage of the 3D engine for XvMCPutSurface even when overlays are 
-      available.
-
-    * Added a shell script "nvidia-bug-report.sh" that gathers
-      system configuration information into a log file; the resulting
-      log file (nvidia-bug-report.log) should be included when reporting
-      bugs to NVIDIA.
-
-2004-1-26 version 1.0-5336
-
-    * Added support for Linux 2.6 kernels.
-
-    * Fixed a problem that caused kernels oops, black screens, and agp
-      failures on some VIA motherboards.
-
-    * Fixed a typo in the NVIDIA-provided libGL.la.
-
-    * Fixed a problem that prevented X from running on Samsung X10 laptops.
-
-    * Deprecated the "--kernel-include-path" .run commandline option,
-      in favor of "--kernel-source-path".
-
-2003-12-22 version 1.0-5328
-
-    * Added support for UBB and FSAA Stereo.
-
-    * Improved GLXPixamp support.
-
-    * Added support for Red Hat Advanced Workstation 3.0.
-
-    * Added support for GLX_SGI_swap_control.
-
-    * Added an OS ABI ELF Note to the OpenGL libraries.
-
-    * Fix a problem where the video overlay would sometimes stop working 
-      when displaying HDTV resolutions.
-
-    * For graphics cards that require a power connector but do not have
-      a connector plugged in, fail X screen initialization, rather than
-      just print a warning message.
-
-    * Reduced CPU usage when OpenGL applications are syncing to vblank.
-
-2003-7-28 version 1.0-4496
-
-    * Improved OpenGL performance when rendering to multiple
-      buffers (such as when using a stereo visual and rendering to
-      GL_LEFT_AND_RIGHT).
-
-    * Initial support for APM power management.
-
-    * Fixed some RENDER related corruption reported with GTK+ 2.2.2.
-
-    * Added support for Active Stereo + TwinView.
-
-    * Fixed a hang on GeForce2 that occurred when using RENDER extension
-      acceleration on some apps such as OpenOffice.
-
-2003-4-24 version 1.0-4363
-
-    * Fixed a problem that prevented running multiple X servers on 
-      different virtual terminals.
-
-    * Improved IDCT level acceleration in XvMC.
-
-    * Fixed a 2D performance slowdown experienced by many people.
-
-2002-12-11 version 1.0-4191
-
-    * Added support for FSAA with UBB.
-
-    * Support for OpenGL 1.4
-
-    * Finished GLX 1.3 support
-
-    * Support for AGP 3.0
-
-    * Improved support for NForce2
-
-    * Added support for NV30 and NV30 extensions.
-
-    * Fixed bug where there was corruption at the borders of a pbuffer
-
-    * More complete acceleration for the XRENDER extension.  Due to the
-      experimental nature, RENDER acceleration is now disabled by default
-      (Option "RenderAccel" enables it).
-
-    * The driver no longer uses the XFree86 Acceleration Architecture (XAA),
-      but provides its own 2D acceleration architecture to better accomodate
-      the needs of simultaneous 3D and 2D rendering.
-
-    * Added color index overlay emulation on Quadro4.
-
-    * Added support for separate X screens on a single GPU (supported
-      by all GPUs that support TwinView).
-
-2002-9-10 version 1.0-3123
-
-    * Added support for NV18, NV28 and nForce 2.
-
-    * Added Quadbuffered workstation stereo visuals for Quadro2, 4 and
-      Quadro DCC.
-
-    * Improved Viewperf numbers.
-
-    * Added support for up to 16 monitors.
-
-    * Added support for T221 panel.
-
-    * Added support for RGB OpenGL overlays in TwinView on NV25/28.
-
-    * Added support for hardware clip ids on Quadro4 parts.  Option "UseClipIDs"
-      enables them.
-
-2002-5-23 version 1.0-2960
-
-    * Fixed problem with loading the GLX extension in multi-head
-      environments with non-NVIDIA video cards.
-
-    * Significant performance improvements in Viewperf on Quadro parts.
-
-    * Added option "NoRenderExtension" to disable the RENDER extension.
-      This is useful in 8bpp where the RENDER extension will preallocate
-      a large portion of the default colormap and break many legacy 
-      applications.
-
-    * Fixed a regression where I420 XvImages had the chroma planes swapped.
-
-    * Fixed some problems with moving overlay windows.
-
-    * Added a dynamic XvMC library "libXvMCNVIDIA_dynamic.so" so that 
-      applications can dynamically load the vendor-specific core XvMC
-      support.
-
-    * Added XvMC motion-compensation acceleration for NV25 and fixed
-      some bugs in the NV17 XvMC support.
-
-    * Fixed some problems with FSAA modes failing.
-
-2002-4-3 version 1.0-2880
-
-    * Fixed rendering problems which occurred in some cases when 
-      GL_SYNC_TO_VBLANK was enabled.
-
-    * Fixed problem where the maximum pixel clock was set too low.
-      
-    * Fixed a problem with image flicker when running full-screen apps
-      on GeForce4.
-  
-    * Fixed a pixmap cache corruption problem on GeForce3.
-
-    * Fixed some issues running multiple NVIDIA graphics cards simultaneously.
-
-2002-3-7 version 1.0-2802
-
-    * Support for anisotropic filtering.
-
-    * Provide libXvMCNVIDIA.a which is an implementation of XvMC 1.0.
-      This allows mpeg acceleration on NV17 chips and NV17 chips only.
-
-    * RGB Workstation overlays for Quadro4.  These are double buffered,
-      Z-buffered 16 bit visuals.  The transparency key is 0x0000 hex.
-
-    * NV17 and NV25 support.
-
-    * Added an 8:8:8:8 XRGB XvImage format to the video blitter.
-
-    * Config file option for Digital Vibrance Control.
-     
-    * Added new XF86Config option "FlatPanelProperties" to control dithering 
-      and scaling when X is started.
-
-    * Added support for SoftEDID's. When enabled the driver will generate 
-      an EDID based on the video bios isntead of doing a table lookup.
-
-    * Improved Crush support
-
-    * Fixed problem with using SGIX_fbconfig and SGIX_pbuffer with 
-      indirect rendering (protocol was incorrect)
-
-    * Fixed problem where the driver would fail on systems with >= 1GB 
-      of memory and a kernel configured to use all the memory.
-
-2001-11-26 version 1.0-2313
-
-    * Got Crush working.
-
-    * OpenGL 1.3 support.
-
-    * Added SGIX_pbuffer and SGIX_fbconfig extensions.
-
-    * Added UBB support, pageflipping and window flipping (described in
-      README).
-
-    * Improved Viewperf performance, Quake performance and performance
-      of immediate mode applications.
-
-    * Improved stability on AMD platforms.
-
-    * Fixed TwinView problem that caused garbage to appear on the screen
-      when starting X with a null option on head 0.
-
-    * Added workaround for XAA bug that causes system to hang when Lisa
-      Screensaver is run.  The problem is worked around by adding the
-      following line in the "Device" section of the XF86Config file:
-      'Option "XaaNoSolidFillTrap"'.  This option prevents XAA from
-      breaking wide lines (and polyggons) into trapezoids and avoids an
-      XAA clipping bug.
-      
-    * Fixed a system hang that occured on some chipsets when taking the
-      X server down (after having run once successfully) and restarting
-      it while using the DVI-I connected toa flat panel.
-
-    * Fixed problem where the performer application Perfly would hang
-      when run in forked-draw mode.
-
-    * Fixed problem where the X driver would segfault when given an
-      invalid MetaMode.
-
-    * Fixed problem where the console was not restored properly after
-      entering X and returning to the console.
-
-    * Fixed problem where X did not redraw completely after a screen
-      blank on GForce 2 Go and Quadro 2 Go.
-
-    * Fixed problem with initializing secondary card. In most cases, the
-      secondary card is posted correctly.  In the cases where it isn't,
-      there is now a workaround to initialize the card via X.
-
-    * Added workarounds to enable AGP on ALI chipsets and enable 4X AGP
-      on VIA chipsets (See README and use with caution!).
-
-2001-08-20 version 1.0-1541
-
-    * Changed behaviour of the X server so the NVIDIA splash screen will
-      only show up on the first run of X.  This can also be disabled by
-      setting an option in XF86Config (see README).
-
-    * Fixed problem where OpenGL applications would sometimes leave
-      portions of their rendering behind when the window was closed
-      using the kill button on the window banner.
-
-    * Fixed problem on mobile where X would respond to the wrong hotkey
-      event under some conditions.
-
-    * Fixed several more problems with indirect rendering.
-
-    * Fixed problem on SMP machines which occured when VT switching
-      while running gloss and gears indirect.
-
-    * Fixed problem where /proc/nv/card0 did not report nv20 correctly.
-
-    * Fixed problem on TNT2, where the driver would only support up to 4
-      threads per process.
-
-    * Fixed Xserver crash that occured when running two Xservers with
-      AGPgart.
-
-    * Fixed some problems in GLX that occured when running
-      multi-threaded  applications.
-
-2001-07-05 version 1.0-1420
-
-    * Added support for hotkey switching on mobile platforms.
-
-    * Fixed a hang on mobile that occurred after starting X, killing it
-      and restarting.
-
-    * Fixed a problem on mobile platforms that prevented DVD's from
-      displaying.
-
-    * Fixed a problem that caused OpenGL programs to segfault when using
-      a graphical login with xdm/kdm, and doing the following sequence:
-      login, mode switch, logout, log in and run a GL app.
-
-    * Fixed some indirect rendering problems.
-
-    * Fixed a problem that caused Xconfigure to fail on NVIDIA drivers.
-
-    * Fixed a crash that occured when X forwarding over SSH.
-
-    * Fixed OpenGL front buffer clipping bug.
-
-    * Added xf86XVOffscreenImage support so the V4L module can use the
-      hardware scaler on YUV surfaces.
-
-    * Improved X-Render acceleration.
-
-    * Fixed a bug that prevented X-Render acceleration on GeForce3.
-
-2001-05-14 version 1.0-1251
-
-    * Preliminary GeForce2 Go support.
-
-    * Added support for GeForce3 OpenGL and GLX extensions.
-
-    * Fixed many SMP bugs.
-
-    * Added TV-Out support.
-     
-    * Fixed DGA depth change bug.
-
-    * Rewrote 2D offscreen memory allocation.
-
-    * Fixed X-Video in TwinView.
-
-    * Acceleration for X-Render extension.
-
-    * Fixed up GLXPixmap rendering.
-
-    * Fixed problem with make current to same drawable but different
-      dpy.
-
-    * Fixed problem in which OpenGL would segfault when reading X
-      atoms.
-
-    * X now gets the DPI (dots per inch) from the monitor's EDID (rather
-      than just defaulting to 75 dpi).
-
-    * All DPMS modes are now supported.  There are still issues on flat
-      panels and on the second head of a TwinView system (please see the
-      README).
-
-    * Fixed support for AGP on systems with 1 GB or more of memory.
-
-2001-02-16 version 0.9-769
-
-    * Fixed problem where direct rendering applications were allowed to
-      continue rendering after xkill was called.
-
-    * Fixed problem where Tribes 2 crashed when compressed textures
-      (s3tc textures) were used.
-
-    * Some drawable leaks were fixed in X and GLX.
-
-    * Fixed problem where the application would hang when calling
-      glXMakeCurrent while holding the X server grab.
-
-    * Bios-posting problems on GeForce2 GTS and GeForce Ultra cards were
-      fixed.  This bug resulted in a significant performance loss.
-
-    * Added support for the X Render extension.
-
-    * TwinView functionality was enhanced so that each head can pan 
-      independently.
-
-    * Fixed problem on TNT and TNT2 where Xv(Shm)PutImage returned
-      BadAlloc in high resolutions when there was not enough video
-      bandwidth to display the YUV video overlay correctly. This works
-      now but the resulting display has artifacts.
-
-    * Fixed problem with cursor hanges in X.
-
-    * Fixed problem with X console not restoring on some monitors.
-
-    * Fixed problem with fork() and OpenGL rendering.
-
-    * Fixed problem with X driver module, nvidia_drv.o, being stripped
-      when RPM was rebuilt.
-
-    * Added missing PCI device ids for some TNT2 variants and GeForce3.
-
-    * Fixed problem where the kernel would often hang during X and/or
-      OpenGL operation when on an SMP machine and using the 2.4 kernel.
-
-    * Fixed SYNC_TO_VBLANK hang with 2.4 kernels.
-
-    * DPMS is partially working again. It is possible to set the "off"
-      option for dpms.  DPMS options "suspend" and "standby" are not
-      fully supported -- they simply blank the screen.  
-
-2000-12-20 version 0.96
-
-    * Fix many SMP problems.
-
-    * Fix memory management problems that arise with large RAM systems
-      (500M+).
-
-    * Add multi-mon OpenGL support.
-
-    * Add TwiNView support.
-
-    * More modeline handling fixes, added double-scan support.
-
-    * Fix bios-posting problems with TNT2 M64s and GeForce2 MXs.
-
-    * Dynamic run-time selection between nvagp and agpgart.
-
-    * Fix TNT2 OpenGL slowdowns (noticeable in UT).
-
-2000-08-30 version 0.95
-
-    * Improve XFree86 4.0.1 support.
-
-    * Re-fixed console switch lockup.
-
-    * Fix some AGP regressions.  Better detection/support for AGPGART.
-
-    * Fix color palette problems (xgamma, direct color visuals).
-
-    * Add bios posting override to help with some card problems (M64).
-
-    * Update included 2.4 support to newest test kernels.
-
-2000-07-07 version 0.94
-
-    * Add support for XFree86 4.0.1
-
-    * Fix modesetting problem.
-
-    * Add AGPGART support (nvagpgart v. 0.5-5).
-
-    * Add GeForce2 MX support.
-
-    * Fixed various hangs.
-
-    * Added FSAA support.
-
-    * Fixed problem where an opengl app dying during a console switch
-      would kill the X Server.
-
-2000-06-08 version 0.9-3
-
-    * Allow Modeline directives in the XF86Config file to override our
-      auto-detection of monitor resolutions and refresh rates.
-
-    * "Correct" fix for TNT memory-type problems.
-
-    * Fix for VT switch lockups.
-
-    * Fix for general ALI chipset lockups.
-
-    * Addition and documentation of some registry keys.  Check
-      os-registry.c in the kernel source directory for more details and
-      options.
-
-    * Work around Quake3 modeswitch crashing bug.  Note: It's really a
-      bug in dlopen().
-
-    * Major improvement in multi-threading behavior.
-
-    * Display list sharing with glXCreateContext works now.
-
-    * Faster implementation of glTexImage/glTexSubImage and
-      glCopyTexImage/glCopytexSubImage calls.
-
-    * Fixed kernel memory leak, relating to threaded OpenGL.  This
-      problem was most noticeable with xmms.
-
-    * Fix build problems with older 2.2.x kernels (RedHat 6.0).
-
-2000-05-02 version 0.9-2
-
-    * Fixed problem initializing TNT w/ SGRAM.
-
-    * Removed all GPL'd code from nv.c.
-
-    * Better logging and messages everywhere for tracking problems.
-
-    * Dynamic allocation of client data in kernel, rather than static.
-
-    * Incorporated *unsupported* 2.3 kernel changes for completeness.
-
-    * Makefile updates - add -D_LOOSE_KERNEL_NAMES, and default to 'make
-      install'.
-
-    * Improved mode switching in quake3 (still see occasional crashes).
-
-    * Changed installation name of libraries.  We now have a .1.0.1
-      revision name in the libraries.
-
-    * Temporarily force disabling of AGP fast writes for all chipsets.
-
-    * Fixed monitor issues, allow overriding of sync polarities.
-
-2000-04-25 version 0.9-1
-
-    * Initial Release.
-
diff -uNr nvidia-304.131.org/nv-linux.h nvidia-304.131/nv-linux.h
--- nvidia-304.131.org/nv-linux.h	2015-12-14 17:02:43.000000000 +0800
+++ nvidia-304.131/nv-linux.h	2016-08-01 13:40:31.000000000 +0800
@@ -36,9 +36,7 @@
   #include <generated/compile.h>
 #endif
 
-#ifndef LINUX_VERSION_CODE
 #include <linux/version.h>
-#endif
 #include <linux/utsname.h>
 
 #if LINUX_VERSION_CODE < KERNEL_VERSION(2, 4, 7)
@@ -230,22 +228,22 @@
 #endif
 
 /*
- * Traditionally, CONFIG_XEN indicated that the target kernel was
+ * Traditionally, CONFIG_ALB indicated that the target kernel was
  * built exclusively for use under a Xen hypervisor, requiring
  * modifications to or disabling of a variety of NVIDIA graphics
  * driver code paths. As of the introduction of CONFIG_PARAVIRT
  * and support for Xen hypervisors within the CONFIG_PARAVIRT_GUEST
- * architecture, CONFIG_XEN merely indicates that the target
+ * architecture, CONFIG_ALB merely indicates that the target
  * kernel can run under a Xen hypervisor, but not that it will.
  *
- * If CONFIG_XEN and CONFIG_PARAVIRT are defined, the old Xen
+ * If CONFIG_ALB and CONFIG_PARAVIRT are defined, the old Xen
  * specific code paths are disabled. If the target kernel executes
  * stand-alone, the NVIDIA graphics driver will work fine. If the
  * kernels executes under a Xen (or other) hypervisor, however, the
  * NVIDIA graphics driver has no way of knowing and is unlikely
  * to work correctly.
  */
-#if defined(CONFIG_XEN) && !defined(CONFIG_PARAVIRT)
+#if defined(CONFIG_ALB) && !defined(CONFIG_PARAVIRT)
 #include <asm/maddr.h>
 #include <xen/interface/memory.h>
 #define NV_XEN_SUPPORT_OLD_STYLE_KERNEL
@@ -256,6 +254,15 @@
 #include <linux/seq_file.h>
 #endif
 
+/*
+ * As of version 304.131, os-agp.c and os-mtrr.c still use deprecated
+ * kernel APIs for mtrr which are no longer exported since 4.3, causing
+ * the module to error out when loaded.
+ */
+#if LINUX_VERSION_CODE >= KERNEL_VERSION(4,3,0)
+#undef CONFIG_MTRR
+#endif
+
 #if !defined(NV_VMWARE) && defined(CONFIG_MTRR)
 #include <asm/mtrr.h>
 #endif
@@ -1500,7 +1507,7 @@
     NvU64           phys_addr;
     unsigned long   virt_addr;
     NvU64           dma_addr;
-#ifdef CONFIG_XEN
+#ifdef CONFIG_ALB
     unsigned int    guest_pfn;
 #endif
 #ifdef NV_SG_MAP_BUFFERS
diff -uNr nvidia-304.131.org/nv-mlock.c nvidia-304.131/nv-mlock.c
--- nvidia-304.131.org/nv-mlock.c	2015-11-09 13:43:39.000000000 +0800
+++ nvidia-304.131/nv-mlock.c	2016-08-01 13:40:15.000000000 +0800
@@ -13,6 +13,7 @@
 
 #include "os-interface.h"
 #include "nv-linux.h"
+#include "nv-mm.h"
 
 RM_STATUS NV_API_CALL nv_lock_user_pages(
     nv_state_t *nv,
@@ -49,7 +50,7 @@
     }
 
     down_read(&mm->mmap_sem);
-    ret = get_user_pages(current, mm, (unsigned long)address,
+    ret = NV_GET_USER_PAGES((unsigned long)address,
             page_count, write, force, user_pages, NULL);
     up_read(&mm->mmap_sem);
     pinned = ret;
@@ -62,7 +63,7 @@
     else if (pinned < page_count)
     {
         for (i = 0; i < pinned; i++)
-            page_cache_release(user_pages[i]);
+            put_page(user_pages[i]);
         os_free_mem(user_pages);
         return RM_ERR_INVALID_ADDRESS;
     }
@@ -80,7 +81,7 @@
             {
                 pci_unmap_page(dev, pte_array[j],
                         PAGE_SIZE, PCI_DMA_BIDIRECTIONAL);
-                page_cache_release(user_pages[j]);
+                put_page(user_pages[j]);
             }
             os_free_mem(user_pages);
             return RM_ERR_OPERATING_SYSTEM;
@@ -114,7 +115,7 @@
                 PAGE_SIZE, PCI_DMA_BIDIRECTIONAL);
         if (write)
             set_page_dirty_lock(user_pages[i]);
-        page_cache_release(user_pages[i]);
+        put_page(user_pages[i]);
     }
 
     os_free_mem(user_pages);
diff -uNr nvidia-304.131.org/nv-mm.h nvidia-304.131/nv-mm.h
--- nvidia-304.131.org/nv-mm.h	1970-01-01 08:00:00.000000000 +0800
+++ nvidia-304.131/nv-mm.h	2016-08-01 13:40:15.000000000 +0800
@@ -0,0 +1,55 @@
+/*******************************************************************************
+    Copyright (c) 2016 NVIDIA Corporation
+
+    Permission is hereby granted, free of charge, to any person obtaining a copy
+    of this software and associated documentation files (the "Software"), to
+    deal in the Software without restriction, including without limitation the
+    rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
+    sell copies of the Software, and to permit persons to whom the Software is
+    furnished to do so, subject to the following conditions:
+
+        The above copyright notice and this permission notice shall be
+        included in all copies or substantial portions of the Software.
+
+    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
+    THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
+    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
+    DEALINGS IN THE SOFTWARE.
+
+*******************************************************************************/
+#ifndef __NV_MM_H__
+#define __NV_MM_H__
+
+/*  get_user_pages_remote() was added by:
+ *    2016 Feb 12: 1e9877902dc7e11d2be038371c6fbf2dfcd469d7
+ *
+ *  The very next commit (cde70140fed8429acf7a14e2e2cbd3e329036653)
+ *  deprecated the 8-argument version of get_user_pages for the
+ *  non-remote case (calling get_user_pages with current and current->mm).
+ *
+ *  The guidelines are: call NV_GET_USER_PAGES_REMOTE if you need the 8-argument
+ *  version that uses something other than current and current->mm. Use
+ *  NV_GET_USER_PAGES if you are refering to current and current->mm.
+ *
+*  Note that get_user_pages_remote() requires the caller to hold a reference on
+*  the task_struct (if non-NULL) and the mm_struct. This will always be true
+*  when using current and current->mm. If the kernel passes the driver a vma
+*  via driver callback, the kernel holds a reference on vma->vm_mm over that
+*  callback.
+ */
+
+#if defined(NV_GET_USER_PAGES_REMOTE_PRESENT)
+    #define NV_GET_USER_PAGES           get_user_pages
+    #define NV_GET_USER_PAGES_REMOTE    get_user_pages_remote
+#else
+    #define NV_GET_USER_PAGES(start, nr_pages, write, force, pages, vmas) \
+        get_user_pages(current, current->mm, start, nr_pages, write, force, pages, vmas)
+
+    #define NV_GET_USER_PAGES_REMOTE    get_user_pages
+#endif
+
+
+#endif // __NV_MM_H__
diff -uNr nvidia-304.131.org/os-agp.c nvidia-304.131/os-agp.c
--- nvidia-304.131.org/os-agp.c	2015-11-09 13:43:39.000000000 +0800
+++ nvidia-304.131/os-agp.c	2016-08-01 13:39:55.000000000 +0800
@@ -123,8 +123,12 @@
          * be due to the presence of other memory ranges with conflicting
          * caching  attributes. Play safe and fail AGP initialization.
          */
+#if LINUX_VERSION_CODE < KERNEL_VERSION(4, 3, 0)
         if (mtrr_add(agp_info.aper_base, agp_info.aper_size << 20,
                 MTRR_TYPE_WRCOMB, 0) < 0)
+#else
+        if (arch_phys_wc_add(agp_info.aper_base, agp_info.aper_size << 20) < 0)
+#endif
 #endif
         {
             nv_printf(NV_DBG_ERRORS, 
@@ -176,7 +180,11 @@
 failed:
 #ifdef CONFIG_MTRR
     if (nv_pat_mode == NV_PAT_MODE_DISABLED)
+#if LINUX_VERSION_CODE < KERNEL_VERSION(4, 3, 0)
         mtrr_del(-1, agp_info.aper_base, agp_info.aper_size << 20);
+#else
+        arch_phys_wc_del(-1);
+#endif
 #endif
 release:
     NV_AGPGART_BACKEND_RELEASE(drm_agp_p, nvl->agp_bridge);
@@ -206,7 +214,11 @@
 
 #ifdef CONFIG_MTRR
     if (nv_pat_mode == NV_PAT_MODE_DISABLED)
+#if LINUX_VERSION_CODE < KERNEL_VERSION(4, 3, 0)
         mtrr_del(-1, nv->agp.address, nv->agp.size);
+#else
+        arch_phys_wc_del(-1);
+#endif
 #endif
 
     NV_AGPGART_BACKEND_RELEASE(drm_agp_p, nvl->agp_bridge);
diff -uNr nvidia-304.131.org/os-mtrr.c nvidia-304.131/os-mtrr.c
--- nvidia-304.131.org/os-mtrr.c	2015-11-09 13:43:39.000000000 +0800
+++ nvidia-304.131/os-mtrr.c	2016-08-01 13:39:55.000000000 +0800
@@ -24,7 +24,11 @@
     if (mode != NV_MEMORY_WRITECOMBINED)
         return RM_ERROR;
 
+#if LINUX_VERSION_CODE < KERNEL_VERSION(4, 3, 0)
     if (mtrr_add(start, size, MTRR_TYPE_WRCOMB, 0x0) < 0)
+#else
+    if (arch_phys_wc_add(start, size) < 0)
+#endif
     {
         nv_printf(NV_DBG_ERRORS,
             "NVRM: failed to write-combine %lluM @ 0x%0llx.\n",
@@ -43,7 +47,11 @@
 )
 {
 #if defined(CONFIG_MTRR)
+#if LINUX_VERSION_CODE < KERNEL_VERSION(4, 3, 0)
     mtrr_del(-1, start, size);
+#else
+    arch_phys_wc_del(-1);
+#endif
     return RM_OK;
 #endif
     return RM_ERR_NOT_SUPPORTED;
